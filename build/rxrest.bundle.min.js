"use strict";function createCommonjsModule(e,t){return t={exports:{}},e(t,t.exports),t.exports}function isFunction(e){return"function"==typeof e}function isObject(e){return null!=e&&"object"==typeof e}function tryCatcher(){try{return tryCatchTarget.apply(this,arguments)}catch(e){return errorObject.errorObject.e=e,errorObject.errorObject}}function tryCatch(e){return tryCatchTarget=e,tryCatcher}function flattenUnsubscriptionErrors(e){return e.reduce(function(e,t){return e.concat(t instanceof UnsubscriptionError_1.UnsubscriptionError?t.errors:t)},[])}function toSubscriber(e,t,r){if(e){if(e instanceof Subscriber_1.Subscriber)return e;if(e[rxSubscriber.rxSubscriber])return e[rxSubscriber.rxSubscriber]()}return e||t||r?new Subscriber_1.Subscriber(e,t,r):new Subscriber_1.Subscriber(Observer.empty)}function dispatchNext(e){var t=e.value,r=e.subscriber;r.closed||(r.next(t),r.complete())}function dispatchError(e){var t=e.err,r=e.subscriber;r.closed||r.error(t)}function isPromise(e){return e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}function subscribeToResult(e,t,r,s){var n=new InnerSubscriber_1.InnerSubscriber(e,r,s);if(n.closed)return null;if(t instanceof Observable_1.Observable)return t._isScalar?(n.next(t.value),n.complete(),null):t.subscribe(n);if(isArrayLike.isArrayLike(t)){for(var o=0,i=t.length;o<i&&!n.closed;o++)n.next(t[o]);n.closed||n.complete()}else{if(isPromise_1.isPromise(t))return t.then(function(e){n.closed||(n.next(e),n.complete())},function(e){return n.error(e)}).then(null,function(e){root.root.setTimeout(function(){throw e})}),n;if(t&&"function"==typeof t[iterator.iterator])for(var a=t[iterator.iterator]();;){var u=a.next();if(u.done){n.complete();break}if(n.next(u.value),n.closed)break}else if(t&&"function"==typeof t[observable.observable]){var c=t[observable.observable]();if("function"==typeof c.subscribe)return c.subscribe(new InnerSubscriber_1.InnerSubscriber(e,r,s));n.error(new TypeError("Provided object does not correctly implement Symbol.observable"))}else{var l="You provided "+(isObject_1.isObject(t)?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";n.error(new TypeError(l))}}return null}function mergeMap$2(e,t,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"number"==typeof t&&(r=t,t=null),this.lift(new MergeMapOperator(e,t,r))}function concatMap$2(e,t){return this.lift(new mergeMap_1.MergeMapOperator(e,t,1))}function _catch$2(e){var t=new CatchOperator(e),r=this.lift(t);return t.caught=r}function isScheduler(e){return e&&"function"==typeof e.schedule}function objectToMap(e,t){for(var r in t)if(Array.isArray(t[r]))for(var s=0;s<t[r].length;s++)e.append(r,t[r][s]);else e.append(r,t[r]);return e}function uuid(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e++<36;t+=51*e&52?(15^e?8^Math.random()*(20^e?16:4):4).toString(16):"-");return t}function isObject$1(e){return null!==e&&"object"==typeof e}function RequestBase(e){if(e)return mixin(e)}function mixin(e){for(var t in RequestBase.prototype)e[t]=RequestBase.prototype[t];return e}function ResponseBase(e){if(e)return mixin$1(e)}function mixin$1(e){for(var t in ResponseBase.prototype)e[t]=ResponseBase.prototype[t];return e}function Agent(){this._defaults=[]}function fetch(e,t,r){e instanceof Request||(e=new Request(e,t));var s=superagent[e.method.toLowerCase()](e.url),n=!0,o=!1,i=void 0;try{for(var a,u=e.headers[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var c=a.value;s.set(c[0],c[1])}}catch(e){o=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return Observable_2.fromPromise(e.text()).mergeMap(function(t){return s.send(t),Observable_2.create(function(t){return s.end(function(r,s){if(r){var n=new Response(r,s);return n.message=n.statusText,t.error(n)}if(!0===s.noContent)return t.next(new Response),t.complete();s.url=e.url;var o=new Response(s.text,s);t.next(o),t.complete()}),function(){s.abort(),r&&r(s)}})})}Object.defineProperty(exports,"__esModule",{value:!0});var classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},toConsumableArray=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},RxRestProxyHandler=function(){function e(t){classCallCheck(this,e),this.$internal=[],this.$instance=t;do{this.$internal=this.$internal.concat(Object.getOwnPropertyNames(t),Object.getOwnPropertySymbols(t))}while(t=Object.getPrototypeOf(t))}return createClass(e,[{key:"getPrototypeOf",value:function(e){return Object.getPrototypeOf(this.$instance)}},{key:"defineProperty",value:function(e,t,r){return!!~this.$internal.indexOf(t)||(Object.defineProperty(e,t,r),!0)}},{key:"deleteProperty",value:function(e,t){return delete e[t]}},{key:"set",value:function(e,t,r,s){return~this.$internal.indexOf(t)?(this.$instance[t]=r,!0):(!0===this.$instance.$pristine&&e[t]!==r&&(this.$instance.$pristine=!1),e[t]=r,!0)}},{key:"get",value:function(e,t,r){return~this.$internal.indexOf(t)?this.$instance[t]:e[t]}}]),e}(),commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},__window="undefined"!=typeof window&&window,__self="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,__global=void 0!==commonjsGlobal&&commonjsGlobal,_root=__window||__global||__self,root_1=_root;!function(){if(!_root)throw new Error("RxJS could not find any global context (window, self, global)")}();var root={root:root_1},isFunction_2=isFunction,isFunction_1={isFunction:isFunction_2},isArray_1=Array.isArray||function(e){return e&&"number"==typeof e.length},isArray={isArray:isArray_1},isObject_2=isObject,isObject_1={isObject:isObject_2},errorObject_1={e:{}},errorObject={errorObject:errorObject_1},tryCatchTarget,tryCatch_2=tryCatch,tryCatch_1={tryCatch:tryCatch_2},__extends$2=commonjsGlobal&&commonjsGlobal.__extends||function(e,t){function r(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},UnsubscriptionError=function(e){function t(t){e.call(this),this.errors=t;var r=Error.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"");this.name=r.name="UnsubscriptionError",this.stack=r.stack,this.message=r.message}return __extends$2(t,e),t}(Error),UnsubscriptionError_2=UnsubscriptionError,UnsubscriptionError_1={UnsubscriptionError:UnsubscriptionError_2},Subscription=function(){function e(e){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var e,t=!1;if(!this.closed){var r=this,s=r._parent,n=r._parents,o=r._unsubscribe,i=r._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var a=-1,u=n?n.length:0;s;)s.remove(this),s=++a<u&&n[a]||null;if(isFunction_1.isFunction(o)&&(l=tryCatch_1.tryCatch(o).call(this))===errorObject.errorObject&&(t=!0,e=e||(errorObject.errorObject.e instanceof UnsubscriptionError_1.UnsubscriptionError?flattenUnsubscriptionErrors(errorObject.errorObject.e.errors):[errorObject.errorObject.e])),isArray.isArray(i))for(a=-1,u=i.length;++a<u;){var c=i[a];if(isObject_1.isObject(c)){var l=tryCatch_1.tryCatch(c.unsubscribe).call(c);if(l===errorObject.errorObject){t=!0,e=e||[];var h=errorObject.errorObject.e;h instanceof UnsubscriptionError_1.UnsubscriptionError?e=e.concat(flattenUnsubscriptionErrors(h.errors)):e.push(h)}}}if(t)throw new UnsubscriptionError_1.UnsubscriptionError(e)}},e.prototype.add=function(t){if(!t||t===e.EMPTY)return e.EMPTY;if(t===this)return this;var r=t;switch(typeof t){case"function":r=new e(t);case"object":if(r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if("function"!=typeof r._addParent){var s=r;(r=new e)._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(r),r._addParent(this),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.prototype._addParent=function(e){var t=this,r=t._parent,s=t._parents;r&&r!==e?s?-1===s.indexOf(e)&&s.push(e):this._parents=[e]:this._parent=e},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}(),Subscription_2=Subscription,Subscription_1={Subscription:Subscription_2},empty={closed:!0,next:function(e){},error:function(e){throw e},complete:function(){}},Observer={empty:empty},rxSubscriber=createCommonjsModule(function(e,t){var r=root.root.Symbol;t.rxSubscriber="function"==typeof r&&"function"==typeof r.for?r.for("rxSubscriber"):"@@rxSubscriber",t.$$rxSubscriber=t.rxSubscriber}),rxSubscriber_1=rxSubscriber.rxSubscriber,rxSubscriber_2=rxSubscriber.$$rxSubscriber,__extends$1=commonjsGlobal&&commonjsGlobal.__extends||function(e,t){function r(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},Subscriber=function(e){function t(r,s,n){switch(e.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=Observer.empty;break;case 1:if(!r){this.destination=Observer.empty;break}if("object"==typeof r){r instanceof t?(this.destination=r,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new SafeSubscriber(this,r));break}default:this.syncErrorThrowable=!0,this.destination=new SafeSubscriber(this,r,s,n)}}return __extends$1(t,e),t.prototype[rxSubscriber.rxSubscriber]=function(){return this},t.create=function(e,r,s){var n=new t(e,r,s);return n.syncErrorThrowable=!1,n},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this,t=e._parent,r=e._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=r,this},t}(Subscription_1.Subscription),Subscriber_2=Subscriber,SafeSubscriber=function(e){function t(t,r,s,n){e.call(this),this._parentSubscriber=t;var o,i=this;isFunction_1.isFunction(r)?o=r:r&&(o=r.next,s=r.error,n=r.complete,r!==Observer.empty&&(i=Object.create(r),isFunction_1.isFunction(i.unsubscribe)&&this.add(i.unsubscribe.bind(i)),i.unsubscribe=this.unsubscribe.bind(this))),this._context=i,this._next=o,this._error=s,this._complete=n}return __extends$1(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber;if(this._error)t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else{if(!t.syncErrorThrowable)throw this.unsubscribe(),e;t.syncErrorValue=e,t.syncErrorThrown=!0,this.unsubscribe()}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){throw this.unsubscribe(),e}},t.prototype.__tryOrSetError=function(e,t,r){try{t.call(this._context,r)}catch(t){return e.syncErrorValue=t,e.syncErrorThrown=!0,!0}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(Subscriber),Subscriber_1={Subscriber:Subscriber_2},toSubscriber_2=toSubscriber,toSubscriber_1={toSubscriber:toSubscriber_2},observable=createCommonjsModule(function(e,t){function r(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}t.getSymbolObservable=r,t.observable=r(root.root),t.$$observable=t.observable}),observable_1=observable.getSymbolObservable,observable_2=observable.observable,observable_3=observable.$$observable,Observable=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var s=this.operator,n=toSubscriber_1.toSubscriber(e,t,r);if(s?s.call(n,this.source):n.add(this.source?this._subscribe(n):this._trySubscribe(n)),n.syncErrorThrowable&&(n.syncErrorThrowable=!1,n.syncErrorThrown))throw n.syncErrorValue;return n},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.syncErrorThrown=!0,e.syncErrorValue=t,e.error(t)}},e.prototype.forEach=function(e,t){var r=this;if(t||(root.root.Rx&&root.root.Rx.config&&root.root.Rx.config.Promise?t=root.root.Rx.config.Promise:root.root.Promise&&(t=root.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,s){var n;n=r.subscribe(function(t){if(n)try{e(t)}catch(e){s(e),n.unsubscribe()}else e(t)},s,t)})},e.prototype._subscribe=function(e){return this.source.subscribe(e)},e.prototype[observable.observable]=function(){return this},e.create=function(t){return new e(t)},e}(),Observable_2=Observable,Observable_1={Observable:Observable_2},__extends$3=commonjsGlobal&&commonjsGlobal.__extends||function(e,t){function r(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},PromiseObservable=function(e){function t(t,r){e.call(this),this.promise=t,this.scheduler=r}return __extends$3(t,e),t.create=function(e,r){return new t(e,r)},t.prototype._subscribe=function(e){var t=this,r=this.promise,s=this.scheduler;if(null==s)this._isScalar?e.closed||(e.next(this.value),e.complete()):r.then(function(r){t.value=r,t._isScalar=!0,e.closed||(e.next(r),e.complete())},function(t){e.closed||e.error(t)}).then(null,function(e){root.root.setTimeout(function(){throw e})});else if(this._isScalar){if(!e.closed)return s.schedule(dispatchNext,0,{value:this.value,subscriber:e})}else r.then(function(r){t.value=r,t._isScalar=!0,e.closed||e.add(s.schedule(dispatchNext,0,{value:r,subscriber:e}))},function(t){e.closed||e.add(s.schedule(dispatchError,0,{err:t,subscriber:e}))}).then(null,function(e){root.root.setTimeout(function(){throw e})})},t}(Observable_1.Observable),PromiseObservable_2=PromiseObservable,PromiseObservable_1={PromiseObservable:PromiseObservable_2},fromPromise_1=PromiseObservable_1.PromiseObservable.create,fromPromise$3={fromPromise:fromPromise_1};Observable_1.Observable.fromPromise=fromPromise$3.fromPromise;var isArrayLike_1=function(e){return e&&"number"==typeof e.length},isArrayLike={isArrayLike:isArrayLike_1},isPromise_2=isPromise,isPromise_1={isPromise:isPromise_2},iterator=createCommonjsModule(function(e,t){function r(e){var t=e.Symbol;if("function"==typeof t)return t.iterator||(t.iterator=t("iterator polyfill")),t.iterator;var r=e.Set;if(r&&"function"==typeof(new r)["@@iterator"])return"@@iterator";var s=e.Map;if(s)for(var n=Object.getOwnPropertyNames(s.prototype),o=0;o<n.length;++o){var i=n[o];if("entries"!==i&&"size"!==i&&s.prototype[i]===s.prototype.entries)return i}return"@@iterator"}t.symbolIteratorPonyfill=r,t.iterator=r(root.root),t.$$iterator=t.iterator}),iterator_1=iterator.symbolIteratorPonyfill,iterator_2=iterator.iterator,iterator_3=iterator.$$iterator,__extends$5=commonjsGlobal&&commonjsGlobal.__extends||function(e,t){function r(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},InnerSubscriber=function(e){function t(t,r,s){e.call(this),this.parent=t,this.outerValue=r,this.outerIndex=s,this.index=0}return __extends$5(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(Subscriber_1.Subscriber),InnerSubscriber_2=InnerSubscriber,InnerSubscriber_1={InnerSubscriber:InnerSubscriber_2},subscribeToResult_2=subscribeToResult,subscribeToResult_1={subscribeToResult:subscribeToResult_2},__extends$6=commonjsGlobal&&commonjsGlobal.__extends||function(e,t){function r(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},OuterSubscriber=function(e){function t(){e.apply(this,arguments)}return __extends$6(t,e),t.prototype.notifyNext=function(e,t,r,s,n){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(Subscriber_1.Subscriber),OuterSubscriber_2=OuterSubscriber,OuterSubscriber_1={OuterSubscriber:OuterSubscriber_2},__extends$4=commonjsGlobal&&commonjsGlobal.__extends||function(e,t){function r(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},mergeMap_2=mergeMap$2,MergeMapOperator=function(){function e(e,t,r){void 0===r&&(r=Number.POSITIVE_INFINITY),this.project=e,this.resultSelector=t,this.concurrent=r}return e.prototype.call=function(e,t){return t.subscribe(new MergeMapSubscriber(e,this.project,this.resultSelector,this.concurrent))},e}(),MergeMapOperator_1=MergeMapOperator,MergeMapSubscriber=function(e){function t(t,r,s,n){void 0===n&&(n=Number.POSITIVE_INFINITY),e.call(this,t),this.project=r,this.resultSelector=s,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return __extends$4(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,r=this.index++;try{t=this.project(e,r)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t,e,r)},t.prototype._innerSub=function(e,t,r){this.add(subscribeToResult_1.subscribeToResult(this,e,t,r))},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},t.prototype.notifyNext=function(e,t,r,s,n){this.resultSelector?this._notifyResultSelector(e,t,r,s):this.destination.next(t)},t.prototype._notifyResultSelector=function(e,t,r,s){var n;try{n=this.resultSelector(e,t,r,s)}catch(e){return void this.destination.error(e)}this.destination.next(n)},t.prototype.notifyComplete=function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(OuterSubscriber_1.OuterSubscriber),MergeMapSubscriber_1=MergeMapSubscriber,mergeMap_1={mergeMap:mergeMap_2,MergeMapOperator:MergeMapOperator_1,MergeMapSubscriber:MergeMapSubscriber_1};Observable_1.Observable.prototype.mergeMap=mergeMap_1.mergeMap,Observable_1.Observable.prototype.flatMap=mergeMap_1.mergeMap;var __extends$7=commonjsGlobal&&commonjsGlobal.__extends||function(e,t){function r(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},ErrorObservable=function(e){function t(t,r){e.call(this),this.error=t,this.scheduler=r}return __extends$7(t,e),t.create=function(e,r){return new t(e,r)},t.dispatch=function(e){var t=e.error;e.subscriber.error(t)},t.prototype._subscribe=function(e){var r=this.error,s=this.scheduler;if(e.syncErrorThrowable=!0,s)return s.schedule(t.dispatch,0,{error:r,subscriber:e});e.error(r)},t}(Observable_1.Observable),ErrorObservable_2=ErrorObservable,ErrorObservable_1={ErrorObservable:ErrorObservable_2},_throw_1=ErrorObservable_1.ErrorObservable.create,_throw$2={_throw:_throw_1};Observable_1.Observable.throw=_throw$2._throw;var concatMap_2=concatMap$2,concatMap_1={concatMap:concatMap_2};Observable_1.Observable.prototype.concatMap=concatMap_1.concatMap;var __extends$8=commonjsGlobal&&commonjsGlobal.__extends||function(e,t){function r(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},_catch_2=_catch$2,CatchOperator=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new CatchSubscriber(e,this.selector,this.caught))},e}(),CatchSubscriber=function(e){function t(t,r,s){e.call(this,t),this.selector=r,this.caught=s}return __extends$8(t,e),t.prototype.error=function(t){if(!this.isStopped){var r=void 0;try{r=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle(),this.add(subscribeToResult_1.subscribeToResult(this,r))}},t}(OuterSubscriber_1.OuterSubscriber),_catch_1={_catch:_catch_2};Observable_1.Observable.prototype.catch=_catch_1._catch,Observable_1.Observable.prototype._catch=_catch_1._catch;var __extends$10=commonjsGlobal&&commonjsGlobal.__extends||function(e,t){function r(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},ScalarObservable=function(e){function t(t,r){e.call(this),this.value=t,this.scheduler=r,this._isScalar=!0,r&&(this._isScalar=!1)}return __extends$10(t,e),t.create=function(e,r){return new t(e,r)},t.dispatch=function(e){var t=e.done,r=e.value,s=e.subscriber;t?s.complete():(s.next(r),s.closed||(e.done=!0,this.schedule(e)))},t.prototype._subscribe=function(e){var r=this.value,s=this.scheduler;if(s)return s.schedule(t.dispatch,0,{done:!1,value:r,subscriber:e});e.next(r),e.closed||e.complete()},t}(Observable_1.Observable),ScalarObservable_2=ScalarObservable,ScalarObservable_1={ScalarObservable:ScalarObservable_2},__extends$11=commonjsGlobal&&commonjsGlobal.__extends||function(e,t){function r(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},EmptyObservable=function(e){function t(t){e.call(this),this.scheduler=t}return __extends$11(t,e),t.create=function(e){return new t(e)},t.dispatch=function(e){e.subscriber.complete()},t.prototype._subscribe=function(e){var r=this.scheduler;if(r)return r.schedule(t.dispatch,0,{subscriber:e});e.complete()},t}(Observable_1.Observable),EmptyObservable_2=EmptyObservable,EmptyObservable_1={EmptyObservable:EmptyObservable_2},isScheduler_2=isScheduler,isScheduler_1={isScheduler:isScheduler_2},__extends$9=commonjsGlobal&&commonjsGlobal.__extends||function(e,t){function r(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},ArrayObservable=function(e){function t(t,r){e.call(this),this.array=t,this.scheduler=r,r||1!==t.length||(this._isScalar=!0,this.value=t[0])}return __extends$9(t,e),t.create=function(e,r){return new t(e,r)},t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];var s=e[e.length-1];isScheduler_1.isScheduler(s)?e.pop():s=null;var n=e.length;return n>1?new t(e,s):1===n?new ScalarObservable_1.ScalarObservable(e[0],s):new EmptyObservable_1.EmptyObservable(s)},t.dispatch=function(e){var t=e.array,r=e.index,s=e.count,n=e.subscriber;r>=s?n.complete():(n.next(t[r]),n.closed||(e.index=r+1,this.schedule(e)))},t.prototype._subscribe=function(e){var r=this.array,s=r.length,n=this.scheduler;if(n)return n.schedule(t.dispatch,0,{array:r,index:0,count:s,subscriber:e});for(var o=0;o<s&&!e.closed;o++)e.next(r[o]);e.complete()},t}(Observable_1.Observable),ArrayObservable_2=ArrayObservable,ArrayObservable_1={ArrayObservable:ArrayObservable_2},of_1=ArrayObservable_1.ArrayObservable.of,of$2={of:of_1};Observable_1.Observable.of=of$2.of;var componentEmitter=createCommonjsModule(function(e){function t(e){if(e)return r(e)}function r(e){for(var r in t.prototype)e[r]=t.prototype[r];return e}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var s,n=0;n<r.length;n++)if((s=r[n])===t||s.fn===t){r.splice(n,1);break}return this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks["$"+e];if(r)for(var s=0,n=(r=r.slice(0)).length;s<n;++s)r[s].apply(this,t);return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}),isObject_1$3=isObject$1,requestBase=RequestBase;RequestBase.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},RequestBase.prototype.parse=function(e){return this._parser=e,this},RequestBase.prototype.responseType=function(e){return this._responseType=e,this},RequestBase.prototype.serialize=function(e){return this._serializer=e,this},RequestBase.prototype.timeout=function(e){if(!e||"object"!=typeof e)return this._timeout=e,this._responseTimeout=0,this;for(var t in e)switch(t){case"deadline":this._timeout=e.deadline;break;case"response":this._responseTimeout=e.response;break;default:console.warn("Unknown timeout option",t)}return this},RequestBase.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};var ERROR_CODES=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];RequestBase.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var r=this._retryCallback(e,t);if(!0===r)return!0;if(!1===r)return!1}catch(e){console.error(e)}if(t&&t.status&&t.status>=500&&501!=t.status)return!0;if(e){if(e.code&&~ERROR_CODES.indexOf(e.code))return!0;if(e.timeout&&"ECONNABORTED"==e.code)return!0;if(e.crossDomain)return!0}return!1},RequestBase.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},RequestBase.prototype.then=function(e,t){if(!this._fullfilledPromise){var r=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(e,t){r.end(function(r,s){r?t(r):e(s)})})}return this._fullfilledPromise.then(e,t)},RequestBase.prototype.catch=function(e){return this.then(void 0,e)},RequestBase.prototype.use=function(e){return e(this),this},RequestBase.prototype.ok=function(e){if("function"!=typeof e)throw Error("Callback required");return this._okCallback=e,this},RequestBase.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},RequestBase.prototype.get=function(e){return this._header[e.toLowerCase()]},RequestBase.prototype.getHeader=RequestBase.prototype.get,RequestBase.prototype.set=function(e,t){if(isObject_1$3(e)){for(var r in e)this.set(r,e[r]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},RequestBase.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},RequestBase.prototype.field=function(e,t){if(null===e||void 0===e)throw new Error(".field(name, val) name can not be empty");if(this._data&&console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()"),isObject_1$3(e)){for(var r in e)this.field(r,e[r]);return this}if(Array.isArray(t)){for(var s in t)this.field(e,t[s]);return this}if(null===t||void 0===t)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof t&&(t=""+t),this._getFormData().append(e,t),this},RequestBase.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},RequestBase.prototype._auth=function(e,t,r,s){switch(r.type){case"basic":this.set("Authorization","Basic "+s(e+":"+t));break;case"auto":this.username=e,this.password=t;break;case"bearer":this.set("Authorization","Bearer "+e)}return this},RequestBase.prototype.withCredentials=function(e){return void 0==e&&(e=!0),this._withCredentials=e,this},RequestBase.prototype.redirects=function(e){return this._maxRedirects=e,this},RequestBase.prototype.maxResponseSize=function(e){if("number"!=typeof e)throw TypeError("Invalid argument");return this._maxResponseSize=e,this},RequestBase.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},RequestBase.prototype.send=function(e){var t=isObject_1$3(e),r=this._header["content-type"];if(this._formData&&console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()"),t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(t&&isObject_1$3(this._data))for(var s in e)this._data[s]=e[s];else"string"==typeof e?(r||this.type("form"),r=this._header["content-type"],this._data="application/x-www-form-urlencoded"==r?this._data?this._data+"&"+e:e:(this._data||"")+e):this._data=e;return!t||this._isHost(e)?this:(r||this.type("json"),this)},RequestBase.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},RequestBase.prototype._finalizeQueryString=function(){var e=this._query.join("&");if(e&&(this.url+=(this.url.indexOf("?")>=0?"&":"?")+e),this._query.length=0,this._sort){var t=this.url.indexOf("?");if(t>=0){var r=this.url.substring(t+1).split("&");"function"==typeof this._sort?r.sort(this._sort):r.sort(),this.url=this.url.substring(0,t)+"?"+r.join("&")}}},RequestBase.prototype._appendQueryString=function(){console.trace("Unsupported")},RequestBase.prototype._timeoutError=function(e,t,r){if(!this._aborted){var s=new Error(e+t+"ms exceeded");s.timeout=t,s.code="ECONNABORTED",s.errno=r,this.timedout=!0,this.abort(),this.callback(s)}},RequestBase.prototype._setTimeouts=function(){var e=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){e._timeoutError("Timeout of ",e._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){e._timeoutError("Response timeout of ",e._responseTimeout,"ETIMEDOUT")},this._responseTimeout))};var type=function(e){return e.split(/ *; */).shift()},params=function(e){return e.split(/ *; */).reduce(function(e,t){var r=t.split(/ *= */),s=r.shift(),n=r.shift();return s&&n&&(e[s]=n),e},{})},parseLinks=function(e){return e.split(/ *, */).reduce(function(e,t){var r=t.split(/ *; */),s=r[0].slice(1,-1);return e[r[1].split(/ *= */)[1].slice(1,-1)]=s,e},{})},cleanHeader=function(e,t){return delete e["content-type"],delete e["content-length"],delete e["transfer-encoding"],delete e.host,t&&(delete e.authorization,delete e.cookie),e},utils={type:type,params:params,parseLinks:parseLinks,cleanHeader:cleanHeader},responseBase=ResponseBase;ResponseBase.prototype.get=function(e){return this.header[e.toLowerCase()]},ResponseBase.prototype._setHeaderProperties=function(e){var t=e["content-type"]||"";this.type=utils.type(t);var r=utils.params(t);for(var s in r)this[s]=r[s];this.links={};try{e.link&&(this.links=utils.parseLinks(e.link))}catch(e){}},ResponseBase.prototype._setStatusProperties=function(e){var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.redirect=3==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.forbidden=403==e,this.notFound=404==e},["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(function(e){Agent.prototype[e]=function(){return this._defaults.push({fn:e,arguments:arguments}),this}}),Agent.prototype._setDefaults=function(e){this._defaults.forEach(function(t){e[t.fn].apply(e,t.arguments)})};var agentBase=Agent,client=createCommonjsModule(function(e,t){function r(){}function s(e){if(!isObject_1$3(e))return e;var t=[];for(var r in e)n(t,r,e[r]);return t.join("&")}function n(e,t,r){if(null!=r)if(Array.isArray(r))r.forEach(function(r){n(e,t,r)});else if(isObject_1$3(r))for(var s in r)n(e,t+"["+s+"]",r[s]);else e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));else null===r&&e.push(encodeURIComponent(t))}function o(e){for(var t,r,s={},n=e.split("&"),o=0,i=n.length;o<i;++o)-1==(r=(t=n[o]).indexOf("="))?s[decodeURIComponent(t)]="":s[decodeURIComponent(t.slice(0,r))]=decodeURIComponent(t.slice(r+1));return s}function i(e){for(var t,r,s,n,o=e.split(/\r?\n/),i={},a=0,u=o.length;a<u;++a)-1!==(t=(r=o[a]).indexOf(":"))&&(s=r.slice(0,t).toLowerCase(),n=f(r.slice(t+1)),i[s]=n);return i}function a(e){return/[\/+]json($|[^-\w])/.test(e)}function u(e){this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.header=this.headers=i(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function c(e,t){var r=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e=null,t=null;try{t=new u(r)}catch(t){return e=new Error("Parser is unable to parse the response"),e.parse=!0,e.original=t,r.xhr?(e.rawResponse=void 0===r.xhr.responseType?r.xhr.responseText:r.xhr.response,e.status=r.xhr.status?r.xhr.status:null,e.statusCode=e.status):(e.rawResponse=null,e.status=null),r.callback(e)}r.emit("response",t);var s;try{r._isResponseOK(t)||(s=new Error(t.statusText||"Unsuccessful HTTP response"))}catch(e){s=e}s?(s.original=e,s.response=t,s.status=t.status,r.callback(s,t)):r.callback(null,t)})}function l(e,t,r){var s=p("DELETE",e);return"function"==typeof t&&(r=t,t=null),t&&s.send(t),r&&s.end(r),s}var h;"undefined"!=typeof window?h=window:"undefined"!=typeof self?h=self:(console.warn("Using browser-only version of superagent in non-browser environment"),h=commonjsGlobal);var p=t=e.exports=function(e,r){return"function"==typeof r?new t.Request("GET",e).end(r):1==arguments.length?new t.Request("GET",e):new t.Request(e,r)};t.Request=c,p.getXHR=function(){if(!(!h.XMLHttpRequest||h.location&&"file:"==h.location.protocol&&h.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw Error("Browser-only version of superagent could not find XHR")};var f="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};p.serializeObject=s,p.parseString=o,p.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},p.serialize={"application/x-www-form-urlencoded":s,"application/json":JSON.stringify},p.parse={"application/x-www-form-urlencoded":o,"application/json":JSON.parse},responseBase(u.prototype),u.prototype._parseBody=function(e){var t=p.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&a(this.type)&&(t=p.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null)},u.prototype.toError=function(){var e=this.req,t=e.method,r=e.url,s="cannot "+t+" "+r+" ("+this.status+")",n=new Error(s);return n.status=this.status,n.method=t,n.url=r,n},p.Response=u,componentEmitter(c.prototype),requestBase(c.prototype),c.prototype.type=function(e){return this.set("Content-Type",p.types[e]||e),this},c.prototype.accept=function(e){return this.set("Accept",p.types[e]||e),this},c.prototype.auth=function(e,t,r){1===arguments.length&&(t=""),"object"==typeof t&&null!==t&&(r=t,t=""),r||(r={type:"function"==typeof btoa?"basic":"auto"});return this._auth(e,t,r,function(e){if("function"==typeof btoa)return btoa(e);throw new Error("Cannot use basic auth, btoa is not a function")})},c.prototype.query=function(e){return"string"!=typeof e&&(e=s(e)),e&&this._query.push(e),this},c.prototype.attach=function(e,t,r){if(t){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(e,t,r||t.name)}return this},c.prototype._getFormData=function(){return this._formData||(this._formData=new h.FormData),this._formData},c.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();var r=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit("error",e)),r(e,t)},c.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},c.prototype.buffer=c.prototype.ca=c.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},c.prototype.pipe=c.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},c.prototype._isHost=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&"[object Object]"!==Object.prototype.toString.call(e)},c.prototype.end=function(e){return this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=e||r,this._finalizeQueryString(),this._end()},c.prototype._end=function(){var e=this,t=this.xhr=p.getXHR(),r=this._formData||this._data;this._setTimeouts(),t.onreadystatechange=function(){var r=t.readyState;if(r>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4==r){var s;try{s=t.status}catch(e){s=0}if(!s){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit("end")}};var s=function(t,r){r.total>0&&(r.percent=r.loaded/r.total*100),r.direction=t,e.emit("progress",r)};if(this.hasListeners("progress"))try{t.onprogress=s.bind(null,"download"),t.upload&&(t.upload.onprogress=s.bind(null,"upload"))}catch(e){}try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof r&&!this._isHost(r)){var n=this._header["content-type"],o=this._serializer||p.serialize[n?n.split(";")[0]:""];!o&&a(n)&&(o=p.serialize["application/json"]),o&&(r=o(r))}for(var i in this.header)null!=this.header[i]&&this.header.hasOwnProperty(i)&&t.setRequestHeader(i,this.header[i]);return this._responseType&&(t.responseType=this._responseType),this.emit("request",this),t.send(void 0!==r?r:null),this},p.agent=function(){return new agentBase},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(e){agentBase.prototype[e.toLowerCase()]=function(t,r){var s=new p.Request(e,t);return this._setDefaults(s),r&&s.end(r),s}}),agentBase.prototype.del=agentBase.prototype.delete,p.get=function(e,t,r){var s=p("GET",e);return"function"==typeof t&&(r=t,t=null),t&&s.query(t),r&&s.end(r),s},p.head=function(e,t,r){var s=p("HEAD",e);return"function"==typeof t&&(r=t,t=null),t&&s.query(t),r&&s.end(r),s},p.options=function(e,t,r){var s=p("OPTIONS",e);return"function"==typeof t&&(r=t,t=null),t&&s.send(t),r&&s.end(r),s},p.del=l,p.delete=l,p.patch=function(e,t,r){var s=p("PATCH",e);return"function"==typeof t&&(r=t,t=null),t&&s.send(t),r&&s.end(r),s},p.post=function(e,t,r){var s=p("POST",e);return"function"==typeof t&&(r=t,t=null),t&&s.send(t),r&&s.end(r),s},p.put=function(e,t,r){var s=p("PUT",e);return"function"==typeof t&&(r=t,t=null),t&&s.send(t),r&&s.end(r),s}}),client_1=client.Request,superagent=Object.freeze({default:client,__moduleExports:client,Request:client_1}),RxRestConfiguration$$1=function(){function e(){classCallCheck(this,e),this.$headers=new Headers,this.$queryParams=new URLSearchParams,this.identifier="id",this.requestInterceptors=[],this.responseInterceptors=[],this.errorInterceptors=[],this.abortCallback=function(){return null},this.uuid=!1,this.fetch=fetch}return createClass(e,[{key:"_requestBodyHandler",value:function(e){if(e)return e instanceof FormData||e instanceof URLSearchParams?e:e instanceof RxRestItem?e.json():JSON.stringify(e)}},{key:"_responseBodyHandler",value:function(e){return e.text().then(function(e){return{body:e?JSON.parse(e):null,metadata:null}})}},{key:"responseBodyHandler",get:function(){return this._responseBodyHandler},set:function(e){this._responseBodyHandler=e}},{key:"requestBodyHandler",get:function(){return this._requestBodyHandler},set:function(e){this._requestBodyHandler=e}},{key:"baseURL",set:function(e){"/"!==e.charAt(e.length-1)&&(e+="/"),this.$baseURL=e},get:function(){return this.$baseURL}},{key:"queryParams",set:function(e){e instanceof URLSearchParams?this.$queryParams=e:this.$queryParams="string"!=typeof e?objectToMap(new URLSearchParams,e):new URLSearchParams(e)},get:function(){return this.$queryParams}},{key:"headers",set:function(e){e instanceof Headers?this.$headers=e:this.$headers=objectToMap(new Headers,e)},get:function(){return this.$headers}}]),e}(),fromPromise=function(e){return Observable_2.create(function(t){e.then(function(e){t.next(e),t.complete()}).catch(t.error)})},RxRest$1=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new RxRestConfiguration$$1,r=arguments[1],s=arguments[2];classCallCheck(this,e),this.$fromServer=!1,this.$asIterable=!0,this.$queryParams=new URLSearchParams,this.$headers=new Headers,this.$pristine=!0,this.$route=void 0===r?[]:[].concat(toConsumableArray(r)),this.config=t,this.$metadata=s,t.uuid&&(this.$uuid=uuid())}return createClass(e,[{key:"addRoute",value:function(e){this.$route.push.apply(this.$route,e.split("/"))}},{key:"one",value:function(e,t){this.addRoute(e);var r={};return t&&(r[this.config.identifier]=t),new RxRestItem(this.$route,r,this.config)}},{key:"all",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.addRoute(e),new RxRestCollection(this.$route,void 0,this.config,null,t)}},{key:"asIterable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.$asIterable=e,this}},{key:"fromObject",value:function(e,t){return this.addRoute(e),Array.isArray(t)?new RxRestCollection(this.$route,t,this.config):new RxRestItem(this.$route,t,this.config)}},{key:"withBody",value:function(e){return e||this}},{key:"post",value:function(e,t,r){return this.queryParams=t,this.headers=r,this.request("POST",this.withBody(e))}},{key:"remove",value:function(e,t){return this.queryParams=e,this.headers=t,this.request("DELETE")}},{key:"get",value:function(e,t){return this.queryParams=e,this.headers=t,this.request("GET")}},{key:"put",value:function(e,t,r){return this.queryParams=t,this.headers=r,this.request("PUT",this.withBody(e))}},{key:"patch",value:function(e,t,r){return this.queryParams=t,this.headers=r,this.request("PATCH",this.withBody(e))}},{key:"head",value:function(e,t){return this.queryParams=e,this.headers=t,this.request("HEAD")}},{key:"trace",value:function(e,t){return this.queryParams=e,this.headers=t,this.request("TRACE")}},{key:"options",value:function(e,t){return this.queryParams=e,this.headers=t,this.request("OPTIONS")}},{key:"setQueryParams",value:function(e){return this.queryParams=e,this}},{key:"setHeaders",value:function(e){return this.headers=e,this}},{key:"expandInterceptors",value:function(e){return function(t){return e.reduce(function(e,t){return e.concatMap(function(e){var r=t(e);return void 0===r?Observable_2.of(e):r instanceof Promise?fromPromise(r):r instanceof Observable_2?r:Observable_2.of(r)})},Observable_2.of(t))}}},{key:"request",value:function(e,t){var r=this,s={method:e,headers:this.requestHeaders,body:this.config.requestBodyHandler(t)},n=new Request(this.URL+this.requestQueryParams,s);return Observable_2.of(n).mergeMap(this.expandInterceptors(this.config.requestInterceptors)).mergeMap(function(e){return r.config.fetch(e,null,r.config.abortCallback)}).mergeMap(this.expandInterceptors(this.config.responseInterceptors)).mergeMap(function(e){return fromPromise(r.config.responseBodyHandler(e))}).mergeMap(function(e){var t=e.body,s=e.metadata;if(!Array.isArray(t)){var n=void 0;return r instanceof RxRestItem?((n=r).element=t,n.$metadata=s):n=new RxRestItem(r.$route,t,r.config,s),n.$fromServer=!0,n.$pristine=!0,Observable_2.create(function(e){e.next(n),e.complete()})}var o=new RxRestCollection(r.$route,t.map(function(e){var t=new RxRestItem(r.$route,e,r.config,s);return t.$fromServer=!0,t.$pristine=!0,t}),r.config,s);return o.$pristine=!0,Observable_2.create(function(e){if(r.$asIterable)e.next(o);else{var t=!0,s=!1,n=void 0;try{for(var i,a=o[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var u=i.value;e.next(u)}}catch(e){s=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(s)throw n}}}e.complete()})}).catch(function(e){return Observable_2.of(e).mergeMap(r.expandInterceptors(r.config.errorInterceptors)).mergeMap(function(e){return Observable_2.throw(e)})})}},{key:"URL",get:function(){return""+this.config.baseURL+this.$route.join("/")}},{key:"queryParams",set:function(e){e&&(e instanceof URLSearchParams?this.$queryParams=e:this.$queryParams=objectToMap(new URLSearchParams,e))},get:function(){return this.$queryParams}},{key:"requestQueryParams",get:function(){var e=new URLSearchParams,t=!0,r=!1,s=void 0;try{for(var n,o=this.config.queryParams[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var i=n.value;e.append(i[0],i[1])}}catch(e){r=!0,s=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw s}}var a=!0,u=!1,c=void 0;try{for(var l,h=this.queryParams[Symbol.iterator]();!(a=(l=h.next()).done);a=!0){var p=l.value;e.append(p[0],p[1])}}catch(e){u=!0,c=e}finally{try{!a&&h.return&&h.return()}finally{if(u)throw c}}var f=e.toString();return f.length?"?"+f:""}},{key:"headers",set:function(e){e&&(e instanceof Headers?this.$headers=e:this.$headers=objectToMap(new Headers,e))},get:function(){return this.$headers}},{key:"requestHeaders",get:function(){var e=new Headers,t=!0,r=!1,s=void 0;try{for(var n,o=this.headers[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var i=n.value;e.append(i[0],i[1])}}catch(e){r=!0,s=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw s}}var a=!0,u=!1,c=void 0;try{for(var l,h=this.config.headers[Symbol.iterator]();!(a=(l=h.next()).done);a=!0){var p=l.value;e.append(p[0],p[1])}}catch(e){u=!0,c=e}finally{try{!a&&h.return&&h.return()}finally{if(u)throw c}}return e}}]),e}(),RxRestItem=function(e){function t(e,r,s,n){var o;classCallCheck(this,t);var i=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s,e,n));return i.$element={},void 0!==r&&(i.element=r),o=new Proxy(i.$element,new RxRestProxyHandler(i)),possibleConstructorReturn(i,o)}return inherits(t,RxRest$1),createClass(t,[{key:"save",value:function(e,t){return this.queryParams=e,this.headers=t,this.request(!0===this.$fromServer?"PUT":"POST",this)}},{key:"plain",value:function(){return this.element}},{key:"json",value:function(){return JSON.stringify(this.plain())}},{key:"clone",value:function(){var e=this.$route;this.$element[this.config.identifier]&&(e=e.slice(0,this.$route.length-1));var r=new t(e,this.$element,this.config);return r.$fromServer=this.$fromServer,r}},{key:"element",set:function(e){for(var t in e)t!==this.config.identifier||this.$element[this.config.identifier]||this.$route.push(""+e[t]),this.$element[t]=e[t]},get:function(){return this.$element}}]),t}(),RxRestCollection=function(e){function t(e,r,s,n){var o,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];classCallCheck(this,t);var a=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s,e,n));return a.$elements=[],void 0!==r&&(a.elements=r.map(function(e){return e instanceof RxRestItem?e.clone():new RxRestItem(a.$route,e)})),a.$asIterable=i,o=new Proxy(a.$elements,new RxRestProxyHandler(a)),possibleConstructorReturn(a,o)}return inherits(t,RxRest$1),createClass(t,[{key:Symbol.iterator,value:function(){var e=0,t=this.$elements;return{next:function(){return e<t.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}}},{key:"getList",value:function(e,t){return this.queryParams=e,this.headers=t,this.request("GET")}},{key:"plain",value:function(){return this.elements.map(function(e){return e.plain()})}},{key:"json",value:function(){return JSON.stringify(this.plain())}},{key:"clone",value:function(){return new t(this.$route,this.$elements,this.config)}},{key:"elements",set:function(e){this.$elements=e,this.length=e.length},get:function(){return this.$elements}}]),t}(),RxRest$$1=function(){function e(t){classCallCheck(this,e),this.config=t}return createClass(e,[{key:"one",value:function(e,t){var r=new RxRest$1(this.config);return r.one.call(r,e,t)}},{key:"all",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new RxRest$1(this.config);return r.all.call(r,e,t)}},{key:"fromObject",value:function(e,t){var r=new RxRest$1(this.config);return r.fromObject.call(r,e,t)}}]),e}();exports.RxRestConfiguration=RxRestConfiguration$$1,exports.RxRestItem=RxRestItem,exports.RxRestCollection=RxRestCollection,exports.RxRest=RxRest$$1;
//# sourceMappingURL=rxrest.bundle.min.js.map
