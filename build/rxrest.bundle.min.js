!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.rxrest=t.rxrest||{})}(this,function(t){"use strict";function e(t,e){return e={exports:{}},t(e,e.exports),e.exports}function n(t){return null!==t&&"object"==typeof t}function r(t,e,n){return"function"==typeof n?new t("GET",e).end(n):2==arguments.length?new t("GET",e):new t(e,n)}function i(t){this.source=t}function s(t,e){const n=e.length,r=new Array(n+1);r[0]=t;for(let t=0;t<n;++t)r[t+1]=e[t];return r}function o(t,e){const n=e.length,r=new Array(n+1);for(let t=0;t<n;++t)r[t]=e[t];return r[n]=t,r}function u(t,e){if(t<0)throw new TypeError("n must be >= 0");const n=e.length;return 0===t||0===n?e:t>=n?[]:h(t,e,n-t)}function h(t,e,n){const r=new Array(n);for(let i=0;i<n;++i)r[i]=e[t+i];return r}function c(t){return u(1,t)}function p(t,e){const n=e.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=t(e[i]);return r}function a(t,e,n){let r=e;for(let e=0,i=n.length;e<i;++e)r=t(r,n[e],e);return r}function f(t,e,n){if(e<0)throw new TypeError("i must be >= 0");const r=n.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=e===s?t:n[s];return i}function l(t,e){if(t<0)throw new TypeError("i must be >= 0");const n=e.length;return 0===n||t>=n?e:1===n?[]:d(t,e,n-1)}function d(t,e,n){const r=new Array(n);let i;for(i=0;i<t;++i)r[i]=e[i];for(i=t;i<n;++i)r[i]=e[i+1];return r}function y(t,e){const n=e.length,r=new Array(n);let i=0;for(let s,o=0;o<n;++o)s=e[o],t(s)||(r[i]=s,++i);return r.length=i,r}function v(t,e){for(let n=0,r=e.length;n<r;++n)if(t===e[n])return n;return-1}function m(t){return null!=t&&"number"==typeof t.length&&"function"!=typeof t}function w(t,e){this._dispose=t,this._data=e}function k(){this.disposable=void 0,this.disposed=!1,this._resolve=void 0;var t=this;this.result=new Promise(function(e){t._resolve=e})}function _(t){return null!==t&&"object"==typeof t&&"function"==typeof t.then}function b(t,e,n){var r=R(e);return _(r)?r.catch(function(e){n.error(t,e)}):r}function g(t,e){return q(new w(t,e))}function x(){return new w(Tr,void 0)}function P(t){return g(T,t)}function T(t){return Promise.all(Pr(R,t))}function R(t){try{return t.dispose()}catch(t){return Promise.reject(t)}}function E(){return new k}function q(t){return new w(A,$(t))}function A(t){return t.disposed||(t.disposed=!0,t.value=R(t.disposable),t.disposable=void 0),t.value}function $(t){return{disposed:!1,disposable:t,value:void 0}}function H(t){setTimeout(function(){throw t},0)}function S(t,e,n){this._run=t,this.value=e,this.sink=n,this.active=!0}function C(t,e,n){n.error(t,e)}function O(t,e,n){n.event(t,e)}function I(t,e,n){n.end(t,e)}function j(t){return new i(new M(t))}function M(t){this.value=t}function L(t,e,n){n.event(t,e),n.end(t,void 0)}function U(){return Rr}function D(){}function B(t){return t.dispose()}function N(t){return new i(new Q(t))}function Q(t){this.array=t}function X(t,e,n){for(var r=0,i=e.length;r<i&&this.active;++r)n.event(t,e[r]);this.active&&function(t){n.end(t)}(t)}function z(t){return"function"==typeof t[Er]}function F(t){return t[Er]()}function W(t){return new i(new J(t))}function J(t){this.iterable=t}function V(t,e,n){this.scheduler=n,this.iterator=t,this.task=new S(G,this,e),n.asap(this.task)}function G(t,e,n){var r=e.iterator.next();r.done?n.end(t,r.value):n.event(t,r.value),e.scheduler.asap(e.task)}function K(t){var e=null;if(t){var n=t[Ar];if("function"==typeof n&&(!(e=n.call(t))||"function"!=typeof e.subscribe))throw new TypeError("invalid observable "+e)}return e}function Y(t){return new i(new Z(t))}function Z(t){this.observable=t}function tt(t,e){this.sink=t,this.scheduler=e}function et(t){return t.unsubscribe()}function nt(t){if(t instanceof i)return t;var e=K(t);if(null!=e)return Y(e);if(Array.isArray(t)||m(t))return N(t);if(z(t))return W(t);throw new TypeError("from(x) must be observable, iterable, or array-like: "+t)}function rt(t,e,n,r){this.time=t,this.period=e,this.task=n,this.scheduler=r,this.active=!0}function it(t){return Promise.resolve(t).then(st)}function st(t){try{return t.run()}catch(e){return t.error(e)}}function ot(t,e){this.timer=t,this.timeline=e,this._timer=null,this._nextArrival=1/0;var n=this;this._runReadyTasksBound=function(){n._runReadyTasks(n.now())}}function ut(){}function ht(t){this.f=t,this.active=!0}function ct(t){var e=new ht(t);return it(e),e}function pt(){this.tasks=[]}function at(t,e,n){for(var r=e.events,i=0;i<r.length;++i){var s=r[i];s.active&&(t(s),s.period>=0&&s.active&&(s.time=s.time+s.period,ft(s,n)))}return n}function ft(t,e){var n=e.length;if(0===n)return void e.push(yt(t.time,[t]));var r=dt(t.time,e);r>=n?e.push(yt(t.time,[t])):t.time===e[r].time?e[r].events.push(t):e.splice(r,0,yt(t.time,[t]))}function lt(t,e){e.events=y(t,e.events)}function dt(t,e){for(var n,r,i=0,s=e.length;i<s;){if(n=Math.floor((i+s)/2),r=e[n],t===r.time)return n;t<r.time?s=n:i=n+1}return s}function yt(t,e){return{time:t,events:e}}function vt(t,e){if(null==t||"object"!=typeof t)throw new TypeError("subscriber must be an object");var n=E(),r=new mt(H,t,n);return n.setDisposable(e.source.run(r,$r)),new wt(n)}function mt(t,e,n){this.fatalError=t,this.subscriber=e,this.disposable=n}function wt(t){this.disposable=t}function kt(t,e,n,r,i,s){Promise.resolve(i.dispose()).then(function(){"function"==typeof n&&n.call(e,s)}).catch(function(t){"function"==typeof r&&r.call(e,t)}).catch(t)}function _t(t,e){return t(e)}function bt(t,e,n){try{n.event(t,e)}catch(e){n.error(t,e)}}function gt(t,e,n){try{n.end(t,e)}catch(e){n.error(t,e)}}function xt(t){return Pt(t,$r)}function Pt(t,e){return new Promise(function(n,r){Tt(t,e,n,r)})}function Tt(t,e,n,r){var i=E(),s=new Rt(n,r,i);i.setDisposable(t.run(s,e))}function Rt(t,e,n){this._end=t,this._error=e,this._disposable=n,this.active=!0}function Et(t,e,n,r){Promise.resolve(n.dispose()).then(function(){t(r)},e)}function qt(t){this.sink=t}function At(t,e){this.p=t,this.source=e}function $t(t,e){this.p=t,this.sink=e}function Ht(t,e){return function(n){return t(n)&&e(n)}}function St(t,e,n){this.p=t,this.f=e,this.source=n}function Ct(t,e,n){this.p=t,this.f=e,this.sink=n}function Ot(t,e){this.f=t,this.source=e}function It(t,e){this.f=t,this.sink=e}function jt(t,e){return new i(Ot.create(t,e.source))}function Mt(t,e){return jt(function(){return t},e)}function Lt(t,e){return new i(new Ut(t,e.source))}function Ut(t,e){this.source=e,this.f=t}function Dt(t,e){this.sink=e,this.f=t}function Bt(t,e){return Nt(Lt(t,e))}function Nt(t){return xt(t.source)}function Qt(t,e,n){return new i(new Xt(t,e,n.source))}function Xt(t,e,n){this.step=t,this.seed=e,this.source=n}function zt(t,e,n){this.step=t,this.seed=e,this.sink=n}function Ft(t,e,n){return new i(new Wt(t,e,n.source))}function Wt(t,e,n){this.source=n,this.f=t,this.value=e}function Jt(t,e,n){this.f=t,this.value=e,this.sink=n}function Vt(t,e,n){return xt(new Gt(t,e,n.source))}function Gt(t,e,n){this.source=n,this.f=t,this.value=e}function Kt(t,e,n){this.f=t,this.value=e,this.sink=n}function Yt(t,e){return new i(new Zt(t,e.source))}function Zt(t,e){this.f=t,this.source=e}function te(t,e,n,r){this.f=t,this.sink=n,this.scheduler=r,this.active=!0,this.disposable=q(e.run(this,r))}function ee(t,e){return ne(j(t),e)}function ne(t,e){return Yt(function(){return e},t)}function re(t,e){this.sink=e,this.index=t,this.active=!0,this.value=void 0}function ie(t,e){switch(e.length){case 0:return t();case 1:return t(e[0]);case 2:return t(e[0],e[1]);case 3:return t(e[0],e[1],e[2]);case 4:return t(e[0],e[1],e[2],e[3]);case 5:return t(e[0],e[1],e[2],e[3],e[4]);default:return t.apply(void 0,e)}}function se(t){return oe(t,Sr(arguments))}function oe(t,e){var n=e.length;return 0===n?U():1===n?jt(t,e[0]):new i(ue(t,e))}function ue(t,e){return new ce(t,Hr(he,e))}function he(t){return t.source}function ce(t,e){this.f=t,this.sources=e}function pe(t,e,n,r){this.sink=n,this.disposables=t,this.sinks=e,this.f=r;var i=e.length;this.awaiting=i,this.values=new Array(i),this.hasValue=new Array(i);for(var s=0;s<i;++s)this.hasValue[s]=!1;this.activeCount=e.length}function ae(t,e){return se(xr,t,e)}function fe(t,e){return new i(new le(t,e.source))}function le(t,e){this.transducer=t,this.source=e}function de(t,e){this.xf=t,this.sink=e}function ye(t){this.time=-(1/0),this.sink=t}function ve(t){return"function"==typeof t["@@transducer/step"]?new me(t):new we(t)}function me(t){this.tx=t}function we(t){this.tx=t}function ke(){this.head=null,this.length=0}function _e(t,e){return be(br,t,e)}function be(t,e,n){return new i(new ge(t,e,n.source))}function ge(t,e,n){this.f=t,this.concurrency=e,this.source=n}function xe(t,e,n,r,i){this.f=t,this.concurrency=e,this.sink=r,this.scheduler=i,this.pending=[],this.current=new ke,this.disposable=q(n.run(this,i)),this.active=!0}function Pe(t,e,n,r){return t(e).source.run(n,r)}function Te(t,e,n){this.prev=this.next=null,this.time=t,this.outer=e,this.sink=n,this.disposable=void 0}function Re(t,e){return be(t,1/0,e)}function Ee(t){return _e(1/0,t)}function qe(t,e){return be(t,1,e)}function Ae(t){var e=t.length;return 0===e?U():1===e?t[0]:new i($e(t))}function $e(t){return new Se(Cr(He,[],t))}function He(t,e){var n=e.source;return n instanceof Se?t.concat(n.sources):t.concat(n)}function Se(t){this.sources=t}function Ce(t,e,n){this.sink=n,this.disposables=t,this.activeCount=e.length}function Oe(t,e){return new i(new Me(br,t.source,[e.source]))}function Ie(t,e,n){return new i(new Me(t,e.source,p(je,n)))}function je(t){return t.source}function Me(t,e,n){this.f=t,this.sampler=e,this.sources=n}function Le(t){this.sink=t,this.hasValue=!1}function Ue(t,e,n){this.f=t,this.sinks=e,this.sink=n,this.active=!1}function De(t){return t.hasValue}function Be(t){return t.value}function Ne(t){this._capacity=t||32,this._length=0,this._head=0}function Qe(t,e,n,r,i){for(var s=0;s<i;++s)n[s+r]=t[s+e],t[s+e]=void 0}function Xe(t,e){return 0===e.length?U():1===e.length?jt(t,e[0]):new i(new Fe(t,Or(ze,e)))}function ze(t){return t.source}function Fe(t,e){this.f=t,this.sources=e}function We(t,e,n,r){this.f=t,this.sinks=n,this.sink=r,this.buffers=e}function Je(t,e,n,r){r.event(e,ie(t,Or(Ve,n)))}function Ve(t){return t.shift()}function Ge(t,e){for(var n=0,r=t.length;n<r;++n)if(t[n].isEmpty()&&!e[n].active)return!0;return!1}function Ke(t){for(var e=0,n=t.length;e<n;++e)if(t[e].isEmpty())return!1;return!0}function Ye(t){return new i(new Ze(t.source))}function Ze(t){this.source=t}function tn(t,e){this.sink=t,this.scheduler=e,this.current=null,this.ended=!1}function en(t,e,n,r){this.min=t,this.max=e,this.outer=n,this.sink=r,this.disposable=x()}function nn(t,e){return new i(At.create(t,e.source))}function rn(t){return sn(hn,t)}function sn(t,e){return new i(new on(t,e.source))}function on(t,e){this.equals=t,this.source=e}function un(t,e){this.equals=t,this.sink=e,this.value=void 0,this.init=!0}function hn(t,e){return t===e}function cn(t,e){return an(0,t,e)}function pn(t,e){return an(t,1/0,e)}function an(t,e,n){return e<=t?U():new i(fn(t,e,n.source))}function fn(t,e,n){return n instanceof Ot?ln(t,e,n):n instanceof yn?dn(t,e,n):new yn(t,e,n)}function ln(t,e,n){return Ot.create(n.f,fn(t,e,n.source))}function dn(t,e,n){return t+=n.min,e=Math.min(e+n.min,n.max),new yn(t,e,n.source)}function yn(t,e,n){this.source=n,this.min=t,this.max=e}function vn(t,e,n,r,i){this.sink=r,this.skip=t,this.take=e,this.disposable=q(n.run(this,i))}function mn(t,e){return new i(new wn(t,e.source))}function wn(t,e){this.p=t,this.source=e}function kn(t,e,n,r){this.p=t,this.sink=n,this.active=!0,this.disposable=q(e.run(this,r))}function _n(t,e){return new i(new bn(t,e.source))}function bn(t,e){this.p=t,this.source=e}function gn(t,e){this.p=t,this.sink=e,this.skipping=!0}function xn(t,e){return new i(new Rn(t.source,e.source))}function Pn(t,e){return new i(new En(t.source,e.source))}function Tn(t,e){return xn(Ee(t),Pn(t,e))}function Rn(t,e){this.maxSignal=t,this.source=e}function En(t,e){this.minSignal=t,this.source=e}function qn(t,e){this.value=t,this.sink=e}function An(t,e,n){this.min=t,this.max=e,this.sink=n}function $n(t,e,n){this.value=1/0,this.sink=e,this.disposable=t.run(this,n)}function Hn(t,e,n){this.value=1/0,this.sink=e,this.disposable=t.run(this,n)}function Sn(){}function Cn(t,e){return t<=0?e:new i(new On(t,e.source))}function On(t,e){this.dt=t,this.source=e}function In(t,e,n){this.dt=t,this.sink=e,this.scheduler=n}function jn(t){return new i(new Mn(t.source))}function Mn(t){this.source=t}function Ln(t){this.sink=t}function Un(t,e){return new i(Dn(t,e.source))}function Dn(t,e){return e instanceof Ot?Bn(t,e):e instanceof Qn?Nn(t,e):new Qn(t,e)}function Bn(t,e){return Ot.create(e.f,Dn(t,e.source))}function Nn(t,e){return new Qn(Math.max(t,e.period),e.source)}function Qn(t,e){this.period=t,this.source=e}function Xn(t,e){this.time=0,this.period=t,this.sink=e}function zn(t,e){return new i(new Fn(t,e.source))}function Fn(t,e){this.dt=t,this.source=e}function Wn(t,e,n,r){this.dt=t,this.sink=n,this.scheduler=r,this.value=void 0,this.timer=null;var i=e.run(this,r);this.disposable=P([this,i])}function Jn(t){return Vn(j(t))}function Vn(t){return new i(new Gn(t.source))}function Gn(t){this.source=t}function Kn(t,e){this.sink=t,this.scheduler=e,this.queue=Promise.resolve();var n=this;this._eventBound=function(t){n.sink.event(n.scheduler.now(),t)},this._endBound=function(t){n.sink.end(n.scheduler.now(),t)},this._errorBound=function(t){n.sink.error(n.scheduler.now(),t)}}function Yn(t){this.sink=t,this.active=!0}function Zn(t,e){return new i(new rr(t,e.source))}function tr(t){return new i(new er(t))}function er(t){this.value=t}function nr(t,e,n){n.error(t,e)}function rr(t,e){this.f=t,this.source=e}function ir(t,e,n,r){this.f=t,this.sink=new Yn(n),this.scheduler=r,this.disposable=e.run(this,r)}function sr(t,e,n){try{n.event(t,e)}catch(e){n.error(t,e)}}function or(t,e,n){try{n.end(t,e)}catch(e){n.error(t,e)}}function ur(t){const e=t.source;return e instanceof Ur?t:new t.constructor(new Ur(e))}function hr(t){return Promise.resolve(t).then(cr)}function cr(t){try{return t.run()}catch(e){return t.error(e)}}function pr(t){return new i(new Ur(new zr(t)))}function ar(t,e,n){t instanceof Request||(t=new Request(t,e));let r=_r[t.method.toLowerCase()](t.url);for(let e of t.headers)r.set(e[0],e[1]);return Jn(t.text()).flatMap(t=>{return r.send(t),pr((t,e,i)=>{return r.end(function(n,r){if(n){let t=new Response(n,r);return t.message=t.statusText,i(t)}if(r.noContent===!0)return t(new Response),e();t(new Response(r.text,r)),e()}),function(){r.abort(),n(r)}})})}function fr(t,e){for(let n in e)if(Array.isArray(e[n]))for(let r=0;r<e[n].length;r++)t.append(n,e[n][r]);else t.append(n,e[n]);return t}class lr{constructor(t){this.$internal=[],this.$instance=t;do this.$internal=this.$internal.concat(Object.getOwnPropertyNames(t),Object.getOwnPropertySymbols(t));while(t=Object.getPrototypeOf(t))}getPrototypeOf(t){return Object.getPrototypeOf(this.$instance)}defineProperty(t,e,n){return!!~this.$internal.indexOf(e)||(Object.defineProperty(t,e,n),!0)}deleteProperty(t,e){return delete t[e]}set(t,e,n,r){return~this.$internal.indexOf(e)?(this.$instance[e]=n,!0):(t[e]=n,!0)}get(t,e,n){return~this.$internal.indexOf(e)?this.$instance[e]:t[e]}}class dr{constructor(){this.identifier="id",this.requestInterceptors=[],this.responseInterceptors=[],this.errorInterceptors=[],this.headers=new Headers,this.queryParams=new URLSearchParams,this.abortCallback=(()=>null)}requestBodyHandler(t){if(t)return t instanceof FormData||t instanceof URLSearchParams?t:t instanceof Vr?t.json():JSON.stringify(t)}responseBodyHandler(t){return t.text().then(t=>{return t?JSON.parse(t):null})}}var yr="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},vr=e(function(t){function e(t){if(t)return n(t)}function n(t){for(var n in e.prototype)t[n]=e.prototype[n];return t}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r,i=0;i<n.length;i++)if((r=n[i])===e||r.fn===e){n.splice(i,1);break}return this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}}),mr=n,wr=e(function(t,e){var n=mr;e.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},e.parse=function(t){return this._parser=t,this},e.serialize=function(t){return this._serializer=t,this},e.timeout=function(t){return this._timeout=t,this},e.then=function(t,e){if(!this._fullfilledPromise){var n=this;this._fullfilledPromise=new Promise(function(t,e){n.end(function(n,r){n?e(n):t(r)})})}return this._fullfilledPromise.then(t,e)},e.catch=function(t){return this.then(void 0,t)},e.use=function(t){return t(this),this},e.get=function(t){return this._header[t.toLowerCase()]},e.getHeader=e.get,e.set=function(t,e){if(n(t)){for(var r in t)this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},e.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},e.field=function(t,e){if(null===t||void 0===t)throw new Error(".field(name, val) name can not be empty");if(n(t)){for(var r in t)this.field(r,t[r]);return this}if(null===e||void 0===e)throw new Error(".field(name, val) val can not be empty");return this._getFormData().append(t,e),this},e.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},e.withCredentials=function(){return this._withCredentials=!0,this},e.redirects=function(t){return this._maxRedirects=t,this},e.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},e._isHost=function(t){switch({}.toString.call(t)){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}},e.send=function(t){var e=n(t),r=this._header["content-type"];if(e&&n(this._data))for(var i in t)this._data[i]=t[i];else"string"==typeof t?(r||this.type("form"),r=this._header["content-type"],this._data="application/x-www-form-urlencoded"==r?this._data?this._data+"&"+t:t:(this._data||"")+t):this._data=t;return!e||this._isHost(t)?this:(r||this.type("json"),this)}}),kr=r,_r=e(function(t){function e(){}function n(t){if(!y(t))return t;var e=[];for(var n in t)r(e,n,t[n]);return e.join("&")}function r(t,e,n){if(null!=n)if(Array.isArray(n))n.forEach(function(n){r(t,e,n)});else if(y(n))for(var i in n)r(t,e+"["+i+"]",n[i]);else t.push(encodeURIComponent(e)+"="+encodeURIComponent(n));else null===n&&t.push(encodeURIComponent(e))}function i(t){for(var e,n,r={},i=t.split("&"),s=0,o=i.length;s<o;++s)e=i[s],n=e.indexOf("="),n==-1?r[decodeURIComponent(e)]="":r[decodeURIComponent(e.slice(0,n))]=decodeURIComponent(e.slice(n+1));return r}function s(t){var e,n,r,i,s=t.split(/\r?\n/),o={};s.pop();for(var u=0,h=s.length;u<h;++u)n=s[u],e=n.indexOf(":"),r=n.slice(0,e).toLowerCase(),i=m(n.slice(e+1)),o[r]=i;return o}function o(t){return/[\/+]json\b/.test(t)}function u(t){return t.split(/ *; */).shift()}function h(t){return t.split(/ *; */).reduce(function(t,e){var n=e.split(/ *= */),r=n.shift(),i=n.shift();return r&&i&&(t[r]=i),t},{})}function c(t,e){e=e||{},this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this._setStatusProperties(this.xhr.status),this.header=this.headers=s(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function p(t,e){var n=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var t=null,e=null;try{e=new c(n)}catch(e){return t=new Error("Parser is unable to parse the response"),t.parse=!0,t.original=e,t.rawResponse=n.xhr&&n.xhr.responseText?n.xhr.responseText:null,t.statusCode=n.xhr&&n.xhr.status?n.xhr.status:null,n.callback(t)}n.emit("response",e);var r;try{(e.status<200||e.status>=300)&&(r=new Error(e.statusText||"Unsuccessful HTTP response"),r.original=t,r.response=e,r.status=e.status)}catch(t){r=t}r?n.callback(r,e):n.callback(null,e)})}function a(t,e){var n=v("DELETE",t);return e&&n.end(e),n}var f;"undefined"!=typeof window?f=window:"undefined"!=typeof self?f=self:(console.warn("Using browser-only version of superagent in non-browser environment"),f=yr);var l=vr,d=wr,y=mr,v=t.exports=kr.bind(null,p);v.getXHR=function(){if(!(!f.XMLHttpRequest||f.location&&"file:"==f.location.protocol&&f.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}throw Error("Browser-only verison of superagent could not find XHR")};var m="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};v.serializeObject=n,v.parseString=i,v.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},v.serialize={"application/x-www-form-urlencoded":n,"application/json":JSON.stringify},v.parse={"application/x-www-form-urlencoded":i,"application/json":JSON.parse},c.prototype.get=function(t){return this.header[t.toLowerCase()]},c.prototype._setHeaderProperties=function(t){var e=this.header["content-type"]||"";this.type=u(e);var n=h(e);for(var r in n)this[r]=n[r]},c.prototype._parseBody=function(t){var e=v.parse[this.type];return!e&&o(this.type)&&(e=v.parse["application/json"]),e&&t&&(t.length||t instanceof Object)?e(t):null},c.prototype._setStatusProperties=function(t){1223===t&&(t=204);var e=t/100|0;this.status=this.statusCode=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.clientError=4==e,this.serverError=5==e,this.error=(4==e||5==e)&&this.toError(),this.accepted=202==t,this.noContent=204==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.notFound=404==t,this.forbidden=403==t},c.prototype.toError=function(){var t=this.req,e=t.method,n=t.url,r="cannot "+e+" "+n+" ("+this.status+")",i=new Error(r);return i.status=this.status,i.method=e,i.url=n,i},v.Response=c,l(p.prototype);for(var w in d)p.prototype[w]=d[w];p.prototype.type=function(t){return this.set("Content-Type",v.types[t]||t),this},p.prototype.responseType=function(t){return this._responseType=t,this},p.prototype.accept=function(t){return this.set("Accept",v.types[t]||t),this},p.prototype.auth=function(t,e,n){switch(n||(n={type:"basic"}),n.type){case"basic":var r=btoa(t+":"+e);this.set("Authorization","Basic "+r);break;case"auto":this.username=t,this.password=e}return this},p.prototype.query=function(t){return"string"!=typeof t&&(t=n(t)),t&&this._query.push(t),this},p.prototype.attach=function(t,e,n){return this._getFormData().append(t,e,n||e.name),this},p.prototype._getFormData=function(){return this._formData||(this._formData=new f.FormData),this._formData},p.prototype.callback=function(t,e){var n=this._callback;this.clearTimeout(),n(t,e)},p.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},p.prototype._timeoutError=function(){var t=this._timeout,e=new Error("timeout of "+t+"ms exceeded");e.timeout=t,this.callback(e)},p.prototype._appendQueryString=function(){var t=this._query.join("&");t&&(this.url+=~this.url.indexOf("?")?"&"+t:"?"+t)},p.prototype.end=function(t){var n=this,r=this.xhr=v.getXHR(),i=this._timeout,s=this._formData||this._data;this._callback=t||e,r.onreadystatechange=function(){if(4==r.readyState){var t;try{t=r.status}catch(e){t=0}if(0==t){if(n.timedout)return n._timeoutError();if(n._aborted)return;return n.crossDomainError()}n.emit("end")}};var u=function(t,e){e.total>0&&(e.percent=e.loaded/e.total*100),e.direction=t,n.emit("progress",e)};if(this.hasListeners("progress"))try{r.onprogress=u.bind(null,"download"),r.upload&&(r.upload.onprogress=u.bind(null,"upload"))}catch(t){}if(i&&!this._timer&&(this._timer=setTimeout(function(){n.timedout=!0,n.abort()},i)),this._appendQueryString(),this.username&&this.password?r.open(this.method,this.url,!0,this.username,this.password):r.open(this.method,this.url,!0),this._withCredentials&&(r.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof s&&!this._isHost(s)){var h=this._header["content-type"],c=this._serializer||v.serialize[h?h.split(";")[0]:""];!c&&o(h)&&(c=v.serialize["application/json"]),c&&(s=c(s))}for(var p in this.header)null!=this.header[p]&&r.setRequestHeader(p,this.header[p]);return this._responseType&&(r.responseType=this._responseType),this.emit("request",this),r.send(void 0!==s?s:null),this},v.Request=p,v.get=function(t,e,n){var r=v("GET",t);return"function"==typeof e&&(n=e,e=null),e&&r.query(e),n&&r.end(n),r},v.head=function(t,e,n){var r=v("HEAD",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},v.options=function(t,e,n){var r=v("OPTIONS",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},v.del=a,v.delete=a,v.patch=function(t,e,n){var r=v("PATCH",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},v.post=function(t,e,n){var r=v("POST",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},v.put=function(t,e,n){var r=v("PUT",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r}});const br=t=>t,gr=(t,e)=>n=>t(e(n)),xr=(t,e)=>t(e);w.prototype.dispose=function(){return this._dispose(this._data)},k.prototype.setDisposable=function(t){if(void 0!==this.disposable)throw new Error("setDisposable called more than once");this.disposable=t,this.disposed&&this._resolve(t.dispose())},k.prototype.dispose=function(){return this.disposed?this.result:(this.disposed=!0,void 0!==this.disposable&&(this.result=this.disposable.dispose()),this.result)};var Pr=p,Tr=br;S.event=function(t,e){return new S(O,t,e)},S.end=function(t,e){return new S(I,t,e)},S.error=function(t,e){return new S(C,t,e)},S.prototype.dispose=function(){this.active=!1},S.prototype.run=function(t){this.active&&this._run(t,this.value,this.sink)},S.prototype.error=function(t,e){if(!this.active)return H(e);this.sink.error(t,e)},M.prototype.run=function(t,e){return e.asap(new S(L,this.value,t))},D.prototype.run=function(t,e){var n=S.end(void 0,t);return e.asap(n),g(B,n)};var Rr=new i(new D);Q.prototype.run=function(t,e){return e.asap(new S(X,this.array,t))};var Er;Er="function"==typeof Set&&"function"==typeof(new Set)["@@iterator"]?"@@iterator":"function"==typeof Symbol&&Symbol.iterator||"_es6shim_iterator_",J.prototype.run=function(t,e){return new V(F(this.iterable),t,e)},V.prototype.dispose=function(){return this.task.dispose()};var qr=void 0;"undefined"!=typeof global?qr=global:"undefined"!=typeof window&&(qr=window);var Ar=function(t){var e,n=t.Symbol;return"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}(qr);Z.prototype.run=function(t,e){var n=this.observable.subscribe(new tt(t,e));if("function"==typeof n)return g(n);if(n&&"function"==typeof n.unsubscribe)return g(et,n);throw new TypeError("Observable returned invalid subscription "+String(n))},tt.prototype.next=function(t){this.sink.event(this.scheduler.now(),t)},tt.prototype.complete=function(t){this.sink.end(this.scheduler.now(),t)},tt.prototype.error=function(t){this.sink.error(this.scheduler.now(),t)},rt.prototype.run=function(){return this.task.run(this.time)},rt.prototype.error=function(t){return this.task.error(this.time,t)},rt.prototype.dispose=function(){return this.scheduler.cancel(this),this.task.dispose()},ot.prototype.now=function(){return this.timer.now()},ot.prototype.asap=function(t){return this.schedule(0,-1,t)},ot.prototype.delay=function(t,e){return this.schedule(t,-1,e)},ot.prototype.periodic=function(t,e){return this.schedule(0,t,e)},ot.prototype.schedule=function(t,e,n){var r=this.now(),i=new rt(r+Math.max(0,t),e,n,this);return this.timeline.add(i),this._scheduleNextRun(r),i},ot.prototype.cancel=function(t){t.active=!1,this.timeline.remove(t)&&this._reschedule()},ot.prototype.cancelAll=function(t){this.timeline.removeAll(t),this._reschedule()},ot.prototype._reschedule=function(){this.timeline.isEmpty()?this._unschedule():this._scheduleNextRun(this.now())},ot.prototype._unschedule=function(){this.timer.clearTimer(this._timer),this._timer=null},ot.prototype._scheduleNextRun=function(t){if(!this.timeline.isEmpty()){var e=this.timeline.nextArrival();null===this._timer?this._scheduleNextArrival(e,t):e<this._nextArrival&&(this._unschedule(),this._scheduleNextArrival(e,t))}},ot.prototype._scheduleNextArrival=function(t,e){this._nextArrival=t;var n=Math.max(0,t-e);this._timer=this.timer.setTimer(this._runReadyTasksBound,n)},ot.prototype._runReadyTasks=function(t){this._timer=null,this.timeline.runTasks(t,st),this._scheduleNextRun(this.now())},ut.prototype.now=Date.now,ut.prototype.setTimer=function(t,e){return e<=0?ct(t):setTimeout(t,e)},ut.prototype.clearTimer=function(t){return t instanceof ht?t.cancel():clearTimeout(t)},ht.prototype.run=function(){return this.active&&this.f()},ht.prototype.error=function(t){throw t},ht.prototype.cancel=function(){this.active=!1},pt.prototype.nextArrival=function(){return this.isEmpty()?1/0:this.tasks[0].time},pt.prototype.isEmpty=function(){return 0===this.tasks.length},pt.prototype.add=function(t){ft(t,this.tasks)},pt.prototype.remove=function(t){var e=dt(t.time,this.tasks);if(e>=0&&e<this.tasks.length){var n=v(t,this.tasks[e].events);if(n>=0)return this.tasks[e].events.splice(n,1),!0}return!1},pt.prototype.removeAll=function(t){for(var e=0,n=this.tasks.length;e<n;++e)lt(t,this.tasks[e])},pt.prototype.runTasks=function(t,e){for(var n=this.tasks,r=n.length,i=0;i<r&&n[i].time<=t;)++i;this.tasks=n.slice(i);for(var s=0;s<i;++s)this.tasks=at(e,n[s],this.tasks)};var $r=new ot(new ut,new pt);mt.prototype.event=function(t,e){"function"==typeof this.subscriber.next&&this.subscriber.next(e)},mt.prototype.end=function(t,e){var n=this.subscriber;kt(this.fatalError,n,n.complete,n.error,this.disposable,e)},mt.prototype.error=function(t,e){var n=this.subscriber;kt(this.fatalError,n,n.error,n.error,this.disposable,e)},wt.prototype.unsubscribe=function(){this.disposable.dispose()},Rt.prototype.event=function(t,e){},Rt.prototype.end=function(t,e){this.active&&(this.active=!1,Et(this._end,this._error,this._disposable,e))},Rt.prototype.error=function(t,e){this.active=!1,Et(this._error,this._error,this._disposable,e)},qt.prototype.event=function(t,e){return this.sink.event(t,e)},qt.prototype.end=function(t,e){return this.sink.end(t,e)},qt.prototype.error=function(t,e){return this.sink.error(t,e)},At.create=function(t,e){
return e instanceof At?new At(Ht(e.p,t),e.source):new At(t,e)},At.prototype.run=function(t,e){return this.source.run(new $t(this.p,t),e)},$t.prototype.end=qt.prototype.end,$t.prototype.error=qt.prototype.error,$t.prototype.event=function(t,e){(0,this.p)(e)&&this.sink.event(t,e)},St.prototype.run=function(t,e){return this.source.run(new Ct(this.p,this.f,t),e)},Ct.prototype.event=function(t,e){var n=this.f;(0,this.p)(e)&&this.sink.event(t,n(e))},Ct.prototype.end=qt.prototype.end,Ct.prototype.error=qt.prototype.error,Ot.create=function(t,e){return e instanceof Ot?new Ot(gr(t,e.f),e.source):e instanceof At?new St(e.p,t,e.source):new Ot(t,e)},Ot.prototype.run=function(t,e){return this.source.run(new It(this.f,t),e)},It.prototype.end=qt.prototype.end,It.prototype.error=qt.prototype.error,It.prototype.event=function(t,e){var n=this.f;this.sink.event(t,n(e))},Ut.prototype.run=function(t,e){return this.source.run(new Dt(this.f,t),e)},Dt.prototype.end=qt.prototype.end,Dt.prototype.error=qt.prototype.error,Dt.prototype.event=function(t,e){(0,this.f)(e),this.sink.event(t,e)},Xt.prototype.run=function(t,e){return this.source.run(new zt(this.step,this.seed,t),e)},zt.prototype.error=qt.prototype.error,zt.prototype.event=function(t,e){var n=this.step(this.seed,e);this.seed=n.seed,this.sink.event(t,n.value)},zt.prototype.end=function(t){this.sink.end(t,this.seed)},Wt.prototype.run=function(t,e){return P([e.asap(S.event(this.value,t)),this.source.run(new Jt(this.f,this.value,t),e)])},Jt.prototype.event=function(t,e){var n=this.f;this.value=n(this.value,e),this.sink.event(t,this.value)},Jt.prototype.error=qt.prototype.error,Jt.prototype.end=qt.prototype.end,Gt.prototype.run=function(t,e){return this.source.run(new Kt(this.f,this.value,t),e)},Kt.prototype.event=function(t,e){var n=this.f;this.value=n(this.value,e),this.sink.event(t,this.value)},Kt.prototype.error=qt.prototype.error,Kt.prototype.end=function(t){this.sink.end(t,this.value)},Zt.prototype.run=function(t,e){return new te(this.f,this.source,t,e)},te.prototype.error=qt.prototype.error,te.prototype.event=function(t,e){this.active&&this.sink.event(t,e)},te.prototype.end=function(t,e){this.active&&(b(t,this.disposable,this.sink),this._startNext(t,e,this.sink))},te.prototype._startNext=function(t,e,n){try{this.disposable=this._continue(this.f,e,n)}catch(e){n.error(t,e)}},te.prototype._continue=function(t,e,n){return t(e).source.run(n,this.scheduler)},te.prototype.dispose=function(){return this.active=!1,this.disposable.dispose()},re.prototype.event=function(t,e){this.active&&(this.value=e,this.sink.event(t,this))},re.prototype.end=function(t,e){this.active&&(this.active=!1,this.sink.end(t,{index:this.index,value:e}))},re.prototype.error=qt.prototype.error;var Hr=p,Sr=c;ce.prototype.run=function(t,e){for(var n,r=this.sources.length,i=new Array(r),s=new Array(r),o=new pe(i,s,t,this.f),u=0;u<r;++u)n=s[u]=new re(u,o),i[u]=this.sources[u].run(n,e);return P(i)},pe.prototype.error=qt.prototype.error,pe.prototype.event=function(t,e){var n=e.index,r=this._updateReady(n);this.values[n]=e.value,0===r&&this.sink.event(t,ie(this.f,this.values))},pe.prototype._updateReady=function(t){return this.awaiting>0&&(this.hasValue[t]||(this.hasValue[t]=!0,this.awaiting-=1)),this.awaiting},pe.prototype.end=function(t,e){b(t,this.disposables[e.index],this.sink),0==--this.activeCount&&this.sink.end(t,e.value)},le.prototype.run=function(t,e){var n=this.transducer(new ye(t));return this.source.run(new de(ve(n),t),e)},de.prototype.event=function(t,e){var n=this.xf.step(t,e);return this.xf.isReduced(n)?this.sink.end(t,this.xf.getResult(n)):n},de.prototype.end=function(t,e){return this.xf.result(e)},de.prototype.error=function(t,e){return this.sink.error(t,e)},ye.prototype["@@transducer/init"]=ye.prototype.init=function(){},ye.prototype["@@transducer/step"]=ye.prototype.step=function(t,e){return isNaN(t)||(this.time=Math.max(t,this.time)),this.sink.event(this.time,e)},ye.prototype["@@transducer/result"]=ye.prototype.result=function(t){return this.sink.end(this.time,t)},me.prototype.step=function(t,e){return this.tx["@@transducer/step"](t,e)},me.prototype.result=function(t){return this.tx["@@transducer/result"](t)},me.prototype.isReduced=function(t){return null!=t&&t["@@transducer/reduced"]},me.prototype.getResult=function(t){return t["@@transducer/value"]},we.prototype.step=function(t,e){return this.tx.step(t,e)},we.prototype.result=function(t){return this.tx.result(t)},we.prototype.isReduced=function(t){return null!=t&&t.__transducers_reduced__},we.prototype.getResult=function(t){return t.value},ke.prototype.add=function(t){null!==this.head&&(this.head.prev=t,t.next=this.head),this.head=t,++this.length},ke.prototype.remove=function(t){--this.length,t===this.head&&(this.head=this.head.next),null!==t.next&&(t.next.prev=t.prev,t.next=null),null!==t.prev&&(t.prev.next=t.next,t.prev=null)},ke.prototype.isEmpty=function(){return 0===this.length},ke.prototype.dispose=function(){if(this.isEmpty())return Promise.resolve();var t=[],e=this.head;for(this.head=null,this.length=0;null!==e;)t.push(e.dispose()),e=e.next;return Promise.all(t)},ge.prototype.run=function(t,e){return new xe(this.f,this.concurrency,this.source,t,e)},xe.prototype.event=function(t,e){this._addInner(t,e)},xe.prototype._addInner=function(t,e){this.current.length<this.concurrency?this._startInner(t,e):this.pending.push(e)},xe.prototype._startInner=function(t,e){try{this._initInner(t,e)}catch(e){this.error(t,e)}},xe.prototype._initInner=function(t,e){var n=new Te(t,this,this.sink);n.disposable=Pe(this.f,e,n,this.scheduler),this.current.add(n)},xe.prototype.end=function(t,e){this.active=!1,b(t,this.disposable,this.sink),this._checkEnd(t,e)},xe.prototype.error=function(t,e){this.active=!1,this.sink.error(t,e)},xe.prototype.dispose=function(){return this.active=!1,this.pending.length=0,Promise.all([this.disposable.dispose(),this.current.dispose()])},xe.prototype._endInner=function(t,e,n){this.current.remove(n),b(t,n,this),0===this.pending.length?this._checkEnd(t,e):this._startInner(t,this.pending.shift())},xe.prototype._checkEnd=function(t,e){!this.active&&this.current.isEmpty()&&this.sink.end(t,e)},Te.prototype.event=function(t,e){this.sink.event(Math.max(t,this.time),e)},Te.prototype.end=function(t,e){this.outer._endInner(Math.max(t,this.time),e,this)},Te.prototype.error=function(t,e){this.outer.error(Math.max(t,this.time),e)},Te.prototype.dispose=function(){return this.disposable.dispose()};var Cr=a;Se.prototype.run=function(t,e){for(var n,r=this.sources.length,i=new Array(r),s=new Array(r),o=new Ce(i,s,t),u=0;u<r;++u)n=s[u]=new re(u,o),i[u]=this.sources[u].run(n,e);return P(i)},Ce.prototype.error=qt.prototype.error,Ce.prototype.event=function(t,e){this.sink.event(t,e.value)},Ce.prototype.end=function(t,e){b(t,this.disposables[e.index],this.sink),0==--this.activeCount&&this.sink.end(t,e.value)},Me.prototype.run=function(t,e){for(var n,r=this.sources.length,i=new Array(r+1),s=new Array(r),o=new Ue(this.f,s,t),u=0;u<r;++u)n=s[u]=new Le(o),i[u]=this.sources[u].run(n,e);return i[u]=this.sampler.run(o,e),P(i)},Le.prototype.event=function(t,e){this.value=e,this.hasValue=!0,this.sink._notify(this)},Le.prototype.end=function(){},Le.prototype.error=qt.prototype.error,Ue.prototype._notify=function(){this.active||(this.active=this.sinks.every(De))},Ue.prototype.event=function(t){this.active&&this.sink.event(t,ie(this.f,p(Be,this.sinks)))},Ue.prototype.end=qt.prototype.end,Ue.prototype.error=qt.prototype.error,Ne.prototype.push=function(t){var e=this._length;this._checkCapacity(e+1),this[this._head+e&this._capacity-1]=t,this._length=e+1},Ne.prototype.shift=function(){var t=this._head,e=this[t];return this[t]=void 0,this._head=t+1&this._capacity-1,this._length--,e},Ne.prototype.isEmpty=function(){return 0===this._length},Ne.prototype.length=function(){return this._length},Ne.prototype._checkCapacity=function(t){this._capacity<t&&this._ensureCapacity(this._capacity<<1)},Ne.prototype._ensureCapacity=function(t){var e=this._capacity;this._capacity=t;var n=this._head+this._length;n>e&&Qe(this,0,this,e,n&e-1)};var Or=p;Fe.prototype.run=function(t,e){for(var n,r=this.sources.length,i=new Array(r),s=new Array(r),o=new Array(r),u=new We(this.f,o,s,t),h=0;h<r;++h)o[h]=new Ne,n=s[h]=new re(h,u),i[h]=this.sources[h].run(n,e);return P(i)},We.prototype.event=function(t,e){var n=this.buffers,r=n[e.index];if(r.push(e.value),1===r.length()){if(!Ke(this.buffers))return;Je(this.f,t,n,this.sink),Ge(this.buffers,this.sinks)&&this.sink.end(t,void 0)}},We.prototype.end=function(t,e){this.buffers[e.index].isEmpty()&&this.sink.end(t,e.value)},We.prototype.error=qt.prototype.error,Ze.prototype.run=function(t,e){var n=new tn(t,e);return P([n,this.source.run(n,e)])},tn.prototype.event=function(t,e){this._disposeCurrent(t),this.current=new en(t,1/0,this,this.sink),this.current.disposable=e.source.run(this.current,this.scheduler)},tn.prototype.end=function(t,e){this.ended=!0,this._checkEnd(t,e)},tn.prototype.error=function(t,e){this.ended=!0,this.sink.error(t,e)},tn.prototype.dispose=function(){return this._disposeCurrent(this.scheduler.now())},tn.prototype._disposeCurrent=function(t){if(null!==this.current)return this.current._dispose(t)},tn.prototype._disposeInner=function(t,e){e._dispose(t),e===this.current&&(this.current=null)},tn.prototype._checkEnd=function(t,e){this.ended&&null===this.current&&this.sink.end(t,e)},tn.prototype._endInner=function(t,e,n){this._disposeInner(t,n),this._checkEnd(t,e)},tn.prototype._errorInner=function(t,e,n){this._disposeInner(t,n),this.sink.error(t,e)},en.prototype.event=function(t,e){t<this.max&&this.sink.event(Math.max(t,this.min),e)},en.prototype.end=function(t,e){this.outer._endInner(Math.max(t,this.min),e,this)},en.prototype.error=function(t,e){this.outer._errorInner(Math.max(t,this.min),e,this)},en.prototype._dispose=function(t){this.max=t,b(t,this.disposable,this.sink)},on.prototype.run=function(t,e){return this.source.run(new un(this.equals,t),e)},un.prototype.end=qt.prototype.end,un.prototype.error=qt.prototype.error,un.prototype.event=function(t,e){this.init?(this.init=!1,this.value=e,this.sink.event(t,e)):this.equals(this.value,e)||(this.value=e,this.sink.event(t,e))},yn.prototype.run=function(t,e){return new vn(this.min,this.max-this.min,this.source,t,e)},vn.prototype.end=qt.prototype.end,vn.prototype.error=qt.prototype.error,vn.prototype.event=function(t,e){if(this.skip>0)return void(this.skip-=1);0!==this.take&&(this.take-=1,this.sink.event(t,e),0===this.take&&(this.dispose(),this.sink.end(t,e)))},vn.prototype.dispose=function(){return this.disposable.dispose()},wn.prototype.run=function(t,e){return new kn(this.p,this.source,t,e)},kn.prototype.end=qt.prototype.end,kn.prototype.error=qt.prototype.error,kn.prototype.event=function(t,e){if(this.active){var n=this.p;this.active=n(e),this.active?this.sink.event(t,e):(this.dispose(),this.sink.end(t,e))}},kn.prototype.dispose=function(){return this.disposable.dispose()},bn.prototype.run=function(t,e){return this.source.run(new gn(this.p,t),e)},gn.prototype.end=qt.prototype.end,gn.prototype.error=qt.prototype.error,gn.prototype.event=function(t,e){if(this.skipping){var n=this.p;if(this.skipping=n(e),this.skipping)return}this.sink.event(t,e)},Rn.prototype.run=function(t,e){var n=new qn(-(1/0),t),r=new Hn(this.maxSignal,t,e);return P([n,r,this.source.run(new An(n,r,t),e)])},En.prototype.run=function(t,e){var n=new $n(this.minSignal,t,e),r=new qn(1/0,t);return P([n,r,this.source.run(new An(n,r,t),e)])},qn.prototype.error=qt.prototype.error,qn.prototype.event=Sn,qn.prototype.end=Sn,qn.prototype.dispose=Sn,An.prototype.event=function(t,e){t>=this.min.value&&t<this.max.value&&this.sink.event(t,e)},An.prototype.error=qt.prototype.error,An.prototype.end=qt.prototype.end,$n.prototype.event=function(t){t<this.value&&(this.value=t)},$n.prototype.end=Sn,$n.prototype.error=qt.prototype.error,$n.prototype.dispose=function(){return this.disposable.dispose()},Hn.prototype.event=function(t,e){t<this.value&&(this.value=t,this.sink.end(t,e))},Hn.prototype.end=Sn,Hn.prototype.error=qt.prototype.error,Hn.prototype.dispose=function(){return this.disposable.dispose()},On.prototype.run=function(t,e){var n=new In(this.dt,t,e);return P([n,this.source.run(n,e)])},In.prototype.dispose=function(){var t=this;this.scheduler.cancelAll(function(e){return e.sink===t.sink})},In.prototype.event=function(t,e){this.scheduler.delay(this.dt,S.event(e,this.sink))},In.prototype.end=function(t,e){this.scheduler.delay(this.dt,S.end(e,this.sink))},In.prototype.error=qt.prototype.error,Mn.prototype.run=function(t,e){return this.source.run(new Ln(t),e)},Ln.prototype.end=qt.prototype.end,Ln.prototype.error=qt.prototype.error,Ln.prototype.event=function(t,e){this.sink.event(t,{time:t,value:e})},Qn.prototype.run=function(t,e){return this.source.run(new Xn(this.period,t),e)},Xn.prototype.event=function(t,e){t>=this.time&&(this.time=t+this.period,this.sink.event(t,e))},Xn.prototype.end=qt.prototype.end,Xn.prototype.error=qt.prototype.error,Fn.prototype.run=function(t,e){return new Wn(this.dt,this.source,t,e)},Wn.prototype.event=function(t,e){this._clearTimer(),this.value=e,this.timer=this.scheduler.delay(this.dt,S.event(e,this.sink))},Wn.prototype.end=function(t,e){this._clearTimer()&&(this.sink.event(t,this.value),this.value=void 0),this.sink.end(t,e)},Wn.prototype.error=function(t,e){this._clearTimer(),this.sink.error(t,e)},Wn.prototype.dispose=function(){this._clearTimer()},Wn.prototype._clearTimer=function(){return null!==this.timer&&(this.timer.dispose(),this.timer=null,!0)},Gn.prototype.run=function(t,e){return this.source.run(new Kn(t,e),e)},Kn.prototype.event=function(t,e){var n=this;this.queue=this.queue.then(function(){return n._event(e)}).catch(this._errorBound)},Kn.prototype.end=function(t,e){var n=this;this.queue=this.queue.then(function(){return n._end(e)}).catch(this._errorBound)},Kn.prototype.error=function(t,e){var n=this;this.queue=this.queue.then(function(){return n._errorBound(e)}).catch(H)},Kn.prototype._event=function(t){return t.then(this._eventBound)},Kn.prototype._end=function(t){return Promise.resolve(t).then(this._endBound)},Yn.prototype.event=function(t,e){this.active&&this.sink.event(t,e)},Yn.prototype.end=function(t,e){this.active&&(this.disable(),this.sink.end(t,e))},Yn.prototype.error=function(t,e){this.disable(),this.sink.error(t,e)},Yn.prototype.disable=function(){return this.active=!1,this.sink};var Ir=Zn;er.prototype.run=function(t,e){return e.asap(new S(nr,this.value,t))},rr.prototype.run=function(t,e){return new ir(this.f,this.source,t,e)},ir.prototype.event=function(t,e){bt(t,e,this.sink)},ir.prototype.end=function(t,e){gt(t,e,this.sink)},ir.prototype.error=function(t,e){var n=this.sink.disable();b(t,this.disposable,this.sink),this._startNext(t,e,n)},ir.prototype._startNext=function(t,e,n){try{this.disposable=this._continue(this.f,e,n)}catch(e){n.error(t,e)}},ir.prototype._continue=function(t,e,n){return t(e).source.run(n,this.scheduler)},ir.prototype.dispose=function(){return this.disposable.dispose()};class jr{constructor(t,e){this.source=t,this.sink=e,this.disposed=!1}dispose(){if(!this.disposed){this.disposed=!0;return 0===this.source.remove(this.sink)&&this.source._dispose()}}}const Mr=t=>t.dispose(),Lr={dispose(){}};class Ur{constructor(t){this.source=t,this.sinks=[],this._disposable=Lr}run(t,e){return 1===this.add(t)&&(this._disposable=this.source.run(this,e)),new jr(this,t)}_dispose(){const t=this._disposable;return this._disposable=Lr,Promise.resolve(t).then(Mr)}add(t){return this.sinks=o(t,this.sinks),this.sinks.length}remove(t){const e=v(t,this.sinks);return e>=0&&(this.sinks=l(e,this.sinks)),this.sinks.length}event(t,e){const n=this.sinks;if(1===n.length)return n[0].event(t,e);for(let r=0;r<n.length;++r)sr(t,e,n[r])}end(t,e){const n=this.sinks;for(let r=0;r<n.length;++r)or(t,e,n[r])}error(t,e){const n=this.sinks;for(let r=0;r<n.length;++r)n[r].error(t,e)}}i.of=j,i.empty=U,i.from=nt,i.prototype.subscribe=function(t){return vt(t,this)},i.prototype[Ar]=function(){return this},i.prototype.thru=function(t){return _t(t,this)},i.prototype.observe=i.prototype.forEach=function(t){return Bt(t,this)},i.prototype.drain=function(){return Nt(this)},i.prototype.loop=function(t,e){return Qt(t,e,this)},i.prototype.scan=function(t,e){return Ft(t,e,this)},i.prototype.reduce=function(t,e){return Vt(t,e,this)},i.prototype.concat=function(t){return ne(this,t)},i.prototype.startWith=function(t){return ee(t,this)},i.prototype.map=function(t){return jt(t,this)},i.prototype.ap=function(t){return ae(this,t)},i.prototype.constant=function(t){return Mt(t,this)},i.prototype.tap=function(t){return Lt(t,this)},i.prototype.transduce=function(t){return fe(t,this)},i.prototype.flatMap=i.prototype.chain=function(t){return Re(t,this)},i.prototype.join=function(){return Ee(this)},i.prototype.continueWith=i.prototype.flatMapEnd=function(t){return Yt(t,this)},i.prototype.concatMap=function(t){return qe(t,this)},i.prototype.mergeConcurrently=function(t){return _e(t,this)},i.prototype.merge=function(){return Ae(s(this,arguments))},i.prototype.combine=function(t){return oe(t,f(this,0,arguments))},i.prototype.sampleWith=function(t){return Oe(t,this)},i.prototype.sample=function(t){return Ie(t,this,c(arguments))},i.prototype.zip=function(t){return Xe(t,f(this,0,arguments))},i.prototype.switch=i.prototype.switchLatest=function(){return Ye(this)},i.prototype.filter=function(t){return nn(t,this)},i.prototype.skipRepeats=function(){return rn(this)},i.prototype.skipRepeatsWith=function(t){return sn(t,this)},i.prototype.take=function(t){return cn(t,this)},i.prototype.skip=function(t){return pn(t,this)},i.prototype.slice=function(t,e){return an(t,e,this)},i.prototype.takeWhile=function(t){return mn(t,this)},i.prototype.skipWhile=function(t){return _n(t,this)},i.prototype.until=i.prototype.takeUntil=function(t){return xn(t,this)},i.prototype.since=i.prototype.skipUntil=function(t){return Pn(t,this)},i.prototype.during=function(t){return Tn(t,this)},i.prototype.delay=function(t){return Cn(t,this)},i.prototype.timestamp=function(){return jn(this)},i.prototype.throttle=function(t){return Un(t,this)},i.prototype.debounce=function(t){return zn(t,this)},i.prototype.await=function(){return Vn(this)},i.prototype.recoverWith=i.prototype.flatMapError=function(t){return Ir(t,this)},i.prototype.multicast=function(){return ur(this)};var Dr=function(t,e,n){this.sink=t,this.time=e,this.events=n};Dr.prototype.run=function(){for(var t,e=this,n=this.events,r=this.sink,i=0,s=n.length;i<s;++i)t=n[i],e.time=t.time,r.event(t.time,t.value);n.length=0},Dr.prototype.error=function(t){this.sink.error(this.time,t)};var Br=function(t,e,n){this.time=t,this.value=e,this.sink=n};Br.prototype.run=function(){this.sink.end(this.time,this.value)},Br.prototype.error=function(t){this.sink.error(this.time,t)};var Nr=function(t,e,n){this.time=t,this.value=e,this.sink=n};Nr.prototype.run=function(){this.sink.error(this.time,this.value)},Nr.prototype.error=function(t){throw t};var Qr=function(t){this.sink=t,this.events=[],this.active=!0};Qr.prototype.event=function(t,e){this.active&&(0===this.events.length&&hr(new Dr(this.sink,t,this.events)),this.events.push({time:t,value:e}))},Qr.prototype.end=function(t,e){this.active&&this._end(new Br(t,e,this.sink))},Qr.prototype.error=function(t,e){this._end(new Nr(t,e,this.sink))},Qr.prototype._end=function(t){this.active=!1,hr(t)};var Xr=function(t,e,n){this.sink=t,this.scheduler=e,this._unsubscribe=this._init(n)};Xr.prototype._init=function(t){var e=this,n=function(t){return e.sink.event(e.scheduler.now(),t)},r=function(t){return e.sink.end(e.scheduler.now(),t)},i=function(t){return e.sink.error(e.scheduler.now(),t)};try{return t(n,r,i)}catch(t){i(t)}},Xr.prototype.dispose=function(){if("function"==typeof this._unsubscribe)return this._unsubscribe.call(void 0)};var zr=function(t){this._subscribe=t};zr.prototype.run=function(t,e){return new Xr(new Qr(t),e,this._subscribe)};const Fr=function(t){return pr((e,n,r)=>{t.then(t=>{e(t),n()}).catch(r)})},Wr=new dr;class Jr{constructor(t){this.$fromServer=!1,this.$queryParams=new URLSearchParams,this.$headers=new Headers,this.$route=void 0===t?[]:[...t]}addRoute(t){this.$route.push.apply(this.$route,t.split("/"))}one(t,e){this.addRoute(t);let n={};return e&&(n[this.identifier]=e),new Vr(this.$route,n)}all(t){return this.addRoute(t),new Gr(this.$route)}fromObject(t,e){return this.addRoute(t),Array.isArray(e)?new Gr(this.$route,e):new Vr(this.$route,e)}withBody(t){return t?t:this}post(t,e,n){return this.localQueryParams=e,this.localHeaders=n,this.request("POST",this.withBody(t))}remove(t,e){return this.localQueryParams=t,this.localHeaders=e,this.request("DELETE")}get(t,e){return this.localQueryParams=t,this.localHeaders=e,this.request("GET")}put(t,e,n){return this.localQueryParams=e,this.localHeaders=n,this.request("PUT",this.withBody(t))}patch(t,e,n){return this.localQueryParams=e,this.localHeaders=n,this.request("PATCH",this.withBody(t))}head(t,e){return this.localQueryParams=t,this.localHeaders=e,this.request("HEAD")}trace(t,e){return this.localQueryParams=t,this.localHeaders=e,this.request("TRACE")}options(t,e){return this.localQueryParams=t,this.localHeaders=e,this.request("OPTIONS")}get URL(){return`${Wr.baseURL}${this.$route.join("/")}`}set baseURL(t){"/"!==t.charAt(t.length-1)&&(t+="/"),Wr.baseURL=t}get baseURL(){return Wr.baseURL}set identifier(t){Wr.identifier=t}get identifier(){return Wr.identifier}set localQueryParams(t){if(t)return t instanceof URLSearchParams?void(this.$queryParams=t):void(this.$queryParams=fr(new URLSearchParams,t))}setQueryParams(t){return this.localQueryParams=t,this}setHeaders(t){return this.localHeaders=t,this}get localQueryParams(){return this.$queryParams}set queryParams(t){return t instanceof URLSearchParams?void(Wr.queryParams=t):"string"==typeof t?void(Wr.queryParams=new URLSearchParams(t)):void(Wr.queryParams=fr(new URLSearchParams,t))}get queryParams(){return Wr.queryParams}get requestQueryParams(){let t=new URLSearchParams;for(let e of this.queryParams)t.append(e[0],e[1]);for(let e of this.localQueryParams)t.append(e[0],e[1]);let e=t.toString();return e.length?"?"+e:""}set localHeaders(t){if(t)return t instanceof Headers?void(this.$headers=t):void(this.$headers=fr(new Headers,t))}get localHeaders(){return this.$headers}set headers(t){if(t instanceof Headers)return void(Wr.headers=t);Wr.headers=fr(new Headers,t)}get headers(){return Wr.headers}get requestHeaders(){let t=new Headers;for(let e of this.headers)t.append(e[0],e[1]);for(let e of this.localHeaders)t.append(e[0],e[1]);return t}get requestInterceptors(){return Wr.requestInterceptors}set requestInterceptors(t){Wr.requestInterceptors=t}get responseInterceptors(){return Wr.responseInterceptors}set responseInterceptors(t){Wr.responseInterceptors=t}get errorInterceptors(){return Wr.errorInterceptors}set errorInterceptors(t){Wr.errorInterceptors=t}set requestBodyHandler(t){Wr.requestBodyHandler=t}get requestBodyHandler(){return Wr.requestBodyHandler}set responseBodyHandler(t){Wr.responseBodyHandler=t}get responseBodyHandler(){return Wr.responseBodyHandler}set abortCallback(t){Wr.abortCallback=t}get abortCallback(){return Wr.abortCallback}get fetch(){return Wr.fetch?Wr.fetch:ar}set fetch(t){Wr.fetch=t}expandInterceptors(t){return function(e){return t.reduce((t,e)=>t.concatMap(t=>{let n=e(t);return void 0===n?j(t):n instanceof Promise?Fr(n):n instanceof i?n:j(n)}),j(e))}}request(t,e){let n={method:t,headers:this.requestHeaders,body:this.requestBodyHandler(e)};return j(new Request(this.URL+this.requestQueryParams,n)).flatMap(this.expandInterceptors(Wr.requestInterceptors)).flatMap(t=>this.fetch(t,null,this.abortCallback)).flatMap(this.expandInterceptors(Wr.responseInterceptors)).flatMap(t=>Fr(this.responseBodyHandler(t))).flatMap(t=>{if(!Array.isArray(t)){let e;return this instanceof Vr?(e=this,e.element=t):e=new Vr(this.$route,t),e.$fromServer=!0,pr((t,n,r)=>{t(e),n(e)})}let e=new Gr(this.$route,t.map(t=>{let e=new Vr(this.$route,t);return e.$fromServer=!0,e}));return pr((t,n,r)=>{for(let n of e)t(n);n(e)})}).recoverWith(t=>{return j(t).flatMap(this.expandInterceptors(Wr.errorInterceptors)).flatMap(t=>tr(t))})}}class Vr extends Jr{constructor(t,e){return super(t),this.$element={},void 0!==e&&(this.element=e),new Proxy(this.$element,new lr(this))}save(t,e){return this.localQueryParams=t,this.localHeaders=e,this.request(this.$fromServer===!0?"PUT":"POST",this)}set element(t){for(let e in t)e!==this.identifier||this.$element[this.identifier]||this.$route.push(""+t[e]),this.$element[e]=t[e]}get element(){return this.$element}plain(){return this.element}json(){return JSON.stringify(this.plain())}clone(){let t=this.$route;this.$element[this.identifier]&&(t=t.slice(0,this.$route.length-1));let e=new Vr(t,this.$element);return e.$fromServer=this.$fromServer,e}}class Gr extends Jr{constructor(t,e){return super(t),this.$elements=[],void 0!==e&&(this.elements=e.map(t=>t instanceof Vr?t.clone():new Vr(this.$route,t))),new Proxy(this.$elements,new lr(this))}[Symbol.iterator](){let t=0,e=this.$elements;return{next(){return t<e.length?{value:e[t++],done:!1}:{value:void 0,done:!0}}}}getList(t,e){return this.localQueryParams=t,this.localHeaders=e,this.request("GET")}set elements(t){this.$elements=t,this.length=t.length}get elements(){return this.$elements}plain(){return this.elements.map(t=>t.plain())}json(){return JSON.stringify(this.plain())}clone(){return new Gr(this.$route,this.$elements)}}class Kr{one(t,e){let n=new Jr;return n.one.call(n,t,e)}all(t){let e=new Jr;return e.all.call(e,t)}fromObject(t,e){let n=new Jr;return n.fromObject.call(n,t,e)}}t.RxRest=Jr,t.RxRestItem=Vr,t.RxRestCollection=Gr,t.NewRxRest=Kr,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=rxrest.bundle.min.js.map
