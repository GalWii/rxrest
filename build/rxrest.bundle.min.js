"use strict";function objectToMap(t,e){for(var r in e)if(Array.isArray(e[r]))for(var n=0;n<e[r].length;n++)t.append(r,e[r][n]);else t.append(r,e[r]);return t}function createCommonjsModule(t,e){return e={exports:{}},t(e,e.exports),e.exports}function isObject(t){return null!==t&&"object"==typeof t}function RequestBase(t){if(t)return mixin(t)}function mixin(t){for(var e in RequestBase.prototype)t[e]=RequestBase.prototype[e];return t}function isFunction(t){return"[object Function]"===(isObject_1(t)?Object.prototype.toString.call(t):"")}function ResponseBase(t){if(t)return mixin$1(t)}function mixin$1(t){for(var e in ResponseBase.prototype)t[e]=ResponseBase.prototype[e];return t}function Stream(t){this.source=t}function cons(t,e){var r=e.length,n=new Array(r+1);n[0]=t;for(var i=0;i<r;++i)n[i+1]=e[i];return n}function append(t,e){for(var r=e.length,n=new Array(r+1),i=0;i<r;++i)n[i]=e[i];return n[r]=t,n}function drop(t,e){if(t<0)throw new TypeError("n must be >= 0");var r=e.length;return 0===t||0===r?e:t>=r?[]:unsafeDrop(t,e,r-t)}function unsafeDrop(t,e,r){for(var n=new Array(r),i=0;i<r;++i)n[i]=e[t+i];return n}function tail(t){return drop(1,t)}function map(t,e){for(var r=e.length,n=new Array(r),i=0;i<r;++i)n[i]=t(e[i]);return n}function reduce(t,e,r){for(var n=e,i=0,o=r.length;i<o;++i)n=t(n,r[i],i);return n}function replace(t,e,r){if(e<0)throw new TypeError("i must be >= 0");for(var n=r.length,i=new Array(n),o=0;o<n;++o)i[o]=e===o?t:r[o];return i}function remove(t,e){if(t<0)throw new TypeError("i must be >= 0");var r=e.length;return 0===r||t>=r?e:1===r?[]:unsafeRemove(t,e,r-1)}function unsafeRemove(t,e,r){var n,i=new Array(r);for(n=0;n<t;++n)i[n]=e[n];for(n=t;n<r;++n)i[n]=e[n+1];return i}function removeAll(t,e){for(var r=e.length,n=new Array(r),i=0,o=void 0,s=0;s<r;++s)t(o=e[s])||(n[i]=o,++i);return n.length=i,n}function findIndex(t,e){for(var r=0,n=e.length;r<n;++r)if(t===e[r])return r;return-1}function isArrayLike(t){return null!=t&&"number"==typeof t.length&&"function"!=typeof t}function Disposable(t,e){this._dispose=t,this._data=e}function SettableDisposable(){this.disposable=void 0,this.disposed=!1,this._resolve=void 0;var t=this;this.result=new Promise(function(e){t._resolve=e})}function isPromise(t){return null!==t&&"object"==typeof t&&"function"==typeof t.then}function tryDispose(t,e,r){var n=disposeSafely(e);return isPromise(n)?n.catch(function(e){r.error(t,e)}):n}function create(t,e){return once(new Disposable(t,e))}function empty$1(){return new Disposable(identity,void 0)}function all(t){return create(disposeAll,t)}function disposeAll(t){return Promise.all(map$1(disposeSafely,t))}function disposeSafely(t){try{return t.dispose()}catch(t){return Promise.reject(t)}}function settable(){return new SettableDisposable}function once(t){return new Disposable(disposeMemoized,memoized(t))}function disposeMemoized(t){return t.disposed||(t.disposed=!0,t.value=disposeSafely(t.disposable),t.disposable=void 0),t.value}function memoized(t){return{disposed:!1,disposable:t,value:void 0}}function fatalError(t){setTimeout(function(){throw t},0)}function PropagateTask(t,e,r){this._run=t,this.value=e,this.sink=r,this.active=!0}function error(t,e,r){r.error(t,e)}function emit(t,e,r){r.event(t,e)}function end(t,e,r){r.end(t,e)}function of(t){return new Stream(new Just(t))}function Just(t){this.value=t}function runJust(t,e,r){r.event(t,e),r.end(t,void 0)}function empty(){return EMPTY}function EmptySource(){}function disposeEmpty(t){return t.dispose()}function fromArray(t){return new Stream(new ArraySource(t))}function ArraySource(t){this.array=t}function runProducer(t,e,r){for(var n=0,i=e.length;n<i&&this.active;++n)r.event(t,e[n]);this.active&&r.end(t)}function isIterable(t){return"function"==typeof t[iteratorSymbol]}function getIterator(t){return t[iteratorSymbol]()}function fromIterable(t){return new Stream(new IterableSource(t))}function IterableSource(t){this.iterable=t}function runProducer$1(t,e,r){for(var n=e.next();!n.done&&this.active;)r.event(t,n.value),n=e.next();r.end(t,n.value)}function symbolObservablePonyfill(t){var e,r=t.Symbol;return"function"==typeof r?r.observable?e=r.observable:(e=r("observable"),r.observable=e):e="@@observable",e}function getObservable(t){var e=null;if(t){var r=t[result];if("function"==typeof r&&(!(e=r.call(t))||"function"!=typeof e.subscribe))throw new TypeError("invalid observable "+e)}return e}function tryEvent(t,e,r){try{r.event(t,e)}catch(e){r.error(t,e)}}function tryEnd(t,e,r){try{r.end(t,e)}catch(e){r.error(t,e)}}function fromObservable(t){return new Stream(new ObservableSource(t))}function ObservableSource(t){this.observable=t}function SubscriberSink(t,e){this.sink=t,this.scheduler=e}function unsubscribe(t){return t.unsubscribe()}function from(t){if(t instanceof Stream)return t;var e=getObservable(t);if(null!=e)return fromObservable(e);if(Array.isArray(t)||isArrayLike(t))return fromArray(t);if(isIterable(t))return fromIterable(t);throw new TypeError("from(x) must be observable, iterable, or array-like: "+t)}function ScheduledTask(t,e,r,n){this.time=t,this.period=e,this.task=r,this.scheduler=n,this.active=!0}function defer(t){return Promise.resolve(t).then(runTask)}function runTask(t){try{return t.run()}catch(e){return t.error(e)}}function Scheduler(t,e){this.timer=t,this.timeline=e,this._timer=null,this._nextArrival=1/0;var r=this;this._runReadyTasksBound=function(){r._runReadyTasks(r.now())}}function ClockTimer(){}function Asap(t){this.f=t,this.active=!0}function runAsap(t){var e=new Asap(t);return defer(e),e}function Timeline(){this.tasks=[]}function runTasks(t,e,r){for(var n=e.events,i=0;i<n.length;++i){var o=n[i];o.active&&(t(o),o.period>=0&&o.active&&(o.time=o.time+o.period,insertByTime(o,r)))}return r}function insertByTime(t,e){var r=e.length;if(0!==r){var n=binarySearch(t.time,e);n>=r?e.push(newTimeslot(t.time,[t])):t.time===e[n].time?e[n].events.push(t):e.splice(n,0,newTimeslot(t.time,[t]))}else e.push(newTimeslot(t.time,[t]))}function removeAllFrom(t,e){e.events=removeAll(t,e.events)}function binarySearch(t,e){for(var r,n,i=0,o=e.length;i<o;){if(r=Math.floor((i+o)/2),n=e[r],t===n.time)return r;t<n.time?o=r:i=r+1}return o}function newTimeslot(t,e){return{time:t,events:e}}function subscribe(t,e){if(Object(t)!==t)throw new TypeError("subscriber must be an object");var r=settable(),n=new SubscribeObserver(fatalError,t,r);return r.setDisposable(e.source.run(n,defaultScheduler)),new Subscription(r)}function SubscribeObserver(t,e,r){this.fatalError=t,this.subscriber=e,this.disposable=r}function Subscription(t){this.disposable=t}function doDispose(t,e,r,n,i,o){Promise.resolve(i.dispose()).then(function(){"function"==typeof r&&r.call(e,o)}).catch(function(t){"function"==typeof n&&n.call(e,t)}).catch(t)}function thru(t,e){return t(e)}function withDefaultScheduler(t){return withScheduler(t,defaultScheduler)}function withScheduler(t,e){return new Promise(function(r,n){runSource(t,e,r,n)})}function runSource(t,e,r,n){var i=settable(),o=new Drain(r,n,i);i.setDisposable(t.run(o,e))}function Drain(t,e,r){this._end=t,this._error=e,this._disposable=r,this.active=!0}function disposeThen(t,e,r,n){Promise.resolve(r.dispose()).then(function(){t(n)},e)}function Pipe(t){this.sink=t}function Filter(t,e){this.p=t,this.source=e}function FilterSink(t,e){this.p=t,this.sink=e}function and(t,e){return function(r){return t(r)&&e(r)}}function FilterMap(t,e,r){this.p=t,this.f=e,this.source=r}function FilterMapSink(t,e,r){this.p=t,this.f=e,this.sink=r}function Map(t,e){this.f=t,this.source=e}function MapSink(t,e){this.f=t,this.sink=e}function map$2(t,e){return new Stream(Map.create(t,e.source))}function constant(t,e){return map$2(function(){return t},e)}function tap(t,e){return new Stream(new Tap(t,e.source))}function Tap(t,e){this.source=e,this.f=t}function TapSink(t,e){this.sink=e,this.f=t}function observe(t,e){return drain(tap(t,e))}function drain(t){return withDefaultScheduler(t.source)}function loop(t,e,r){return new Stream(new Loop(t,e,r.source))}function Loop(t,e,r){this.step=t,this.seed=e,this.source=r}function LoopSink(t,e,r){this.step=t,this.seed=e,this.sink=r}function scan(t,e,r){return new Stream(new Scan(t,e,r.source))}function Scan(t,e,r){this.source=r,this.f=t,this.value=e}function ScanSink(t,e,r){this.f=t,this.value=e,this.sink=r}function reduce$1(t,e,r){return withDefaultScheduler(new Reduce(t,e,r.source))}function Reduce(t,e,r){this.source=r,this.f=t,this.value=e}function ReduceSink(t,e,r){this.f=t,this.value=e,this.sink=r}function continueWith(t,e){return new Stream(new ContinueWith(t,e.source))}function ContinueWith(t,e){this.f=t,this.source=e}function ContinueWithSink(t,e,r,n){this.f=t,this.sink=r,this.scheduler=n,this.active=!0,this.disposable=once(e.run(this,n))}function cons$1(t,e){return concat(of(t),e)}function concat(t,e){return continueWith(function(){return e},t)}function IndexSink(t,e){this.sink=e,this.index=t,this.active=!0,this.value=void 0}function invoke(t,e){switch(e.length){case 0:return t();case 1:return t(e[0]);case 2:return t(e[0],e[1]);case 3:return t(e[0],e[1],e[2]);case 4:return t(e[0],e[1],e[2],e[3]);case 5:return t(e[0],e[1],e[2],e[3],e[4]);default:return t.apply(void 0,e)}}function combine(t){return combineArray(t,tail$1(arguments))}function combineArray(t,e){var r=e.length;return 0===r?empty():1===r?map$2(t,e[0]):new Stream(combineSources(t,e))}function combineSources(t,e){return new Combine(t,map$3(getSource,e))}function getSource(t){return t.source}function Combine(t,e){this.f=t,this.sources=e}function CombineSink(t,e,r,n){this.sink=r,this.disposables=t,this.sinks=e,this.f=n;var i=e.length;this.awaiting=i,this.values=new Array(i),this.hasValue=new Array(i);for(var o=0;o<i;++o)this.hasValue[o]=!1;this.activeCount=e.length}function ap(t,e){return combine(apply,t,e)}function transduce(t,e){return new Stream(new Transduce(t,e.source))}function Transduce(t,e){this.transducer=t,this.source=e}function TransduceSink(t,e){this.xf=t,this.sink=e}function Transformer(t){this.time=-1/0,this.sink=t}function getTxHandler(t){return"function"==typeof t["@@transducer/step"]?new TxAdapter(t):new LegacyTxAdapter(t)}function TxAdapter(t){this.tx=t}function LegacyTxAdapter(t){this.tx=t}function LinkedList(){this.head=null,this.length=0}function mergeConcurrently(t,e){return mergeMapConcurrently(id,t,e)}function mergeMapConcurrently(t,e,r){return new Stream(new MergeConcurrently(t,e,r.source))}function MergeConcurrently(t,e,r){this.f=t,this.concurrency=e,this.source=r}function Outer(t,e,r,n,i){this.f=t,this.concurrency=e,this.sink=n,this.scheduler=i,this.pending=[],this.current=new LinkedList,this.disposable=once(r.run(this,i)),this.active=!0}function mapAndRun(t,e,r,n){return t(e).source.run(r,n)}function Inner(t,e,r){this.prev=this.next=null,this.time=t,this.outer=e,this.sink=r,this.disposable=void 0}function flatMap(t,e){return mergeMapConcurrently(t,1/0,e)}function join(t){return mergeConcurrently(1/0,t)}function concatMap(t,e){return mergeMapConcurrently(t,1,e)}function mergeArray(t){var e=t.length;return 0===e?empty():1===e?t[0]:new Stream(mergeSources(t))}function mergeSources(t){return new Merge(reduce$2(appendSources,[],t))}function appendSources(t,e){var r=e.source;return r instanceof Merge?t.concat(r.sources):t.concat(r)}function Merge(t){this.sources=t}function MergeSink(t,e,r){this.sink=r,this.disposables=t,this.activeCount=e.length}function sampleWith(t,e){return new Stream(new Sampler(id,t.source,[e.source]))}function sampleArray(t,e,r){return new Stream(new Sampler(t,e.source,map(getSource$1,r)))}function getSource$1(t){return t.source}function Sampler(t,e,r){this.f=t,this.sampler=e,this.sources=r}function Hold(t){this.sink=t,this.hasValue=!1}function SampleSink(t,e,r){this.f=t,this.sinks=e,this.sink=r,this.active=!1}function hasValue(t){return t.hasValue}function getValue(t){return t.value}function Queue(t){this._capacity=t||32,this._length=0,this._head=0}function copy$2(t,e,r,n,i){for(var o=0;o<i;++o)r[o+n]=t[o+e],t[o+e]=void 0}function zipArray(t,e){return 0===e.length?empty():1===e.length?map$2(t,e[0]):new Stream(new Zip(t,map$4(getSource$2,e)))}function getSource$2(t){return t.source}function Zip(t,e){this.f=t,this.sources=e}function ZipSink(t,e,r,n){this.f=t,this.sinks=r,this.sink=n,this.buffers=e}function emitZipped(t,e,r,n){n.event(e,invoke(t,map$4(head,r)))}function head(t){return t.shift()}function ended(t,e){for(var r=0,n=t.length;r<n;++r)if(t[r].isEmpty()&&!e[r].active)return!0;return!1}function ready(t){for(var e=0,r=t.length;e<r;++e)if(t[e].isEmpty())return!1;return!0}function switchLatest(t){return new Stream(new Switch(t.source))}function Switch(t){this.source=t}function SwitchSink(t,e){this.sink=t,this.scheduler=e,this.current=null,this.ended=!1}function Segment(t,e,r,n){this.min=t,this.max=e,this.outer=r,this.sink=n,this.disposable=empty$1()}function filter(t,e){return new Stream(Filter.create(t,e.source))}function skipRepeats(t){return skipRepeatsWith(same,t)}function skipRepeatsWith(t,e){return new Stream(new SkipRepeats(t,e.source))}function SkipRepeats(t,e){this.equals=t,this.source=e}function SkipRepeatsSink(t,e){this.equals=t,this.sink=e,this.value=void 0,this.init=!0}function same(t,e){return t===e}function take(t,e){return slice(0,t,e)}function skip(t,e){return slice(t,1/0,e)}function slice(t,e,r){return e<=t?empty():new Stream(sliceSource(t,e,r.source))}function sliceSource(t,e,r){return r instanceof Map?commuteMapSlice(t,e,r):r instanceof Slice?fuseSlice(t,e,r):new Slice(t,e,r)}function commuteMapSlice(t,e,r){return Map.create(r.f,sliceSource(t,e,r.source))}function fuseSlice(t,e,r){return t+=r.min,e=Math.min(e+r.min,r.max),new Slice(t,e,r.source)}function Slice(t,e,r){this.source=r,this.min=t,this.max=e}function SliceSink(t,e,r){this.sink=r,this.skip=t,this.take=e}function takeWhile(t,e){return new Stream(new TakeWhile(t,e.source))}function TakeWhile(t,e){this.p=t,this.source=e}function TakeWhileSink(t,e){this.p=t,this.sink=e,this.active=!0}function skipWhile(t,e){return new Stream(new SkipWhile(t,e.source))}function SkipWhile(t,e){this.p=t,this.source=e}function SkipWhileSink(t,e){this.p=t,this.sink=e,this.skipping=!0}function skipAfter(t,e){return new Stream(new SkipAfter(t,e.source))}function SkipAfter(t,e){this.p=t,this.source=e}function SkipAfterSink(t,e){this.p=t,this.sink=e,this.skipping=!1}function takeUntil(t,e){return new Stream(new Until(t.source,e.source))}function skipUntil(t,e){return new Stream(new Since(t.source,e.source))}function during(t,e){return takeUntil(join(t),skipUntil(t,e))}function Until(t,e){this.maxSignal=t,this.source=e}function Since(t,e){this.minSignal=t,this.source=e}function Bound(t,e){this.value=t,this.sink=e}function TimeWindowSink(t,e,r){this.min=t,this.max=e,this.sink=r}function LowerBound(t,e,r){this.value=1/0,this.sink=e,this.disposable=t.run(this,r)}function UpperBound(t,e,r){this.value=1/0,this.sink=e,this.disposable=t.run(this,r)}function noop(){}function delay(t,e){return t<=0?e:new Stream(new Delay(t,e.source))}function Delay(t,e){this.dt=t,this.source=e}function DelaySink(t,e,r){this.dt=t,this.sink=e,this.scheduler=r}function timestamp(t){return new Stream(new Timestamp(t.source))}function Timestamp(t){this.source=t}function TimestampSink(t){this.sink=t}function throttle(t,e){return new Stream(throttleSource(t,e.source))}function throttleSource(t,e){return e instanceof Map?commuteMapThrottle(t,e):e instanceof Throttle?fuseThrottle(t,e):new Throttle(t,e)}function commuteMapThrottle(t,e){return Map.create(e.f,throttleSource(t,e.source))}function fuseThrottle(t,e){return new Throttle(Math.max(t,e.period),e.source)}function Throttle(t,e){this.period=t,this.source=e}function ThrottleSink(t,e){this.time=0,this.period=t,this.sink=e}function debounce(t,e){return new Stream(new Debounce(t,e.source))}function Debounce(t,e){this.dt=t,this.source=e}function DebounceSink(t,e,r,n){this.dt=t,this.sink=r,this.scheduler=n,this.value=void 0,this.timer=null;var i=e.run(this,n);this.disposable=all([this,i])}function fromPromise$1(t){return awaitPromises(of(t))}function awaitPromises(t){return new Stream(new Await(t.source))}function Await(t){this.source=t}function AwaitSink(t,e){this.sink=t,this.scheduler=e,this.queue=Promise.resolve();var r=this;this._eventBound=function(t){r.sink.event(r.scheduler.now(),t)},this._endBound=function(t){r.sink.end(r.scheduler.now(),t)},this._errorBound=function(t){r.sink.error(r.scheduler.now(),t)}}function SafeSink(t){this.sink=t,this.active=!0}function recoverWith(t,e){return new Stream(new RecoverWith(t,e.source))}function throwError(t){return new Stream(new ErrorSource(t))}function ErrorSource(t){this.value=t}function runError(t,e,r){r.error(t,e)}function RecoverWith(t,e){this.f=t,this.source=e}function RecoverWithSink(t,e,r,n){this.f=t,this.sink=new SafeSink(r),this.scheduler=n,this.disposable=e.run(this,n)}function tryEvent$1(t,e,r){try{r.event(t,e)}catch(e){r.error(t,e)}}function tryEnd$1(t,e,r){try{r.end(t,e)}catch(e){r.error(t,e)}}function multicast(t){var e=t.source;return e instanceof MulticastSource?t:new t.constructor(new MulticastSource(e))}function defer$1(t){return Promise.resolve(t).then(runTask$1)}function runTask$1(t){try{return t.run()}catch(e){return t.error(e)}}function create$1(t){return new Stream(new MulticastSource(new Create(t)))}function fetch(t,e,r){t instanceof Request||(t=new Request(t,e));var n=superagent[t.method.toLowerCase()](t.url),i=!0,o=!1,s=void 0;try{for(var u,a=t.headers[Symbol.iterator]();!(i=(u=a.next()).done);i=!0){var c=u.value;n.set(c[0],c[1])}}catch(t){o=!0,s=t}finally{try{!i&&a.return&&a.return()}finally{if(o)throw s}}return fromPromise$1(t.text()).flatMap(function(e){return n.send(e),create$1(function(e,i,o){return n.end(function(r,n){if(r){var s=new Response(r,n);return s.message=s.statusText,o(s)}if(!0===n.noContent)return e(new Response),i();n.url=t.url;var u=new Response(n.text,n);e(u),i()}),function(){n.abort(),r(n)}})})}Object.defineProperty(exports,"__esModule",{value:!0});var classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),inherits=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},possibleConstructorReturn=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},toConsumableArray=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},RxRestProxyHandler=function(){function t(e){classCallCheck(this,t),this.$internal=[],this.$instance=e;do{this.$internal=this.$internal.concat(Object.getOwnPropertyNames(e),Object.getOwnPropertySymbols(e))}while(e=Object.getPrototypeOf(e))}return createClass(t,[{key:"getPrototypeOf",value:function(t){return Object.getPrototypeOf(this.$instance)}},{key:"defineProperty",value:function(t,e,r){return!!~this.$internal.indexOf(e)||(Object.defineProperty(t,e,r),!0)}},{key:"deleteProperty",value:function(t,e){return delete t[e]}},{key:"set",value:function(t,e,r,n){return~this.$internal.indexOf(e)?(this.$instance[e]=r,!0):(!0===this.$instance.$pristine&&(this.$instance.$pristine=!1),t[e]=r,!0)}},{key:"get",value:function(t,e,r){return~this.$internal.indexOf(e)?this.$instance[e]:t[e]}}]),t}(),commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},index=createCommonjsModule(function(t){function e(t){if(t)return r(t)}function r(t){for(var r in e.prototype)t[r]=e.prototype[r];return t}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var n,i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks["$"+t];if(r)for(var n=0,i=(r=r.slice(0)).length;n<i;++n)r[n].apply(this,e);return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}}),isObject_1=isObject,requestBase=RequestBase;RequestBase.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},RequestBase.prototype.parse=function(t){return this._parser=t,this},RequestBase.prototype.responseType=function(t){return this._responseType=t,this},RequestBase.prototype.serialize=function(t){return this._serializer=t,this},RequestBase.prototype.timeout=function(t){if(!t||"object"!=typeof t)return this._timeout=t,this._responseTimeout=0,this;for(var e in t)switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response;break;default:console.warn("Unknown timeout option",e)}return this},RequestBase.prototype.retry=function(t){return 0!==arguments.length&&!0!==t||(t=1),t<=0&&(t=0),this._maxRetries=t,this._retries=0,this},RequestBase.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},RequestBase.prototype.then=function(t,e){if(!this._fullfilledPromise){var r=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(t,e){r.end(function(r,n){r?e(r):t(n)})})}return this._fullfilledPromise.then(t,e)},RequestBase.prototype.catch=function(t){return this.then(void 0,t)},RequestBase.prototype.use=function(t){return t(this),this},RequestBase.prototype.ok=function(t){if("function"!=typeof t)throw Error("Callback required");return this._okCallback=t,this},RequestBase.prototype._isResponseOK=function(t){return!!t&&(this._okCallback?this._okCallback(t):t.status>=200&&t.status<300)},RequestBase.prototype.get=function(t){return this._header[t.toLowerCase()]},RequestBase.prototype.getHeader=RequestBase.prototype.get,RequestBase.prototype.set=function(t,e){if(isObject_1(t)){for(var r in t)this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},RequestBase.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},RequestBase.prototype.field=function(t,e){if(null===t||void 0===t)throw new Error(".field(name, val) name can not be empty");if(this._data&&console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()"),isObject_1(t)){for(var r in t)this.field(r,t[r]);return this}if(Array.isArray(e)){for(var n in e)this.field(t,e[n]);return this}if(null===e||void 0===e)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof e&&(e=""+e),this._getFormData().append(t,e),this},RequestBase.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},RequestBase.prototype.withCredentials=function(t){return void 0==t&&(t=!0),this._withCredentials=t,this},RequestBase.prototype.redirects=function(t){return this._maxRedirects=t,this},RequestBase.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},RequestBase.prototype.send=function(t){var e=isObject_1(t),r=this._header["content-type"];if(this._formData&&console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()"),e&&!this._data)Array.isArray(t)?this._data=[]:this._isHost(t)||(this._data={});else if(t&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(e&&isObject_1(this._data))for(var n in t)this._data[n]=t[n];else"string"==typeof t?(r||this.type("form"),r=this._header["content-type"],this._data="application/x-www-form-urlencoded"==r?this._data?this._data+"&"+t:t:(this._data||"")+t):this._data=t;return!e||this._isHost(t)?this:(r||this.type("json"),this)},RequestBase.prototype.sortQuery=function(t){return this._sort=void 0===t||t,this},RequestBase.prototype._timeoutError=function(t,e,r){if(!this._aborted){var n=new Error(t+e+"ms exceeded");n.timeout=e,n.code="ECONNABORTED",n.errno=r,this.timedout=!0,this.abort(),this.callback(n)}},RequestBase.prototype._setTimeouts=function(){var t=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){t._timeoutError("Timeout of ",t._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")},this._responseTimeout))};var isFunction_1=isFunction,type=function(t){return t.split(/ *; */).shift()},params=function(t){return t.split(/ *; */).reduce(function(t,e){var r=e.split(/ *= */),n=r.shift(),i=r.shift();return n&&i&&(t[n]=i),t},{})},parseLinks=function(t){return t.split(/ *, */).reduce(function(t,e){var r=e.split(/ *; */),n=r[0].slice(1,-1);return t[r[1].split(/ *= */)[1].slice(1,-1)]=n,t},{})},cleanHeader=function(t,e){return delete t["content-type"],delete t["content-length"],delete t["transfer-encoding"],delete t.host,e&&delete t.cookie,t},utils={type:type,params:params,parseLinks:parseLinks,cleanHeader:cleanHeader},responseBase=ResponseBase;ResponseBase.prototype.get=function(t){return this.header[t.toLowerCase()]},ResponseBase.prototype._setHeaderProperties=function(t){var e=t["content-type"]||"";this.type=utils.type(e);var r=utils.params(e);for(var n in r)this[n]=r[n];this.links={};try{t.link&&(this.links=utils.parseLinks(t.link))}catch(t){}},ResponseBase.prototype._setStatusProperties=function(t){var e=t/100|0;this.status=this.statusCode=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.redirect=3==e,this.clientError=4==e,this.serverError=5==e,this.error=(4==e||5==e)&&this.toError(),this.accepted=202==t,this.noContent=204==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.forbidden=403==t,this.notFound=404==t};var ERROR_CODES=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"],shouldRetry=function(t,e){return!!(t&&t.code&&~ERROR_CODES.indexOf(t.code))||(!!(e&&e.status&&e.status>=500)||(!!(t&&"timeout"in t&&"ECONNABORTED"==t.code)||!!(t&&"crossDomain"in t)))},client=createCommonjsModule(function(t,e){function r(){}function n(t){if(!isObject_1(t))return t;var e=[];for(var r in t)i(e,r,t[r]);return e.join("&")}function i(t,e,r){if(null!=r)if(Array.isArray(r))r.forEach(function(r){i(t,e,r)});else if(isObject_1(r))for(var n in r)i(t,e+"["+n+"]",r[n]);else t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));else null===r&&t.push(encodeURIComponent(e))}function o(t){for(var e,r,n={},i=t.split("&"),o=0,s=i.length;o<s;++o)-1==(r=(e=i[o]).indexOf("="))?n[decodeURIComponent(e)]="":n[decodeURIComponent(e.slice(0,r))]=decodeURIComponent(e.slice(r+1));return n}function s(t){var e,r,n,i,o=t.split(/\r?\n/),s={};o.pop();for(var u=0,a=o.length;u<a;++u)e=(r=o[u]).indexOf(":"),n=r.slice(0,e).toLowerCase(),i=f(r.slice(e+1)),s[n]=i;return s}function u(t){return/[\/+]json\b/.test(t)}function a(t){this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var e=this.xhr.status;1223===e&&(e=204),this._setStatusProperties(e),this.header=this.headers=s(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&t._responseType?this.body=this.xhr.response:this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function c(t,e){var r=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var t=null,e=null;try{e=new a(r)}catch(e){return t=new Error("Parser is unable to parse the response"),t.parse=!0,t.original=e,r.xhr?(t.rawResponse=void 0===r.xhr.responseType?r.xhr.responseText:r.xhr.response,t.status=r.xhr.status?r.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),r.callback(t)}r.emit("response",e);var n;try{r._isResponseOK(e)||((n=new Error(e.statusText||"Unsuccessful HTTP response")).original=t,n.response=e,n.status=e.status)}catch(t){n=t}n?r.callback(n,e):r.callback(null,e)})}function h(t,e,r){var n=l("DELETE",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n}var p;"undefined"!=typeof window?p=window:"undefined"!=typeof self?p=self:(console.warn("Using browser-only version of superagent in non-browser environment"),p=commonjsGlobal);var l=e=t.exports=function(t,r){return"function"==typeof r?new e.Request("GET",t).end(r):1==arguments.length?new e.Request("GET",t):new e.Request(t,r)};e.Request=c,l.getXHR=function(){if(!(!p.XMLHttpRequest||p.location&&"file:"==p.location.protocol&&p.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}throw Error("Browser-only verison of superagent could not find XHR")};var f="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};l.serializeObject=n,l.parseString=o,l.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},l.serialize={"application/x-www-form-urlencoded":n,"application/json":JSON.stringify},l.parse={"application/x-www-form-urlencoded":o,"application/json":JSON.parse},responseBase(a.prototype),a.prototype._parseBody=function(t){var e=l.parse[this.type];return this.req._parser?this.req._parser(this,t):(!e&&u(this.type)&&(e=l.parse["application/json"]),e&&t&&(t.length||t instanceof Object)?e(t):null)},a.prototype.toError=function(){var t=this.req,e=t.method,r=t.url,n="cannot "+e+" "+r+" ("+this.status+")",i=new Error(n);return i.status=this.status,i.method=e,i.url=r,i},l.Response=a,index(c.prototype),requestBase(c.prototype),c.prototype.type=function(t){return this.set("Content-Type",l.types[t]||t),this},c.prototype.accept=function(t){return this.set("Accept",l.types[t]||t),this},c.prototype.auth=function(t,e,r){switch("object"==typeof e&&null!==e&&(r=e),r||(r={type:"function"==typeof btoa?"basic":"auto"}),r.type){case"basic":this.set("Authorization","Basic "+btoa(t+":"+e));break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization","Bearer "+t)}return this},c.prototype.query=function(t){return"string"!=typeof t&&(t=n(t)),t&&this._query.push(t),this},c.prototype.attach=function(t,e,r){if(e){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(t,e,r||e.name)}return this},c.prototype._getFormData=function(){return this._formData||(this._formData=new p.FormData),this._formData},c.prototype.callback=function(t,e){if(this._maxRetries&&this._retries++<this._maxRetries&&shouldRetry(t,e))return this._retry();var r=this._callback;this.clearTimeout(),t&&(this._maxRetries&&(t.retries=this._retries-1),this.emit("error",t)),r(t,e)},c.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},c.prototype.buffer=c.prototype.ca=c.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},c.prototype.pipe=c.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},c.prototype._appendQueryString=function(){var t=this._query.join("&");if(t&&(this.url+=(this.url.indexOf("?")>=0?"&":"?")+t),this._sort){var e=this.url.indexOf("?");if(e>=0){var r=this.url.substring(e+1).split("&");isFunction_1(this._sort)?r.sort(this._sort):r.sort(),this.url=this.url.substring(0,e)+"?"+r.join("&")}}},c.prototype._isHost=function(t){return t&&"object"==typeof t&&!Array.isArray(t)&&"[object Object]"!==Object.prototype.toString.call(t)},c.prototype.end=function(t){return this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=t||r,this._appendQueryString(),this._end()},c.prototype._end=function(){var t=this,e=this.xhr=l.getXHR(),r=this._formData||this._data;this._setTimeouts(),e.onreadystatechange=function(){var r=e.readyState;if(r>=2&&t._responseTimeoutTimer&&clearTimeout(t._responseTimeoutTimer),4==r){var n;try{n=e.status}catch(t){n=0}if(!n){if(t.timedout||t._aborted)return;return t.crossDomainError()}t.emit("end")}};var n=function(e,r){r.total>0&&(r.percent=r.loaded/r.total*100),r.direction=e,t.emit("progress",r)};if(this.hasListeners("progress"))try{e.onprogress=n.bind(null,"download"),e.upload&&(e.upload.onprogress=n.bind(null,"upload"))}catch(t){}try{this.username&&this.password?e.open(this.method,this.url,!0,this.username,this.password):e.open(this.method,this.url,!0)}catch(t){return this.callback(t)}if(this._withCredentials&&(e.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof r&&!this._isHost(r)){var i=this._header["content-type"],o=this._serializer||l.serialize[i?i.split(";")[0]:""];!o&&u(i)&&(o=l.serialize["application/json"]),o&&(r=o(r))}for(var s in this.header)null!=this.header[s]&&this.header.hasOwnProperty(s)&&e.setRequestHeader(s,this.header[s]);return this._responseType&&(e.responseType=this._responseType),this.emit("request",this),e.send(void 0!==r?r:null),this},l.get=function(t,e,r){var n=l("GET",t);return"function"==typeof e&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n},l.head=function(t,e,r){var n=l("HEAD",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},l.options=function(t,e,r){var n=l("OPTIONS",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},l.del=h,l.delete=h,l.patch=function(t,e,r){var n=l("PATCH",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},l.post=function(t,e,r){var n=l("POST",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},l.put=function(t,e,r){var n=l("PUT",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n}}),client_1=client.Request,superagent=Object.freeze({default:client,__moduleExports:client,Request:client_1});Stream.prototype.run=function(t,e){return this.source.run(t,e)};var id=function(t){return t},compose=function(t,e){return function(r){return t(e(r))}},apply=function(t,e){return t(e)};Disposable.prototype.dispose=function(){return this._dispose(this._data)},SettableDisposable.prototype.setDisposable=function(t){if(void 0!==this.disposable)throw new Error("setDisposable called more than once");this.disposable=t,this.disposed&&this._resolve(t.dispose())},SettableDisposable.prototype.dispose=function(){return this.disposed?this.result:(this.disposed=!0,void 0!==this.disposable&&(this.result=this.disposable.dispose()),this.result)};var map$1=map,identity=id;PropagateTask.event=function(t,e){return new PropagateTask(emit,t,e)},PropagateTask.end=function(t,e){return new PropagateTask(end,t,e)},PropagateTask.error=function(t,e){return new PropagateTask(error,t,e)},PropagateTask.prototype.dispose=function(){this.active=!1},PropagateTask.prototype.run=function(t){this.active&&this._run(t,this.value,this.sink)},PropagateTask.prototype.error=function(t,e){if(!this.active)return fatalError(e);this.sink.error(t,e)},Just.prototype.run=function(t,e){return e.asap(new PropagateTask(runJust,this.value,t))},EmptySource.prototype.run=function(t,e){var r=PropagateTask.end(void 0,t);return e.asap(r),create(disposeEmpty,r)};var EMPTY=new Stream(new EmptySource);ArraySource.prototype.run=function(t,e){return e.asap(new PropagateTask(runProducer,this.array,t))};var iteratorSymbol;iteratorSymbol="function"==typeof Set&&"function"==typeof(new Set)["@@iterator"]?"@@iterator":"function"==typeof Symbol&&Symbol.iterator||"_es6shim_iterator_",IterableSource.prototype.run=function(t,e){return e.asap(new PropagateTask(runProducer$1,getIterator(this.iterable),t))};var root,result=symbolObservablePonyfill(root="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")());ObservableSource.prototype.run=function(t,e){var r=this.observable.subscribe(new SubscriberSink(t,e));if("function"==typeof r)return create(r);if(r&&"function"==typeof r.unsubscribe)return create(unsubscribe,r);throw new TypeError("Observable returned invalid subscription "+String(r))},SubscriberSink.prototype.next=function(t){tryEvent(this.scheduler.now(),t,this.sink)},SubscriberSink.prototype.complete=function(t){tryEnd(this.scheduler.now(),t,this.sink)},SubscriberSink.prototype.error=function(t){this.sink.error(this.scheduler.now(),t)},ScheduledTask.prototype.run=function(){return this.task.run(this.time)},ScheduledTask.prototype.error=function(t){return this.task.error(this.time,t)},ScheduledTask.prototype.dispose=function(){return this.scheduler.cancel(this),this.task.dispose()},Scheduler.prototype.now=function(){return this.timer.now()},Scheduler.prototype.asap=function(t){return this.schedule(0,-1,t)},Scheduler.prototype.delay=function(t,e){return this.schedule(t,-1,e)},Scheduler.prototype.periodic=function(t,e){return this.schedule(0,t,e)},Scheduler.prototype.schedule=function(t,e,r){var n=this.now(),i=new ScheduledTask(n+Math.max(0,t),e,r,this);return this.timeline.add(i),this._scheduleNextRun(n),i},Scheduler.prototype.cancel=function(t){t.active=!1,this.timeline.remove(t)&&this._reschedule()},Scheduler.prototype.cancelAll=function(t){this.timeline.removeAll(t),this._reschedule()},Scheduler.prototype._reschedule=function(){this.timeline.isEmpty()?this._unschedule():this._scheduleNextRun(this.now())},Scheduler.prototype._unschedule=function(){this.timer.clearTimer(this._timer),this._timer=null},Scheduler.prototype._scheduleNextRun=function(t){if(!this.timeline.isEmpty()){var e=this.timeline.nextArrival();null===this._timer?this._scheduleNextArrival(e,t):e<this._nextArrival&&(this._unschedule(),this._scheduleNextArrival(e,t))}},Scheduler.prototype._scheduleNextArrival=function(t,e){this._nextArrival=t;var r=Math.max(0,t-e);this._timer=this.timer.setTimer(this._runReadyTasksBound,r)},Scheduler.prototype._runReadyTasks=function(t){this._timer=null,this.timeline.runTasks(t,runTask),this._scheduleNextRun(this.now())},ClockTimer.prototype.now=Date.now,ClockTimer.prototype.setTimer=function(t,e){return e<=0?runAsap(t):setTimeout(t,e)},ClockTimer.prototype.clearTimer=function(t){return t instanceof Asap?t.cancel():clearTimeout(t)},Asap.prototype.run=function(){return this.active&&this.f()},Asap.prototype.error=function(t){throw t},Asap.prototype.cancel=function(){this.active=!1},Timeline.prototype.nextArrival=function(){return this.isEmpty()?1/0:this.tasks[0].time},Timeline.prototype.isEmpty=function(){return 0===this.tasks.length},Timeline.prototype.add=function(t){insertByTime(t,this.tasks)},Timeline.prototype.remove=function(t){var e=binarySearch(t.time,this.tasks);if(e>=0&&e<this.tasks.length){var r=findIndex(t,this.tasks[e].events);if(r>=0)return this.tasks[e].events.splice(r,1),!0}return!1},Timeline.prototype.removeAll=function(t){for(var e=0,r=this.tasks.length;e<r;++e)removeAllFrom(t,this.tasks[e])},Timeline.prototype.runTasks=function(t,e){for(var r=this.tasks,n=r.length,i=0;i<n&&r[i].time<=t;)++i;this.tasks=r.slice(i);for(var o=0;o<i;++o)this.tasks=runTasks(e,r[o],this.tasks)};var defaultScheduler=new Scheduler(new ClockTimer,new Timeline);SubscribeObserver.prototype.event=function(t,e){this.disposable.disposed||"function"!=typeof this.subscriber.next||this.subscriber.next(e)},SubscribeObserver.prototype.end=function(t,e){if(!this.disposable.disposed){var r=this.subscriber;doDispose(this.fatalError,r,r.complete,r.error,this.disposable,e)}},SubscribeObserver.prototype.error=function(t,e){var r=this.subscriber;doDispose(this.fatalError,r,r.error,r.error,this.disposable,e)},Subscription.prototype.unsubscribe=function(){this.disposable.dispose()},Drain.prototype.event=function(t,e){},Drain.prototype.end=function(t,e){this.active&&(this.active=!1,disposeThen(this._end,this._error,this._disposable,e))},Drain.prototype.error=function(t,e){this.active=!1,disposeThen(this._error,this._error,this._disposable,e)},Pipe.prototype.event=function(t,e){return this.sink.event(t,e)},Pipe.prototype.end=function(t,e){return this.sink.end(t,e)},Pipe.prototype.error=function(t,e){return this.sink.error(t,e)},Filter.create=function(t,e){return e instanceof Filter?new Filter(and(e.p,t),e.source):new Filter(t,e)},Filter.prototype.run=function(t,e){return this.source.run(new FilterSink(this.p,t),e)},FilterSink.prototype.end=Pipe.prototype.end,FilterSink.prototype.error=Pipe.prototype.error,FilterSink.prototype.event=function(t,e){(0,this.p)(e)&&this.sink.event(t,e)},FilterMap.prototype.run=function(t,e){return this.source.run(new FilterMapSink(this.p,this.f,t),e)},FilterMapSink.prototype.event=function(t,e){var r=this.f;(0,this.p)(e)&&this.sink.event(t,r(e))},FilterMapSink.prototype.end=Pipe.prototype.end,FilterMapSink.prototype.error=Pipe.prototype.error,Map.create=function(t,e){return e instanceof Map?new Map(compose(t,e.f),e.source):e instanceof Filter?new FilterMap(e.p,t,e.source):new Map(t,e)},Map.prototype.run=function(t,e){return this.source.run(new MapSink(this.f,t),e)},MapSink.prototype.end=Pipe.prototype.end,MapSink.prototype.error=Pipe.prototype.error,MapSink.prototype.event=function(t,e){var r=this.f;this.sink.event(t,r(e))},Tap.prototype.run=function(t,e){return this.source.run(new TapSink(this.f,t),e)},TapSink.prototype.end=Pipe.prototype.end,TapSink.prototype.error=Pipe.prototype.error,TapSink.prototype.event=function(t,e){(0,this.f)(e),this.sink.event(t,e)},Loop.prototype.run=function(t,e){return this.source.run(new LoopSink(this.step,this.seed,t),e)},LoopSink.prototype.error=Pipe.prototype.error,LoopSink.prototype.event=function(t,e){var r=this.step(this.seed,e);this.seed=r.seed,this.sink.event(t,r.value)},LoopSink.prototype.end=function(t){this.sink.end(t,this.seed)},Scan.prototype.run=function(t,e){return all([e.asap(PropagateTask.event(this.value,t)),this.source.run(new ScanSink(this.f,this.value,t),e)])},ScanSink.prototype.event=function(t,e){var r=this.f;this.value=r(this.value,e),this.sink.event(t,this.value)},ScanSink.prototype.error=Pipe.prototype.error,ScanSink.prototype.end=Pipe.prototype.end,Reduce.prototype.run=function(t,e){return this.source.run(new ReduceSink(this.f,this.value,t),e)},ReduceSink.prototype.event=function(t,e){var r=this.f;this.value=r(this.value,e),this.sink.event(t,this.value)},ReduceSink.prototype.error=Pipe.prototype.error,ReduceSink.prototype.end=function(t){this.sink.end(t,this.value)},ContinueWith.prototype.run=function(t,e){return new ContinueWithSink(this.f,this.source,t,e)},ContinueWithSink.prototype.error=Pipe.prototype.error,ContinueWithSink.prototype.event=function(t,e){this.active&&this.sink.event(t,e)},ContinueWithSink.prototype.end=function(t,e){this.active&&(tryDispose(t,this.disposable,this.sink),this._startNext(t,e,this.sink))},ContinueWithSink.prototype._startNext=function(t,e,r){try{this.disposable=this._continue(this.f,e,r)}catch(e){r.error(t,e)}},ContinueWithSink.prototype._continue=function(t,e,r){return t(e).source.run(r,this.scheduler)},ContinueWithSink.prototype.dispose=function(){return this.active=!1,this.disposable.dispose()},IndexSink.prototype.event=function(t,e){this.active&&(this.value=e,this.sink.event(t,this))},IndexSink.prototype.end=function(t,e){this.active&&(this.active=!1,this.sink.end(t,{index:this.index,value:e}))},IndexSink.prototype.error=Pipe.prototype.error;var map$3=map,tail$1=tail;Combine.prototype.run=function(t,e){for(var r,n=this.sources.length,i=new Array(n),o=new Array(n),s=new CombineSink(i,o,t,this.f),u=0;u<n;++u)r=o[u]=new IndexSink(u,s),i[u]=this.sources[u].run(r,e);return all(i)},CombineSink.prototype.error=Pipe.prototype.error,CombineSink.prototype.event=function(t,e){var r=e.index,n=this._updateReady(r);this.values[r]=e.value,0===n&&this.sink.event(t,invoke(this.f,this.values))},CombineSink.prototype._updateReady=function(t){return this.awaiting>0&&(this.hasValue[t]||(this.hasValue[t]=!0,this.awaiting-=1)),this.awaiting},CombineSink.prototype.end=function(t,e){tryDispose(t,this.disposables[e.index],this.sink),0==--this.activeCount&&this.sink.end(t,e.value)},Transduce.prototype.run=function(t,e){var r=this.transducer(new Transformer(t));return this.source.run(new TransduceSink(getTxHandler(r),t),e)},TransduceSink.prototype.event=function(t,e){var r=this.xf.step(t,e);return this.xf.isReduced(r)?this.sink.end(t,this.xf.getResult(r)):r},TransduceSink.prototype.end=function(t,e){return this.xf.result(e)},TransduceSink.prototype.error=function(t,e){return this.sink.error(t,e)},Transformer.prototype["@@transducer/init"]=Transformer.prototype.init=function(){},Transformer.prototype["@@transducer/step"]=Transformer.prototype.step=function(t,e){return isNaN(t)||(this.time=Math.max(t,this.time)),this.sink.event(this.time,e)},Transformer.prototype["@@transducer/result"]=Transformer.prototype.result=function(t){return this.sink.end(this.time,t)},TxAdapter.prototype.step=function(t,e){return this.tx["@@transducer/step"](t,e)},TxAdapter.prototype.result=function(t){return this.tx["@@transducer/result"](t)},TxAdapter.prototype.isReduced=function(t){return null!=t&&t["@@transducer/reduced"]},TxAdapter.prototype.getResult=function(t){return t["@@transducer/value"]},LegacyTxAdapter.prototype.step=function(t,e){return this.tx.step(t,e)},LegacyTxAdapter.prototype.result=function(t){return this.tx.result(t)},LegacyTxAdapter.prototype.isReduced=function(t){return null!=t&&t.__transducers_reduced__},LegacyTxAdapter.prototype.getResult=function(t){return t.value},LinkedList.prototype.add=function(t){null!==this.head&&(this.head.prev=t,t.next=this.head),this.head=t,++this.length},LinkedList.prototype.remove=function(t){--this.length,t===this.head&&(this.head=this.head.next),null!==t.next&&(t.next.prev=t.prev,t.next=null),null!==t.prev&&(t.prev.next=t.next,t.prev=null)},LinkedList.prototype.isEmpty=function(){return 0===this.length},LinkedList.prototype.dispose=function(){if(this.isEmpty())return Promise.resolve();var t=[],e=this.head;for(this.head=null,this.length=0;null!==e;)t.push(e.dispose()),e=e.next;return Promise.all(t)},MergeConcurrently.prototype.run=function(t,e){return new Outer(this.f,this.concurrency,this.source,t,e)},Outer.prototype.event=function(t,e){this._addInner(t,e)},Outer.prototype._addInner=function(t,e){this.current.length<this.concurrency?this._startInner(t,e):this.pending.push(e)},Outer.prototype._startInner=function(t,e){try{this._initInner(t,e)}catch(e){this.error(t,e)}},Outer.prototype._initInner=function(t,e){var r=new Inner(t,this,this.sink);r.disposable=mapAndRun(this.f,e,r,this.scheduler),this.current.add(r)},Outer.prototype.end=function(t,e){this.active=!1,tryDispose(t,this.disposable,this.sink),this._checkEnd(t,e)},Outer.prototype.error=function(t,e){this.active=!1,this.sink.error(t,e)},Outer.prototype.dispose=function(){return this.active=!1,this.pending.length=0,Promise.all([this.disposable.dispose(),this.current.dispose()])},Outer.prototype._endInner=function(t,e,r){this.current.remove(r),tryDispose(t,r,this),0===this.pending.length?this._checkEnd(t,e):this._startInner(t,this.pending.shift())},Outer.prototype._checkEnd=function(t,e){!this.active&&this.current.isEmpty()&&this.sink.end(t,e)},Inner.prototype.event=function(t,e){this.sink.event(Math.max(t,this.time),e)},Inner.prototype.end=function(t,e){this.outer._endInner(Math.max(t,this.time),e,this)},Inner.prototype.error=function(t,e){this.outer.error(Math.max(t,this.time),e)},Inner.prototype.dispose=function(){return this.disposable.dispose()};var reduce$2=reduce;Merge.prototype.run=function(t,e){for(var r,n=this.sources.length,i=new Array(n),o=new Array(n),s=new MergeSink(i,o,t),u=0;u<n;++u)r=o[u]=new IndexSink(u,s),i[u]=this.sources[u].run(r,e);return all(i)},MergeSink.prototype.error=Pipe.prototype.error,MergeSink.prototype.event=function(t,e){this.sink.event(t,e.value)},MergeSink.prototype.end=function(t,e){tryDispose(t,this.disposables[e.index],this.sink),0==--this.activeCount&&this.sink.end(t,e.value)},Sampler.prototype.run=function(t,e){for(var r,n=this.sources.length,i=new Array(n+1),o=new Array(n),s=new SampleSink(this.f,o,t),u=0;u<n;++u)r=o[u]=new Hold(s),i[u]=this.sources[u].run(r,e);return i[u]=this.sampler.run(s,e),all(i)},Hold.prototype.event=function(t,e){this.value=e,this.hasValue=!0,this.sink._notify(this)},Hold.prototype.end=function(){},Hold.prototype.error=Pipe.prototype.error,SampleSink.prototype._notify=function(){this.active||(this.active=this.sinks.every(hasValue))},SampleSink.prototype.event=function(t){this.active&&this.sink.event(t,invoke(this.f,map(getValue,this.sinks)))},SampleSink.prototype.end=Pipe.prototype.end,SampleSink.prototype.error=Pipe.prototype.error,Queue.prototype.push=function(t){var e=this._length;this._checkCapacity(e+1),this[this._head+e&this._capacity-1]=t,this._length=e+1},Queue.prototype.shift=function(){var t=this._head,e=this[t];return this[t]=void 0,this._head=t+1&this._capacity-1,this._length--,e},Queue.prototype.isEmpty=function(){return 0===this._length},Queue.prototype.length=function(){return this._length},Queue.prototype._checkCapacity=function(t){this._capacity<t&&this._ensureCapacity(this._capacity<<1)},Queue.prototype._ensureCapacity=function(t){var e=this._capacity;this._capacity=t;var r=this._head+this._length;r>e&&copy$2(this,0,this,e,r&e-1)};var map$4=map;Zip.prototype.run=function(t,e){for(var r,n=this.sources.length,i=new Array(n),o=new Array(n),s=new Array(n),u=new ZipSink(this.f,s,o,t),a=0;a<n;++a)s[a]=new Queue,r=o[a]=new IndexSink(a,u),i[a]=this.sources[a].run(r,e);return all(i)},ZipSink.prototype.event=function(t,e){var r=this.buffers,n=r[e.index];if(n.push(e.value),1===n.length()){if(!ready(this.buffers))return;emitZipped(this.f,t,r,this.sink),ended(this.buffers,this.sinks)&&this.sink.end(t,void 0)}},ZipSink.prototype.end=function(t,e){this.buffers[e.index].isEmpty()&&this.sink.end(t,e.value)},ZipSink.prototype.error=Pipe.prototype.error,Switch.prototype.run=function(t,e){var r=new SwitchSink(t,e);return all([r,this.source.run(r,e)])},SwitchSink.prototype.event=function(t,e){this._disposeCurrent(t),this.current=new Segment(t,1/0,this,this.sink),this.current.disposable=e.source.run(this.current,this.scheduler)},SwitchSink.prototype.end=function(t,e){this.ended=!0,this._checkEnd(t,e)},SwitchSink.prototype.error=function(t,e){this.ended=!0,this.sink.error(t,e)},SwitchSink.prototype.dispose=function(){return this._disposeCurrent(this.scheduler.now())},SwitchSink.prototype._disposeCurrent=function(t){if(null!==this.current)return this.current._dispose(t)},SwitchSink.prototype._disposeInner=function(t,e){e._dispose(t),e===this.current&&(this.current=null)},SwitchSink.prototype._checkEnd=function(t,e){this.ended&&null===this.current&&this.sink.end(t,e)},SwitchSink.prototype._endInner=function(t,e,r){this._disposeInner(t,r),this._checkEnd(t,e)},SwitchSink.prototype._errorInner=function(t,e,r){this._disposeInner(t,r),this.sink.error(t,e)},Segment.prototype.event=function(t,e){t<this.max&&this.sink.event(Math.max(t,this.min),e)},Segment.prototype.end=function(t,e){this.outer._endInner(Math.max(t,this.min),e,this)},Segment.prototype.error=function(t,e){this.outer._errorInner(Math.max(t,this.min),e,this)},Segment.prototype._dispose=function(t){this.max=t,tryDispose(t,this.disposable,this.sink)},SkipRepeats.prototype.run=function(t,e){return this.source.run(new SkipRepeatsSink(this.equals,t),e)},SkipRepeatsSink.prototype.end=Pipe.prototype.end,SkipRepeatsSink.prototype.error=Pipe.prototype.error,SkipRepeatsSink.prototype.event=function(t,e){this.init?(this.init=!1,this.value=e,this.sink.event(t,e)):this.equals(this.value,e)||(this.value=e,this.sink.event(t,e))},Slice.prototype.run=function(t,e){return this.source.run(new SliceSink(this.min,this.max-this.min,t),e)},SliceSink.prototype.end=Pipe.prototype.end,SliceSink.prototype.error=Pipe.prototype.error,SliceSink.prototype.event=function(t,e){this.skip>0?this.skip-=1:0!==this.take&&(this.take-=1,this.sink.event(t,e),0===this.take&&this.sink.end(t,e))},TakeWhile.prototype.run=function(t,e){return this.source.run(new TakeWhileSink(this.p,t),e)},TakeWhileSink.prototype.end=Pipe.prototype.end,TakeWhileSink.prototype.error=Pipe.prototype.error,TakeWhileSink.prototype.event=function(t,e){if(this.active){var r=this.p;this.active=r(e),this.active?this.sink.event(t,e):this.sink.end(t,e)}},SkipWhile.prototype.run=function(t,e){return this.source.run(new SkipWhileSink(this.p,t),e)},SkipWhileSink.prototype.end=Pipe.prototype.end,SkipWhileSink.prototype.error=Pipe.prototype.error,SkipWhileSink.prototype.event=function(t,e){if(this.skipping){var r=this.p;if(this.skipping=r(e),this.skipping)return}this.sink.event(t,e)},SkipAfter.prototype.run=function(t,e){return this.source.run(new SkipAfterSink(this.p,t),e)},SkipAfterSink.prototype.event=function(t,e){if(!this.skipping){var r=this.p;this.skipping=r(e),this.sink.event(t,e),this.skipping&&this.sink.end(t,e)}},SkipAfterSink.prototype.end=Pipe.prototype.end,SkipAfterSink.prototype.error=Pipe.prototype.error,Until.prototype.run=function(t,e){var r=new Bound(-1/0,t),n=new UpperBound(this.maxSignal,t,e);return all([r,n,this.source.run(new TimeWindowSink(r,n,t),e)])},Since.prototype.run=function(t,e){var r=new LowerBound(this.minSignal,t,e),n=new Bound(1/0,t);return all([r,n,this.source.run(new TimeWindowSink(r,n,t),e)])},Bound.prototype.error=Pipe.prototype.error,Bound.prototype.event=noop,Bound.prototype.end=noop,Bound.prototype.dispose=noop,TimeWindowSink.prototype.event=function(t,e){t>=this.min.value&&t<this.max.value&&this.sink.event(t,e)},TimeWindowSink.prototype.error=Pipe.prototype.error,TimeWindowSink.prototype.end=Pipe.prototype.end,LowerBound.prototype.event=function(t){t<this.value&&(this.value=t)},LowerBound.prototype.end=noop,LowerBound.prototype.error=Pipe.prototype.error,LowerBound.prototype.dispose=function(){return this.disposable.dispose()},UpperBound.prototype.event=function(t,e){t<this.value&&(this.value=t,this.sink.end(t,e))},UpperBound.prototype.end=noop,UpperBound.prototype.error=Pipe.prototype.error,UpperBound.prototype.dispose=function(){return this.disposable.dispose()},Delay.prototype.run=function(t,e){var r=new DelaySink(this.dt,t,e);return all([r,this.source.run(r,e)])},DelaySink.prototype.dispose=function(){var t=this;this.scheduler.cancelAll(function(e){return e.sink===t.sink})},DelaySink.prototype.event=function(t,e){this.scheduler.delay(this.dt,PropagateTask.event(e,this.sink))},DelaySink.prototype.end=function(t,e){this.scheduler.delay(this.dt,PropagateTask.end(e,this.sink))},DelaySink.prototype.error=Pipe.prototype.error,Timestamp.prototype.run=function(t,e){return this.source.run(new TimestampSink(t),e)},TimestampSink.prototype.end=Pipe.prototype.end,TimestampSink.prototype.error=Pipe.prototype.error,TimestampSink.prototype.event=function(t,e){this.sink.event(t,{time:t,value:e})},Throttle.prototype.run=function(t,e){return this.source.run(new ThrottleSink(this.period,t),e)},ThrottleSink.prototype.event=function(t,e){t>=this.time&&(this.time=t+this.period,this.sink.event(t,e))},ThrottleSink.prototype.end=Pipe.prototype.end,ThrottleSink.prototype.error=Pipe.prototype.error,Debounce.prototype.run=function(t,e){return new DebounceSink(this.dt,this.source,t,e)},DebounceSink.prototype.event=function(t,e){this._clearTimer(),this.value=e,this.timer=this.scheduler.delay(this.dt,PropagateTask.event(e,this.sink))},DebounceSink.prototype.end=function(t,e){this._clearTimer()&&(this.sink.event(t,this.value),this.value=void 0),this.sink.end(t,e)},DebounceSink.prototype.error=function(t,e){this._clearTimer(),this.sink.error(t,e)},DebounceSink.prototype.dispose=function(){this._clearTimer()},DebounceSink.prototype._clearTimer=function(){return null!==this.timer&&(this.timer.dispose(),this.timer=null,!0)},Await.prototype.run=function(t,e){return this.source.run(new AwaitSink(t,e),e)},AwaitSink.prototype.event=function(t,e){var r=this;this.queue=this.queue.then(function(){return r._event(e)}).catch(this._errorBound)},AwaitSink.prototype.end=function(t,e){var r=this;this.queue=this.queue.then(function(){return r._end(e)}).catch(this._errorBound)},AwaitSink.prototype.error=function(t,e){var r=this;this.queue=this.queue.then(function(){return r._errorBound(e)}).catch(fatalError)},AwaitSink.prototype._event=function(t){return t.then(this._eventBound)},AwaitSink.prototype._end=function(t){return Promise.resolve(t).then(this._endBound)},SafeSink.prototype.event=function(t,e){this.active&&this.sink.event(t,e)},SafeSink.prototype.end=function(t,e){this.active&&(this.disable(),this.sink.end(t,e))},SafeSink.prototype.error=function(t,e){this.disable(),this.sink.error(t,e)},SafeSink.prototype.disable=function(){return this.active=!1,this.sink};var flatMapError=recoverWith;ErrorSource.prototype.run=function(t,e){return e.asap(new PropagateTask(runError,this.value,t))},RecoverWith.prototype.run=function(t,e){return new RecoverWithSink(this.f,this.source,t,e)},RecoverWithSink.prototype.event=function(t,e){tryEvent(t,e,this.sink)},RecoverWithSink.prototype.end=function(t,e){tryEnd(t,e,this.sink)},RecoverWithSink.prototype.error=function(t,e){var r=this.sink.disable();tryDispose(t,this.disposable,this.sink),this._startNext(t,e,r)},RecoverWithSink.prototype._startNext=function(t,e,r){try{this.disposable=this._continue(this.f,e,r)}catch(e){r.error(t,e)}},RecoverWithSink.prototype._continue=function(t,e,r){return t(e).source.run(r,this.scheduler)},RecoverWithSink.prototype.dispose=function(){return this.disposable.dispose()};var MulticastDisposable=function(t,e){this.source=t,this.sink=e,this.disposed=!1};MulticastDisposable.prototype.dispose=function(){if(!this.disposed)return this.disposed=!0,0===this.source.remove(this.sink)&&this.source._dispose()};var dispose=function(t){return t.dispose()},emptyDisposable={dispose:function(){}},MulticastSource=function(t){this.source=t,this.sinks=[],this._disposable=emptyDisposable};MulticastSource.prototype.run=function(t,e){return 1===this.add(t)&&(this._disposable=this.source.run(this,e)),new MulticastDisposable(this,t)},MulticastSource.prototype._dispose=function(){var t=this._disposable;return this._disposable=emptyDisposable,Promise.resolve(t).then(dispose)},MulticastSource.prototype.add=function(t){return this.sinks=append(t,this.sinks),this.sinks.length},MulticastSource.prototype.remove=function(t){var e=findIndex(t,this.sinks);return e>=0&&(this.sinks=remove(e,this.sinks)),this.sinks.length},MulticastSource.prototype.event=function(t,e){var r=this.sinks;if(1===r.length)return r[0].event(t,e);for(var n=0;n<r.length;++n)tryEvent$1(t,e,r[n])},MulticastSource.prototype.end=function(t,e){for(var r=this.sinks,n=0;n<r.length;++n)tryEnd$1(t,e,r[n])},MulticastSource.prototype.error=function(t,e){for(var r=this.sinks,n=0;n<r.length;++n)r[n].error(t,e)},Stream.of=of,Stream.empty=empty,Stream.from=from,Stream.prototype.subscribe=function(t){return subscribe(t,this)},Stream.prototype[result]=function(){return this},Stream.prototype.thru=function(t){return thru(t,this)},Stream.prototype.observe=Stream.prototype.forEach=function(t){return observe(t,this)},Stream.prototype.drain=function(){return drain(this)},Stream.prototype.loop=function(t,e){return loop(t,e,this)},Stream.prototype.scan=function(t,e){return scan(t,e,this)},Stream.prototype.reduce=function(t,e){return reduce$1(t,e,this)},Stream.prototype.concat=function(t){return concat(this,t)},Stream.prototype.startWith=function(t){return cons$1(t,this)},Stream.prototype.map=function(t){return map$2(t,this)},Stream.prototype.ap=function(t){return ap(this,t)},Stream.prototype.constant=function(t){return constant(t,this)},Stream.prototype.tap=function(t){return tap(t,this)},Stream.prototype.transduce=function(t){return transduce(t,this)},Stream.prototype.chain=function(t){return flatMap(t,this)},Stream.prototype.flatMap=Stream.prototype.chain,Stream.prototype.join=function(){return join(this)},Stream.prototype.continueWith=function(t){return continueWith(t,this)},Stream.prototype.flatMapEnd=Stream.prototype.continueWith,Stream.prototype.concatMap=function(t){return concatMap(t,this)},Stream.prototype.mergeConcurrently=function(t){return mergeConcurrently(t,this)},Stream.prototype.merge=function(){return mergeArray(cons(this,arguments))},Stream.prototype.combine=function(t){return combineArray(t,replace(this,0,arguments))},Stream.prototype.sampleWith=function(t){return sampleWith(t,this)},Stream.prototype.sample=function(t){return sampleArray(t,this,tail(arguments))},Stream.prototype.zip=function(t){return zipArray(t,replace(this,0,arguments))},Stream.prototype.switchLatest=function(){return switchLatest(this)},Stream.prototype.switch=Stream.prototype.switchLatest,Stream.prototype.filter=function(t){return filter(t,this)},Stream.prototype.skipRepeats=function(){return skipRepeats(this)},Stream.prototype.skipRepeatsWith=function(t){return skipRepeatsWith(t,this)},Stream.prototype.take=function(t){return take(t,this)},Stream.prototype.skip=function(t){return skip(t,this)},Stream.prototype.slice=function(t,e){return slice(t,e,this)},Stream.prototype.takeWhile=function(t){return takeWhile(t,this)},Stream.prototype.skipWhile=function(t){return skipWhile(t,this)},Stream.prototype.skipAfter=function(t){return skipAfter(t,this)},Stream.prototype.until=function(t){return takeUntil(t,this)},Stream.prototype.takeUntil=Stream.prototype.until,Stream.prototype.since=function(t){return skipUntil(t,this)},Stream.prototype.skipUntil=Stream.prototype.since,Stream.prototype.during=function(t){return during(t,this)},Stream.prototype.delay=function(t){return delay(t,this)},Stream.prototype.timestamp=function(){return timestamp(this)},Stream.prototype.throttle=function(t){return throttle(t,this)},Stream.prototype.debounce=function(t){return debounce(t,this)},Stream.prototype.awaitPromises=function(){return awaitPromises(this)},Stream.prototype.await=Stream.prototype.awaitPromises,Stream.prototype.recoverWith=function(t){return flatMapError(t,this)},Stream.prototype.flatMapError=Stream.prototype.recoverWith,Stream.prototype.multicast=function(){return multicast(this)};var PropagateAllTask$1=function(t,e,r){this.sink=t,this.time=e,this.events=r};PropagateAllTask$1.prototype.run=function(){for(var t,e=this,r=this.events,n=this.sink,i=0,o=r.length;i<o;++i)t=r[i],e.time=t.time,n.event(t.time,t.value);r.length=0},PropagateAllTask$1.prototype.error=function(t){this.sink.error(this.time,t)};var EndTask$1=function(t,e,r){this.time=t,this.value=e,this.sink=r};EndTask$1.prototype.run=function(){this.sink.end(this.time,this.value)},EndTask$1.prototype.error=function(t){this.sink.error(this.time,t)};var ErrorTask$1=function(t,e,r){this.time=t,this.value=e,this.sink=r};ErrorTask$1.prototype.run=function(){this.sink.error(this.time,this.value)},ErrorTask$1.prototype.error=function(t){throw t};var DeferredSink$1=function(t){this.sink=t,this.events=[],this.active=!0};DeferredSink$1.prototype.event=function(t,e){this.active&&(0===this.events.length&&defer$1(new PropagateAllTask$1(this.sink,t,this.events)),this.events.push({time:t,value:e}))},DeferredSink$1.prototype.end=function(t,e){this.active&&this._end(new EndTask$1(t,e,this.sink))},DeferredSink$1.prototype.error=function(t,e){this._end(new ErrorTask$1(t,e,this.sink))},DeferredSink$1.prototype._end=function(t){this.active=!1,defer$1(t)};var CreateSubscriber=function(t,e,r){this.sink=t,this.scheduler=e,this._unsubscribe=this._init(r)};CreateSubscriber.prototype._init=function(t){var e=this,r=function(t){return e.sink.error(e.scheduler.now(),t)};try{return t(function(t){return e.sink.event(e.scheduler.now(),t)},function(t){return e.sink.end(e.scheduler.now(),t)},r)}catch(t){r(t)}},CreateSubscriber.prototype.dispose=function(){if("function"==typeof this._unsubscribe)return this._unsubscribe.call(void 0)};var Create=function(t){this._subscribe=t};Create.prototype.run=function(t,e){return new CreateSubscriber(new DeferredSink$1(t),e,this._subscribe)};var RxRestConfiguration$$1=function(){function t(){classCallCheck(this,t),this.$headers=new Headers,this.$queryParams=new URLSearchParams,this.identifier="id",this.requestInterceptors=[],this.responseInterceptors=[],this.errorInterceptors=[],this.abortCallback=function(){return null},this.fetch=fetch}return createClass(t,[{key:"_requestBodyHandler",value:function(t){if(t)return t instanceof FormData||t instanceof URLSearchParams?t:t instanceof RxRestItem?t.json():JSON.stringify(t)}},{key:"_responseBodyHandler",value:function(t){return t.text().then(function(t){return{body:t?JSON.parse(t):null,metadata:null}})}},{key:"responseBodyHandler",get:function(){return this._responseBodyHandler},set:function(t){this._responseBodyHandler=t}},{key:"requestBodyHandler",get:function(){return this._requestBodyHandler},set:function(t){this._requestBodyHandler=t}},{key:"baseURL",set:function(t){"/"!==t.charAt(t.length-1)&&(t+="/"),this.$baseURL=t},get:function(){return this.$baseURL}},{key:"queryParams",set:function(t){t instanceof URLSearchParams?this.$queryParams=t:this.$queryParams="string"!=typeof t?objectToMap(new URLSearchParams,t):new URLSearchParams(t)},get:function(){return this.$queryParams}},{key:"headers",set:function(t){t instanceof Headers?this.$headers=t:this.$headers=objectToMap(new Headers,t)},get:function(){return this.$headers}}]),t}(),fromPromise=function(t){return create$1(function(e,r,n){t.then(function(t){e(t),r()}).catch(n)})},RxRest$1=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new RxRestConfiguration$$1,r=arguments[1],n=arguments[2];classCallCheck(this,t),this.$fromServer=!1,this.$asIterable=!1,this.$queryParams=new URLSearchParams,this.$headers=new Headers,this.$pristine=!0,this.$route=void 0===r?[]:[].concat(toConsumableArray(r)),this.config=e,this.$metadata=n}return createClass(t,[{key:"addRoute",value:function(t){this.$route.push.apply(this.$route,t.split("/"))}},{key:"one",value:function(t,e){this.addRoute(t);var r={};return e&&(r[this.config.identifier]=e),new RxRestItem(this.$route,r,this.config)}},{key:"all",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.addRoute(t),new RxRestCollection(this.$route,void 0,this.config,null,e)}},{key:"asIterable",value:function(){return this.$asIterable=!0,this}},{key:"fromObject",value:function(t,e){return this.addRoute(t),Array.isArray(e)?new RxRestCollection(this.$route,e,this.config):new RxRestItem(this.$route,e,this.config)}},{key:"withBody",value:function(t){return t||this}},{key:"post",value:function(t,e,r){return this.queryParams=e,this.headers=r,this.request("POST",this.withBody(t))}},{key:"remove",value:function(t,e){return this.queryParams=t,this.headers=e,this.request("DELETE")}},{key:"get",value:function(t,e){return this.queryParams=t,this.headers=e,this.request("GET")}},{key:"put",value:function(t,e,r){return this.queryParams=e,this.headers=r,this.request("PUT",this.withBody(t))}},{key:"patch",value:function(t,e,r){return this.queryParams=e,this.headers=r,this.request("PATCH",this.withBody(t))}},{key:"head",value:function(t,e){return this.queryParams=t,this.headers=e,this.request("HEAD")}},{key:"trace",value:function(t,e){return this.queryParams=t,this.headers=e,this.request("TRACE")}},{key:"options",value:function(t,e){return this.queryParams=t,this.headers=e,this.request("OPTIONS")}},{key:"setQueryParams",value:function(t){return this.queryParams=t,this}},{key:"setHeaders",value:function(t){return this.headers=t,this}},{key:"expandInterceptors",value:function(t){return function(e){return t.reduce(function(t,e){return t.concatMap(function(t){var r=e(t);return void 0===r?of(t):r instanceof Promise?fromPromise(r):r instanceof Stream?r:of(r)})},of(e))}}},{key:"request",value:function(t,e){var r=this,n={method:t,headers:this.requestHeaders,body:this.config.requestBodyHandler(e)},i=new Request(this.URL+this.requestQueryParams,n);return of(i).flatMap(this.expandInterceptors(this.config.requestInterceptors)).flatMap(function(t){return r.config.fetch(t,null,r.config.abortCallback)}).flatMap(this.expandInterceptors(this.config.responseInterceptors)).flatMap(function(t){return fromPromise(r.config.responseBodyHandler(t))}).flatMap(function(t){var e=t.body,n=t.metadata;if(!Array.isArray(e)){var i=void 0;return r instanceof RxRestItem?((i=r).element=e,i.$metadata=n):i=new RxRestItem(r.$route,e,r.config,n),i.$fromServer=!0,i.$pristine=!0,create$1(function(t,e,r){t(i),e(i)})}var o=new RxRestCollection(r.$route,e.map(function(t){var e=new RxRestItem(r.$route,t,r.config,n);return e.$fromServer=!0,e.$pristine=!0,e}),r.config,n);return o.$pristine=!0,create$1(function(t,e,n){if(r.$asIterable)t(o);else{var i=!0,s=!1,u=void 0;try{for(var a,c=o[Symbol.iterator]();!(i=(a=c.next()).done);i=!0)t(a.value)}catch(t){s=!0,u=t}finally{try{!i&&c.return&&c.return()}finally{if(s)throw u}}}e(o)})}).recoverWith(function(t){return of(t).flatMap(r.expandInterceptors(r.config.errorInterceptors)).flatMap(function(t){return throwError(t)})})}},{key:"URL",get:function(){return""+this.config.baseURL+this.$route.join("/")}},{key:"queryParams",set:function(t){t&&(t instanceof URLSearchParams?this.$queryParams=t:this.$queryParams=objectToMap(new URLSearchParams,t))},get:function(){return this.$queryParams}},{key:"requestQueryParams",get:function(){var t=new URLSearchParams,e=!0,r=!1,n=void 0;try{for(var i,o=this.config.queryParams[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var s=i.value;t.append(s[0],s[1])}}catch(t){r=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(r)throw n}}var u=!0,a=!1,c=void 0;try{for(var h,p=this.queryParams[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var l=h.value;t.append(l[0],l[1])}}catch(t){a=!0,c=t}finally{try{!u&&p.return&&p.return()}finally{if(a)throw c}}var f=t.toString();return f.length?"?"+f:""}},{key:"headers",set:function(t){t&&(t instanceof Headers?this.$headers=t:this.$headers=objectToMap(new Headers,t))},get:function(){return this.$headers}},{key:"requestHeaders",get:function(){var t=new Headers,e=!0,r=!1,n=void 0;try{for(var i,o=this.headers[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var s=i.value;t.append(s[0],s[1])}}catch(t){r=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(r)throw n}}var u=!0,a=!1,c=void 0;try{for(var h,p=this.config.headers[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var l=h.value;t.append(l[0],l[1])}}catch(t){a=!0,c=t}finally{try{!u&&p.return&&p.return()}finally{if(a)throw c}}return t}}]),t}(),RxRestItem=function(t){function e(t,r,n,i){var o;classCallCheck(this,e);var s=possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,t,i));return s.$element={},void 0!==r&&(s.element=r),o=new Proxy(s.$element,new RxRestProxyHandler(s)),possibleConstructorReturn(s,o)}return inherits(e,RxRest$1),createClass(e,[{key:"save",value:function(t,e){return this.queryParams=t,this.headers=e,this.request(!0===this.$fromServer?"PUT":"POST",this)}},{key:"plain",value:function(){return this.element}},{key:"json",value:function(){return JSON.stringify(this.plain())}},{key:"clone",value:function(){var t=this.$route;this.$element[this.config.identifier]&&(t=t.slice(0,this.$route.length-1));var r=new e(t,this.$element,this.config);return r.$fromServer=this.$fromServer,r}},{key:"element",set:function(t){for(var e in t)e!==this.config.identifier||this.$element[this.config.identifier]||this.$route.push(""+t[e]),this.$element[e]=t[e]},get:function(){return this.$element}}]),e}(),RxRestCollection=function(t){function e(t,r,n,i){var o,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];classCallCheck(this,e);var u=possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,t,i));return u.$elements=[],void 0!==r&&(u.elements=r.map(function(t){return t instanceof RxRestItem?t.clone():new RxRestItem(u.$route,t)})),u.$asIterable=s,o=new Proxy(u.$elements,new RxRestProxyHandler(u)),possibleConstructorReturn(u,o)}return inherits(e,RxRest$1),createClass(e,[{key:Symbol.iterator,value:function(){var t=0,e=this.$elements;return{next:function(){return t<e.length?{value:e[t++],done:!1}:{value:void 0,done:!0}}}}},{key:"getList",value:function(t,e){return this.queryParams=t,this.headers=e,this.request("GET")}},{key:"plain",value:function(){return this.elements.map(function(t){return t.plain()})}},{key:"json",value:function(){return JSON.stringify(this.plain())}},{key:"clone",value:function(){return new e(this.$route,this.$elements,this.config)}},{key:"elements",set:function(t){this.$elements=t,this.length=t.length},get:function(){return this.$elements}}]),e}(),RxRest=function(){function t(e){classCallCheck(this,t),this.config=e}return createClass(t,[{key:"one",value:function(t,e){var r=new RxRest$1(this.config);return r.one.call(r,t,e)}},{key:"all",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new RxRest$1(this.config);return r.all.call(r,t,e)}},{key:"fromObject",value:function(t,e){var r=new RxRest$1(this.config);return r.fromObject.call(r,t,e)}}]),t}();exports.RxRestConfiguration=RxRestConfiguration$$1,exports.RxRestItem=RxRestItem,exports.RxRestCollection=RxRestCollection,exports.RxRest=RxRest;
//# sourceMappingURL=rxrest.bundle.min.js.map
