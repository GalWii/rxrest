{"version":3,"file":"rxrest.bundle.min.js","sources":["../node_modules/rxjs/util/isFunction.js","../node_modules/rxjs/util/isObject.js","../node_modules/rxjs/util/tryCatch.js","../node_modules/rxjs/Subscription.js","../node_modules/rxjs/util/toSubscriber.js","../node_modules/rxjs/observable/PromiseObservable.js","../node_modules/rxjs/util/isPromise.js","../node_modules/rxjs/util/subscribeToResult.js","../node_modules/rxjs/operator/mergeMap.js","../node_modules/rxjs/operator/concatMap.js","../node_modules/rxjs/operator/catch.js","../node_modules/rxjs/util/isScheduler.js","../src/utils.ts","../node_modules/superagent/lib/is-object.js","../node_modules/superagent/lib/request-base.js","../node_modules/superagent/lib/response-base.js","../node_modules/superagent/lib/agent-base.js","../src/fetch.ts","../src/RxRestProxyHandler.ts","../node_modules/rxjs/util/root.js","../node_modules/rxjs/util/isArray.js","../node_modules/rxjs/util/errorObject.js","../node_modules/rxjs/util/UnsubscriptionError.js","../node_modules/rxjs/Observer.js","../node_modules/rxjs/symbol/rxSubscriber.js","../node_modules/rxjs/Subscriber.js","../node_modules/rxjs/symbol/observable.js","../node_modules/rxjs/Observable.js","../node_modules/rxjs/observable/fromPromise.js","../node_modules/rxjs/add/observable/fromPromise.js","../node_modules/rxjs/util/isArrayLike.js","../node_modules/rxjs/symbol/iterator.js","../node_modules/rxjs/InnerSubscriber.js","../node_modules/rxjs/OuterSubscriber.js","../node_modules/rxjs/add/operator/mergeMap.js","../node_modules/rxjs/observable/ErrorObservable.js","../node_modules/rxjs/observable/throw.js","../node_modules/rxjs/add/observable/throw.js","../node_modules/rxjs/add/operator/concatMap.js","../node_modules/rxjs/add/operator/catch.js","../node_modules/rxjs/observable/ScalarObservable.js","../node_modules/rxjs/observable/EmptyObservable.js","../node_modules/rxjs/observable/ArrayObservable.js","../node_modules/rxjs/observable/of.js","../node_modules/rxjs/add/observable/of.js","../node_modules/component-emitter/index.js","../node_modules/superagent/lib/utils.js","../node_modules/superagent/lib/client.js","../src/RxRestConfiguration.ts","../src/RxRest.ts","../src/index.ts"],"sourcesContent":["\"use strict\";\nfunction isFunction(x) {\n    return typeof x === 'function';\n}\nexports.isFunction = isFunction;\n//# sourceMappingURL=isFunction.js.map","\"use strict\";\nfunction isObject(x) {\n    return x != null && typeof x === 'object';\n}\nexports.isObject = isObject;\n//# sourceMappingURL=isObject.js.map","\"use strict\";\nvar errorObject_1 = require('./errorObject');\nvar tryCatchTarget;\nfunction tryCatcher() {\n    try {\n        return tryCatchTarget.apply(this, arguments);\n    }\n    catch (e) {\n        errorObject_1.errorObject.e = e;\n        return errorObject_1.errorObject;\n    }\n}\nfunction tryCatch(fn) {\n    tryCatchTarget = fn;\n    return tryCatcher;\n}\nexports.tryCatch = tryCatch;\n;\n//# sourceMappingURL=tryCatch.js.map","\"use strict\";\nvar isArray_1 = require('./util/isArray');\nvar isObject_1 = require('./util/isObject');\nvar isFunction_1 = require('./util/isFunction');\nvar tryCatch_1 = require('./util/tryCatch');\nvar errorObject_1 = require('./util/errorObject');\nvar UnsubscriptionError_1 = require('./util/UnsubscriptionError');\n/**\n * Represents a disposable resource, such as the execution of an Observable. A\n * Subscription has one important method, `unsubscribe`, that takes no argument\n * and just disposes the resource held by the subscription.\n *\n * Additionally, subscriptions may be grouped together through the `add()`\n * method, which will attach a child Subscription to the current Subscription.\n * When a Subscription is unsubscribed, all its children (and its grandchildren)\n * will be unsubscribed as well.\n *\n * @class Subscription\n */\nvar Subscription = (function () {\n    /**\n     * @param {function(): void} [unsubscribe] A function describing how to\n     * perform the disposal of resources when the `unsubscribe` method is called.\n     */\n    function Subscription(unsubscribe) {\n        /**\n         * A flag to indicate whether this Subscription has already been unsubscribed.\n         * @type {boolean}\n         */\n        this.closed = false;\n        this._parent = null;\n        this._parents = null;\n        this._subscriptions = null;\n        if (unsubscribe) {\n            this._unsubscribe = unsubscribe;\n        }\n    }\n    /**\n     * Disposes the resources held by the subscription. May, for instance, cancel\n     * an ongoing Observable execution or cancel any other type of work that\n     * started when the Subscription was created.\n     * @return {void}\n     */\n    Subscription.prototype.unsubscribe = function () {\n        var hasErrors = false;\n        var errors;\n        if (this.closed) {\n            return;\n        }\n        var _a = this, _parent = _a._parent, _parents = _a._parents, _unsubscribe = _a._unsubscribe, _subscriptions = _a._subscriptions;\n        this.closed = true;\n        this._parent = null;\n        this._parents = null;\n        // null out _subscriptions first so any child subscriptions that attempt\n        // to remove themselves from this subscription will noop\n        this._subscriptions = null;\n        var index = -1;\n        var len = _parents ? _parents.length : 0;\n        // if this._parent is null, then so is this._parents, and we\n        // don't have to remove ourselves from any parent subscriptions.\n        while (_parent) {\n            _parent.remove(this);\n            // if this._parents is null or index >= len,\n            // then _parent is set to null, and the loop exits\n            _parent = ++index < len && _parents[index] || null;\n        }\n        if (isFunction_1.isFunction(_unsubscribe)) {\n            var trial = tryCatch_1.tryCatch(_unsubscribe).call(this);\n            if (trial === errorObject_1.errorObject) {\n                hasErrors = true;\n                errors = errors || (errorObject_1.errorObject.e instanceof UnsubscriptionError_1.UnsubscriptionError ?\n                    flattenUnsubscriptionErrors(errorObject_1.errorObject.e.errors) : [errorObject_1.errorObject.e]);\n            }\n        }\n        if (isArray_1.isArray(_subscriptions)) {\n            index = -1;\n            len = _subscriptions.length;\n            while (++index < len) {\n                var sub = _subscriptions[index];\n                if (isObject_1.isObject(sub)) {\n                    var trial = tryCatch_1.tryCatch(sub.unsubscribe).call(sub);\n                    if (trial === errorObject_1.errorObject) {\n                        hasErrors = true;\n                        errors = errors || [];\n                        var err = errorObject_1.errorObject.e;\n                        if (err instanceof UnsubscriptionError_1.UnsubscriptionError) {\n                            errors = errors.concat(flattenUnsubscriptionErrors(err.errors));\n                        }\n                        else {\n                            errors.push(err);\n                        }\n                    }\n                }\n            }\n        }\n        if (hasErrors) {\n            throw new UnsubscriptionError_1.UnsubscriptionError(errors);\n        }\n    };\n    /**\n     * Adds a tear down to be called during the unsubscribe() of this\n     * Subscription.\n     *\n     * If the tear down being added is a subscription that is already\n     * unsubscribed, is the same reference `add` is being called on, or is\n     * `Subscription.EMPTY`, it will not be added.\n     *\n     * If this subscription is already in an `closed` state, the passed\n     * tear down logic will be executed immediately.\n     *\n     * @param {TeardownLogic} teardown The additional logic to execute on\n     * teardown.\n     * @return {Subscription} Returns the Subscription used or created to be\n     * added to the inner subscriptions list. This Subscription can be used with\n     * `remove()` to remove the passed teardown logic from the inner subscriptions\n     * list.\n     */\n    Subscription.prototype.add = function (teardown) {\n        if (!teardown || (teardown === Subscription.EMPTY)) {\n            return Subscription.EMPTY;\n        }\n        if (teardown === this) {\n            return this;\n        }\n        var subscription = teardown;\n        switch (typeof teardown) {\n            case 'function':\n                subscription = new Subscription(teardown);\n            case 'object':\n                if (subscription.closed || typeof subscription.unsubscribe !== 'function') {\n                    return subscription;\n                }\n                else if (this.closed) {\n                    subscription.unsubscribe();\n                    return subscription;\n                }\n                else if (typeof subscription._addParent !== 'function' /* quack quack */) {\n                    var tmp = subscription;\n                    subscription = new Subscription();\n                    subscription._subscriptions = [tmp];\n                }\n                break;\n            default:\n                throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');\n        }\n        var subscriptions = this._subscriptions || (this._subscriptions = []);\n        subscriptions.push(subscription);\n        subscription._addParent(this);\n        return subscription;\n    };\n    /**\n     * Removes a Subscription from the internal list of subscriptions that will\n     * unsubscribe during the unsubscribe process of this Subscription.\n     * @param {Subscription} subscription The subscription to remove.\n     * @return {void}\n     */\n    Subscription.prototype.remove = function (subscription) {\n        var subscriptions = this._subscriptions;\n        if (subscriptions) {\n            var subscriptionIndex = subscriptions.indexOf(subscription);\n            if (subscriptionIndex !== -1) {\n                subscriptions.splice(subscriptionIndex, 1);\n            }\n        }\n    };\n    Subscription.prototype._addParent = function (parent) {\n        var _a = this, _parent = _a._parent, _parents = _a._parents;\n        if (!_parent || _parent === parent) {\n            // If we don't have a parent, or the new parent is the same as the\n            // current parent, then set this._parent to the new parent.\n            this._parent = parent;\n        }\n        else if (!_parents) {\n            // If there's already one parent, but not multiple, allocate an Array to\n            // store the rest of the parent Subscriptions.\n            this._parents = [parent];\n        }\n        else if (_parents.indexOf(parent) === -1) {\n            // Only add the new parent to the _parents list if it's not already there.\n            _parents.push(parent);\n        }\n    };\n    Subscription.EMPTY = (function (empty) {\n        empty.closed = true;\n        return empty;\n    }(new Subscription()));\n    return Subscription;\n}());\nexports.Subscription = Subscription;\nfunction flattenUnsubscriptionErrors(errors) {\n    return errors.reduce(function (errs, err) { return errs.concat((err instanceof UnsubscriptionError_1.UnsubscriptionError) ? err.errors : err); }, []);\n}\n//# sourceMappingURL=Subscription.js.map","\"use strict\";\nvar Subscriber_1 = require('../Subscriber');\nvar rxSubscriber_1 = require('../symbol/rxSubscriber');\nvar Observer_1 = require('../Observer');\nfunction toSubscriber(nextOrObserver, error, complete) {\n    if (nextOrObserver) {\n        if (nextOrObserver instanceof Subscriber_1.Subscriber) {\n            return nextOrObserver;\n        }\n        if (nextOrObserver[rxSubscriber_1.rxSubscriber]) {\n            return nextOrObserver[rxSubscriber_1.rxSubscriber]();\n        }\n    }\n    if (!nextOrObserver && !error && !complete) {\n        return new Subscriber_1.Subscriber(Observer_1.empty);\n    }\n    return new Subscriber_1.Subscriber(nextOrObserver, error, complete);\n}\nexports.toSubscriber = toSubscriber;\n//# sourceMappingURL=toSubscriber.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar root_1 = require('../util/root');\nvar Observable_1 = require('../Observable');\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @extends {Ignored}\n * @hide true\n */\nvar PromiseObservable = (function (_super) {\n    __extends(PromiseObservable, _super);\n    function PromiseObservable(promise, scheduler) {\n        _super.call(this);\n        this.promise = promise;\n        this.scheduler = scheduler;\n    }\n    /**\n     * Converts a Promise to an Observable.\n     *\n     * <span class=\"informal\">Returns an Observable that just emits the Promise's\n     * resolved value, then completes.</span>\n     *\n     * Converts an ES2015 Promise or a Promises/A+ spec compliant Promise to an\n     * Observable. If the Promise resolves with a value, the output Observable\n     * emits that resolved value as a `next`, and then completes. If the Promise\n     * is rejected, then the output Observable emits the corresponding Error.\n     *\n     * @example <caption>Convert the Promise returned by Fetch to an Observable</caption>\n     * var result = Rx.Observable.fromPromise(fetch('http://myserver.com/'));\n     * result.subscribe(x => console.log(x), e => console.error(e));\n     *\n     * @see {@link bindCallback}\n     * @see {@link from}\n     *\n     * @param {PromiseLike<T>} promise The promise to be converted.\n     * @param {Scheduler} [scheduler] An optional IScheduler to use for scheduling\n     * the delivery of the resolved value (or the rejection).\n     * @return {Observable<T>} An Observable which wraps the Promise.\n     * @static true\n     * @name fromPromise\n     * @owner Observable\n     */\n    PromiseObservable.create = function (promise, scheduler) {\n        return new PromiseObservable(promise, scheduler);\n    };\n    PromiseObservable.prototype._subscribe = function (subscriber) {\n        var _this = this;\n        var promise = this.promise;\n        var scheduler = this.scheduler;\n        if (scheduler == null) {\n            if (this._isScalar) {\n                if (!subscriber.closed) {\n                    subscriber.next(this.value);\n                    subscriber.complete();\n                }\n            }\n            else {\n                promise.then(function (value) {\n                    _this.value = value;\n                    _this._isScalar = true;\n                    if (!subscriber.closed) {\n                        subscriber.next(value);\n                        subscriber.complete();\n                    }\n                }, function (err) {\n                    if (!subscriber.closed) {\n                        subscriber.error(err);\n                    }\n                })\n                    .then(null, function (err) {\n                    // escape the promise trap, throw unhandled errors\n                    root_1.root.setTimeout(function () { throw err; });\n                });\n            }\n        }\n        else {\n            if (this._isScalar) {\n                if (!subscriber.closed) {\n                    return scheduler.schedule(dispatchNext, 0, { value: this.value, subscriber: subscriber });\n                }\n            }\n            else {\n                promise.then(function (value) {\n                    _this.value = value;\n                    _this._isScalar = true;\n                    if (!subscriber.closed) {\n                        subscriber.add(scheduler.schedule(dispatchNext, 0, { value: value, subscriber: subscriber }));\n                    }\n                }, function (err) {\n                    if (!subscriber.closed) {\n                        subscriber.add(scheduler.schedule(dispatchError, 0, { err: err, subscriber: subscriber }));\n                    }\n                })\n                    .then(null, function (err) {\n                    // escape the promise trap, throw unhandled errors\n                    root_1.root.setTimeout(function () { throw err; });\n                });\n            }\n        }\n    };\n    return PromiseObservable;\n}(Observable_1.Observable));\nexports.PromiseObservable = PromiseObservable;\nfunction dispatchNext(arg) {\n    var value = arg.value, subscriber = arg.subscriber;\n    if (!subscriber.closed) {\n        subscriber.next(value);\n        subscriber.complete();\n    }\n}\nfunction dispatchError(arg) {\n    var err = arg.err, subscriber = arg.subscriber;\n    if (!subscriber.closed) {\n        subscriber.error(err);\n    }\n}\n//# sourceMappingURL=PromiseObservable.js.map","\"use strict\";\nfunction isPromise(value) {\n    return value && typeof value.subscribe !== 'function' && typeof value.then === 'function';\n}\nexports.isPromise = isPromise;\n//# sourceMappingURL=isPromise.js.map","\"use strict\";\nvar root_1 = require('./root');\nvar isArrayLike_1 = require('./isArrayLike');\nvar isPromise_1 = require('./isPromise');\nvar isObject_1 = require('./isObject');\nvar Observable_1 = require('../Observable');\nvar iterator_1 = require('../symbol/iterator');\nvar InnerSubscriber_1 = require('../InnerSubscriber');\nvar observable_1 = require('../symbol/observable');\nfunction subscribeToResult(outerSubscriber, result, outerValue, outerIndex) {\n    var destination = new InnerSubscriber_1.InnerSubscriber(outerSubscriber, outerValue, outerIndex);\n    if (destination.closed) {\n        return null;\n    }\n    if (result instanceof Observable_1.Observable) {\n        if (result._isScalar) {\n            destination.next(result.value);\n            destination.complete();\n            return null;\n        }\n        else {\n            return result.subscribe(destination);\n        }\n    }\n    else if (isArrayLike_1.isArrayLike(result)) {\n        for (var i = 0, len = result.length; i < len && !destination.closed; i++) {\n            destination.next(result[i]);\n        }\n        if (!destination.closed) {\n            destination.complete();\n        }\n    }\n    else if (isPromise_1.isPromise(result)) {\n        result.then(function (value) {\n            if (!destination.closed) {\n                destination.next(value);\n                destination.complete();\n            }\n        }, function (err) { return destination.error(err); })\n            .then(null, function (err) {\n            // Escaping the Promise trap: globally throw unhandled errors\n            root_1.root.setTimeout(function () { throw err; });\n        });\n        return destination;\n    }\n    else if (result && typeof result[iterator_1.iterator] === 'function') {\n        var iterator = result[iterator_1.iterator]();\n        do {\n            var item = iterator.next();\n            if (item.done) {\n                destination.complete();\n                break;\n            }\n            destination.next(item.value);\n            if (destination.closed) {\n                break;\n            }\n        } while (true);\n    }\n    else if (result && typeof result[observable_1.observable] === 'function') {\n        var obs = result[observable_1.observable]();\n        if (typeof obs.subscribe !== 'function') {\n            destination.error(new TypeError('Provided object does not correctly implement Symbol.observable'));\n        }\n        else {\n            return obs.subscribe(new InnerSubscriber_1.InnerSubscriber(outerSubscriber, outerValue, outerIndex));\n        }\n    }\n    else {\n        var value = isObject_1.isObject(result) ? 'an invalid object' : \"'\" + result + \"'\";\n        var msg = (\"You provided \" + value + \" where a stream was expected.\")\n            + ' You can provide an Observable, Promise, Array, or Iterable.';\n        destination.error(new TypeError(msg));\n    }\n    return null;\n}\nexports.subscribeToResult = subscribeToResult;\n//# sourceMappingURL=subscribeToResult.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar subscribeToResult_1 = require('../util/subscribeToResult');\nvar OuterSubscriber_1 = require('../OuterSubscriber');\n/* tslint:enable:max-line-length */\n/**\n * Projects each source value to an Observable which is merged in the output\n * Observable.\n *\n * <span class=\"informal\">Maps each value to an Observable, then flattens all of\n * these inner Observables using {@link mergeAll}.</span>\n *\n * <img src=\"./img/mergeMap.png\" width=\"100%\">\n *\n * Returns an Observable that emits items based on applying a function that you\n * supply to each item emitted by the source Observable, where that function\n * returns an Observable, and then merging those resulting Observables and\n * emitting the results of this merger.\n *\n * @example <caption>Map and flatten each letter to an Observable ticking every 1 second</caption>\n * var letters = Rx.Observable.of('a', 'b', 'c');\n * var result = letters.mergeMap(x =>\n *   Rx.Observable.interval(1000).map(i => x+i)\n * );\n * result.subscribe(x => console.log(x));\n *\n * // Results in the following:\n * // a0\n * // b0\n * // c0\n * // a1\n * // b1\n * // c1\n * // continues to list a,b,c with respective ascending integers\n *\n * @see {@link concatMap}\n * @see {@link exhaustMap}\n * @see {@link merge}\n * @see {@link mergeAll}\n * @see {@link mergeMapTo}\n * @see {@link mergeScan}\n * @see {@link switchMap}\n *\n * @param {function(value: T, ?index: number): ObservableInput} project A function\n * that, when applied to an item emitted by the source Observable, returns an\n * Observable.\n * @param {function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any} [resultSelector]\n * A function to produce the value on the output Observable based on the values\n * and the indices of the source (outer) emission and the inner Observable\n * emission. The arguments passed to this function are:\n * - `outerValue`: the value that came from the source\n * - `innerValue`: the value that came from the projected Observable\n * - `outerIndex`: the \"index\" of the value that came from the source\n * - `innerIndex`: the \"index\" of the value from the projected Observable\n * @param {number} [concurrent=Number.POSITIVE_INFINITY] Maximum number of input\n * Observables being subscribed to concurrently.\n * @return {Observable} An Observable that emits the result of applying the\n * projection function (and the optional `resultSelector`) to each item emitted\n * by the source Observable and merging the results of the Observables obtained\n * from this transformation.\n * @method mergeMap\n * @owner Observable\n */\nfunction mergeMap(project, resultSelector, concurrent) {\n    if (concurrent === void 0) { concurrent = Number.POSITIVE_INFINITY; }\n    if (typeof resultSelector === 'number') {\n        concurrent = resultSelector;\n        resultSelector = null;\n    }\n    return this.lift(new MergeMapOperator(project, resultSelector, concurrent));\n}\nexports.mergeMap = mergeMap;\nvar MergeMapOperator = (function () {\n    function MergeMapOperator(project, resultSelector, concurrent) {\n        if (concurrent === void 0) { concurrent = Number.POSITIVE_INFINITY; }\n        this.project = project;\n        this.resultSelector = resultSelector;\n        this.concurrent = concurrent;\n    }\n    MergeMapOperator.prototype.call = function (observer, source) {\n        return source.subscribe(new MergeMapSubscriber(observer, this.project, this.resultSelector, this.concurrent));\n    };\n    return MergeMapOperator;\n}());\nexports.MergeMapOperator = MergeMapOperator;\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nvar MergeMapSubscriber = (function (_super) {\n    __extends(MergeMapSubscriber, _super);\n    function MergeMapSubscriber(destination, project, resultSelector, concurrent) {\n        if (concurrent === void 0) { concurrent = Number.POSITIVE_INFINITY; }\n        _super.call(this, destination);\n        this.project = project;\n        this.resultSelector = resultSelector;\n        this.concurrent = concurrent;\n        this.hasCompleted = false;\n        this.buffer = [];\n        this.active = 0;\n        this.index = 0;\n    }\n    MergeMapSubscriber.prototype._next = function (value) {\n        if (this.active < this.concurrent) {\n            this._tryNext(value);\n        }\n        else {\n            this.buffer.push(value);\n        }\n    };\n    MergeMapSubscriber.prototype._tryNext = function (value) {\n        var result;\n        var index = this.index++;\n        try {\n            result = this.project(value, index);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.active++;\n        this._innerSub(result, value, index);\n    };\n    MergeMapSubscriber.prototype._innerSub = function (ish, value, index) {\n        this.add(subscribeToResult_1.subscribeToResult(this, ish, value, index));\n    };\n    MergeMapSubscriber.prototype._complete = function () {\n        this.hasCompleted = true;\n        if (this.active === 0 && this.buffer.length === 0) {\n            this.destination.complete();\n        }\n    };\n    MergeMapSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        if (this.resultSelector) {\n            this._notifyResultSelector(outerValue, innerValue, outerIndex, innerIndex);\n        }\n        else {\n            this.destination.next(innerValue);\n        }\n    };\n    MergeMapSubscriber.prototype._notifyResultSelector = function (outerValue, innerValue, outerIndex, innerIndex) {\n        var result;\n        try {\n            result = this.resultSelector(outerValue, innerValue, outerIndex, innerIndex);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.destination.next(result);\n    };\n    MergeMapSubscriber.prototype.notifyComplete = function (innerSub) {\n        var buffer = this.buffer;\n        this.remove(innerSub);\n        this.active--;\n        if (buffer.length > 0) {\n            this._next(buffer.shift());\n        }\n        else if (this.active === 0 && this.hasCompleted) {\n            this.destination.complete();\n        }\n    };\n    return MergeMapSubscriber;\n}(OuterSubscriber_1.OuterSubscriber));\nexports.MergeMapSubscriber = MergeMapSubscriber;\n//# sourceMappingURL=mergeMap.js.map","\"use strict\";\nvar mergeMap_1 = require('./mergeMap');\n/* tslint:enable:max-line-length */\n/**\n * Projects each source value to an Observable which is merged in the output\n * Observable, in a serialized fashion waiting for each one to complete before\n * merging the next.\n *\n * <span class=\"informal\">Maps each value to an Observable, then flattens all of\n * these inner Observables using {@link concatAll}.</span>\n *\n * <img src=\"./img/concatMap.png\" width=\"100%\">\n *\n * Returns an Observable that emits items based on applying a function that you\n * supply to each item emitted by the source Observable, where that function\n * returns an (so-called \"inner\") Observable. Each new inner Observable is\n * concatenated with the previous inner Observable.\n *\n * __Warning:__ if source values arrive endlessly and faster than their\n * corresponding inner Observables can complete, it will result in memory issues\n * as inner Observables amass in an unbounded buffer waiting for their turn to\n * be subscribed to.\n *\n * Note: `concatMap` is equivalent to `mergeMap` with concurrency parameter set\n * to `1`.\n *\n * @example <caption>For each click event, tick every second from 0 to 3, with no concurrency</caption>\n * var clicks = Rx.Observable.fromEvent(document, 'click');\n * var result = clicks.concatMap(ev => Rx.Observable.interval(1000).take(4));\n * result.subscribe(x => console.log(x));\n *\n * // Results in the following:\n * // (results are not concurrent)\n * // For every click on the \"document\" it will emit values 0 to 3 spaced\n * // on a 1000ms interval\n * // one click = 1000ms-> 0 -1000ms-> 1 -1000ms-> 2 -1000ms-> 3\n *\n * @see {@link concat}\n * @see {@link concatAll}\n * @see {@link concatMapTo}\n * @see {@link exhaustMap}\n * @see {@link mergeMap}\n * @see {@link switchMap}\n *\n * @param {function(value: T, ?index: number): ObservableInput} project A function\n * that, when applied to an item emitted by the source Observable, returns an\n * Observable.\n * @param {function(outerValue: T, innerValue: I, outerIndex: number, innerIndex: number): any} [resultSelector]\n * A function to produce the value on the output Observable based on the values\n * and the indices of the source (outer) emission and the inner Observable\n * emission. The arguments passed to this function are:\n * - `outerValue`: the value that came from the source\n * - `innerValue`: the value that came from the projected Observable\n * - `outerIndex`: the \"index\" of the value that came from the source\n * - `innerIndex`: the \"index\" of the value from the projected Observable\n * @return {Observable} An Observable that emits the result of applying the\n * projection function (and the optional `resultSelector`) to each item emitted\n * by the source Observable and taking values from each projected inner\n * Observable sequentially.\n * @method concatMap\n * @owner Observable\n */\nfunction concatMap(project, resultSelector) {\n    return this.lift(new mergeMap_1.MergeMapOperator(project, resultSelector, 1));\n}\nexports.concatMap = concatMap;\n//# sourceMappingURL=concatMap.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar OuterSubscriber_1 = require('../OuterSubscriber');\nvar subscribeToResult_1 = require('../util/subscribeToResult');\n/**\n * Catches errors on the observable to be handled by returning a new observable or throwing an error.\n *\n * <img src=\"./img/catch.png\" width=\"100%\">\n *\n * @example <caption>Continues with a different Observable when there's an error</caption>\n *\n * Observable.of(1, 2, 3, 4, 5)\n *   .map(n => {\n * \t   if (n == 4) {\n * \t     throw 'four!';\n *     }\n *\t   return n;\n *   })\n *   .catch(err => Observable.of('I', 'II', 'III', 'IV', 'V'))\n *   .subscribe(x => console.log(x));\n *   // 1, 2, 3, I, II, III, IV, V\n *\n * @example <caption>Retries the caught source Observable again in case of error, similar to retry() operator</caption>\n *\n * Observable.of(1, 2, 3, 4, 5)\n *   .map(n => {\n * \t   if (n === 4) {\n * \t     throw 'four!';\n *     }\n * \t   return n;\n *   })\n *   .catch((err, caught) => caught)\n *   .take(30)\n *   .subscribe(x => console.log(x));\n *   // 1, 2, 3, 1, 2, 3, ...\n *\n * @example <caption>Throws a new error when the source Observable throws an error</caption>\n *\n * Observable.of(1, 2, 3, 4, 5)\n *   .map(n => {\n *     if (n == 4) {\n *       throw 'four!';\n *     }\n *     return n;\n *   })\n *   .catch(err => {\n *     throw 'error in source. Details: ' + err;\n *   })\n *   .subscribe(\n *     x => console.log(x),\n *     err => console.log(err)\n *   );\n *   // 1, 2, 3, error in source. Details: four!\n *\n * @param {function} selector a function that takes as arguments `err`, which is the error, and `caught`, which\n *  is the source observable, in case you'd like to \"retry\" that observable by returning it again. Whatever observable\n *  is returned by the `selector` will be used to continue the observable chain.\n * @return {Observable} An observable that originates from either the source or the observable returned by the\n *  catch `selector` function.\n * @method catch\n * @name catch\n * @owner Observable\n */\nfunction _catch(selector) {\n    var operator = new CatchOperator(selector);\n    var caught = this.lift(operator);\n    return (operator.caught = caught);\n}\nexports._catch = _catch;\nvar CatchOperator = (function () {\n    function CatchOperator(selector) {\n        this.selector = selector;\n    }\n    CatchOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new CatchSubscriber(subscriber, this.selector, this.caught));\n    };\n    return CatchOperator;\n}());\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nvar CatchSubscriber = (function (_super) {\n    __extends(CatchSubscriber, _super);\n    function CatchSubscriber(destination, selector, caught) {\n        _super.call(this, destination);\n        this.selector = selector;\n        this.caught = caught;\n    }\n    // NOTE: overriding `error` instead of `_error` because we don't want\n    // to have this flag this subscriber as `isStopped`. We can mimic the\n    // behavior of the RetrySubscriber (from the `retry` operator), where\n    // we unsubscribe from our source chain, reset our Subscriber flags,\n    // then subscribe to the selector result.\n    CatchSubscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            var result = void 0;\n            try {\n                result = this.selector(err, this.caught);\n            }\n            catch (err2) {\n                _super.prototype.error.call(this, err2);\n                return;\n            }\n            this._unsubscribeAndRecycle();\n            this.add(subscribeToResult_1.subscribeToResult(this, result));\n        }\n    };\n    return CatchSubscriber;\n}(OuterSubscriber_1.OuterSubscriber));\n//# sourceMappingURL=catch.js.map","\"use strict\";\nfunction isScheduler(value) {\n    return value && typeof value.schedule === 'function';\n}\nexports.isScheduler = isScheduler;\n//# sourceMappingURL=isScheduler.js.map","export function objectToMap(map: URLSearchParams | Headers, item: any): any {\n  for (let key in item) {\n    if (Array.isArray(item[key])) {\n      for (let i = 0; i < item[key].length; i++) {\n        map.append(key, item[key][i])\n      }\n    } else {\n      map.append(key, item[key])\n    }\n  }\n\n  return map\n}\n\n/**\n * UUID generator https://gist.github.com/jed/982883\n */\nexport function uuid(a: any = '', b: any = '') {\n  for (; a++ < 36; b += a * 51 & 52 ? (\n    a ^ 15 ? 8 ^ Math.random() * (a ^ 20 ? 16 : 4) : 4\n  ).toString(16) : '-') {\n    //\n  }\n  return b\n}\n","'use strict';\n\n/**\n * Check if `obj` is an object.\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isObject(obj) {\n  return null !== obj && 'object' === typeof obj;\n}\n\nmodule.exports = isObject;\n","'use strict';\n\n/**\n * Module of mixed-in functions shared between node and client code\n */\nvar isObject = require('./is-object');\n\n/**\n * Expose `RequestBase`.\n */\n\nmodule.exports = RequestBase;\n\n/**\n * Initialize a new `RequestBase`.\n *\n * @api public\n */\n\nfunction RequestBase(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the prototype properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in RequestBase.prototype) {\n    obj[key] = RequestBase.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Clear previous timeout.\n *\n * @return {Request} for chaining\n * @api public\n */\n\nRequestBase.prototype.clearTimeout = function _clearTimeout(){\n  clearTimeout(this._timer);\n  clearTimeout(this._responseTimeoutTimer);\n  delete this._timer;\n  delete this._responseTimeoutTimer;\n  return this;\n};\n\n/**\n * Override default response body parser\n *\n * This function will be called to convert incoming data into request.body\n *\n * @param {Function}\n * @api public\n */\n\nRequestBase.prototype.parse = function parse(fn){\n  this._parser = fn;\n  return this;\n};\n\n/**\n * Set format of binary response body.\n * In browser valid formats are 'blob' and 'arraybuffer',\n * which return Blob and ArrayBuffer, respectively.\n *\n * In Node all values result in Buffer.\n *\n * Examples:\n *\n *      req.get('/')\n *        .responseType('blob')\n *        .end(callback);\n *\n * @param {String} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequestBase.prototype.responseType = function(val){\n  this._responseType = val;\n  return this;\n};\n\n/**\n * Override default request body serializer\n *\n * This function will be called to convert data set via .send or .attach into payload to send\n *\n * @param {Function}\n * @api public\n */\n\nRequestBase.prototype.serialize = function serialize(fn){\n  this._serializer = fn;\n  return this;\n};\n\n/**\n * Set timeouts.\n *\n * - response timeout is time between sending request and receiving the first byte of the response. Includes DNS and connection time.\n * - deadline is the time from start of the request to receiving response body in full. If the deadline is too short large files may not load at all on slow connections.\n *\n * Value of 0 or false means no timeout.\n *\n * @param {Number|Object} ms or {response, deadline}\n * @return {Request} for chaining\n * @api public\n */\n\nRequestBase.prototype.timeout = function timeout(options){\n  if (!options || 'object' !== typeof options) {\n    this._timeout = options;\n    this._responseTimeout = 0;\n    return this;\n  }\n\n  for(var option in options) {\n    switch(option) {\n      case 'deadline':\n        this._timeout = options.deadline;\n        break;\n      case 'response':\n        this._responseTimeout = options.response;\n        break;\n      default:\n        console.warn(\"Unknown timeout option\", option);\n    }\n  }\n  return this;\n};\n\n/**\n * Set number of retry attempts on error.\n *\n * Failed requests will be retried 'count' times if timeout or err.code >= 500.\n *\n * @param {Number} count\n * @param {Function} [fn]\n * @return {Request} for chaining\n * @api public\n */\n\nRequestBase.prototype.retry = function retry(count, fn){\n  // Default to 1 if no count passed or true\n  if (arguments.length === 0 || count === true) count = 1;\n  if (count <= 0) count = 0;\n  this._maxRetries = count;\n  this._retries = 0;\n  this._retryCallback = fn;\n  return this;\n};\n\nvar ERROR_CODES = [\n  'ECONNRESET',\n  'ETIMEDOUT',\n  'EADDRINFO',\n  'ESOCKETTIMEDOUT'\n];\n\n/**\n * Determine if a request should be retried.\n * (Borrowed from segmentio/superagent-retry)\n *\n * @param {Error} err\n * @param {Response} [res]\n * @returns {Boolean}\n */\nRequestBase.prototype._shouldRetry = function(err, res) {\n  if (!this._maxRetries || this._retries++ >= this._maxRetries) {\n    return false;\n  }\n  if (this._retryCallback) {\n    try {\n      var override = this._retryCallback(err, res);\n      if (override === true) return true;\n      if (override === false) return false;\n      // undefined falls back to defaults\n    } catch(e) {\n      console.error(e);\n    }\n  }\n  if (res && res.status && res.status >= 500 && res.status != 501) return true;\n  if (err) {\n    if (err.code && ~ERROR_CODES.indexOf(err.code)) return true;\n    // Superagent timeout\n    if (err.timeout && err.code == 'ECONNABORTED') return true;\n    if (err.crossDomain) return true;\n  }\n  return false;\n};\n\n/**\n * Retry request\n *\n * @return {Request} for chaining\n * @api private\n */\n\nRequestBase.prototype._retry = function() {\n\n  this.clearTimeout();\n\n  // node\n  if (this.req) {\n    this.req = null;\n    this.req = this.request();\n  }\n\n  this._aborted = false;\n  this.timedout = false;\n\n  return this._end();\n};\n\n/**\n * Promise support\n *\n * @param {Function} resolve\n * @param {Function} [reject]\n * @return {Request}\n */\n\nRequestBase.prototype.then = function then(resolve, reject) {\n  if (!this._fullfilledPromise) {\n    var self = this;\n    if (this._endCalled) {\n      console.warn(\"Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises\");\n    }\n    this._fullfilledPromise = new Promise(function(innerResolve, innerReject) {\n      self.end(function(err, res) {\n        if (err) innerReject(err);\n        else innerResolve(res);\n      });\n    });\n  }\n  return this._fullfilledPromise.then(resolve, reject);\n};\n\nRequestBase.prototype.catch = function(cb) {\n  return this.then(undefined, cb);\n};\n\n/**\n * Allow for extension\n */\n\nRequestBase.prototype.use = function use(fn) {\n  fn(this);\n  return this;\n};\n\nRequestBase.prototype.ok = function(cb) {\n  if ('function' !== typeof cb) throw Error(\"Callback required\");\n  this._okCallback = cb;\n  return this;\n};\n\nRequestBase.prototype._isResponseOK = function(res) {\n  if (!res) {\n    return false;\n  }\n\n  if (this._okCallback) {\n    return this._okCallback(res);\n  }\n\n  return res.status >= 200 && res.status < 300;\n};\n\n/**\n * Get request header `field`.\n * Case-insensitive.\n *\n * @param {String} field\n * @return {String}\n * @api public\n */\n\nRequestBase.prototype.get = function(field){\n  return this._header[field.toLowerCase()];\n};\n\n/**\n * Get case-insensitive header `field` value.\n * This is a deprecated internal API. Use `.get(field)` instead.\n *\n * (getHeader is no longer used internally by the superagent code base)\n *\n * @param {String} field\n * @return {String}\n * @api private\n * @deprecated\n */\n\nRequestBase.prototype.getHeader = RequestBase.prototype.get;\n\n/**\n * Set header `field` to `val`, or multiple fields with one object.\n * Case-insensitive.\n *\n * Examples:\n *\n *      req.get('/')\n *        .set('Accept', 'application/json')\n *        .set('X-API-Key', 'foobar')\n *        .end(callback);\n *\n *      req.get('/')\n *        .set({ Accept: 'application/json', 'X-API-Key': 'foobar' })\n *        .end(callback);\n *\n * @param {String|Object} field\n * @param {String} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequestBase.prototype.set = function(field, val){\n  if (isObject(field)) {\n    for (var key in field) {\n      this.set(key, field[key]);\n    }\n    return this;\n  }\n  this._header[field.toLowerCase()] = val;\n  this.header[field] = val;\n  return this;\n};\n\n/**\n * Remove header `field`.\n * Case-insensitive.\n *\n * Example:\n *\n *      req.get('/')\n *        .unset('User-Agent')\n *        .end(callback);\n *\n * @param {String} field\n */\nRequestBase.prototype.unset = function(field){\n  delete this._header[field.toLowerCase()];\n  delete this.header[field];\n  return this;\n};\n\n/**\n * Write the field `name` and `val`, or multiple fields with one object\n * for \"multipart/form-data\" request bodies.\n *\n * ``` js\n * request.post('/upload')\n *   .field('foo', 'bar')\n *   .end(callback);\n *\n * request.post('/upload')\n *   .field({ foo: 'bar', baz: 'qux' })\n *   .end(callback);\n * ```\n *\n * @param {String|Object} name\n * @param {String|Blob|File|Buffer|fs.ReadStream} val\n * @return {Request} for chaining\n * @api public\n */\nRequestBase.prototype.field = function(name, val) {\n  // name should be either a string or an object.\n  if (null === name || undefined === name) {\n    throw new Error('.field(name, val) name can not be empty');\n  }\n\n  if (this._data) {\n    console.error(\".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()\");\n  }\n\n  if (isObject(name)) {\n    for (var key in name) {\n      this.field(key, name[key]);\n    }\n    return this;\n  }\n\n  if (Array.isArray(val)) {\n    for (var i in val) {\n      this.field(name, val[i]);\n    }\n    return this;\n  }\n\n  // val should be defined now\n  if (null === val || undefined === val) {\n    throw new Error('.field(name, val) val can not be empty');\n  }\n  if ('boolean' === typeof val) {\n    val = '' + val;\n  }\n  this._getFormData().append(name, val);\n  return this;\n};\n\n/**\n * Abort the request, and clear potential timeout.\n *\n * @return {Request}\n * @api public\n */\nRequestBase.prototype.abort = function(){\n  if (this._aborted) {\n    return this;\n  }\n  this._aborted = true;\n  this.xhr && this.xhr.abort(); // browser\n  this.req && this.req.abort(); // node\n  this.clearTimeout();\n  this.emit('abort');\n  return this;\n};\n\nRequestBase.prototype._auth = function(user, pass, options, base64Encoder) {\n  switch (options.type) {\n    case 'basic':\n      this.set('Authorization', 'Basic ' + base64Encoder(user + ':' + pass));\n      break;\n\n    case 'auto':\n      this.username = user;\n      this.password = pass;\n      break;\n\n    case 'bearer': // usage would be .auth(accessToken, { type: 'bearer' })\n      this.set('Authorization', 'Bearer ' + user);\n      break;\n  }\n  return this;\n};\n\n/**\n * Enable transmission of cookies with x-domain requests.\n *\n * Note that for this to work the origin must not be\n * using \"Access-Control-Allow-Origin\" with a wildcard,\n * and also must set \"Access-Control-Allow-Credentials\"\n * to \"true\".\n *\n * @api public\n */\n\nRequestBase.prototype.withCredentials = function(on) {\n  // This is browser-only functionality. Node side is no-op.\n  if (on == undefined) on = true;\n  this._withCredentials = on;\n  return this;\n};\n\n/**\n * Set the max redirects to `n`. Does noting in browser XHR implementation.\n *\n * @param {Number} n\n * @return {Request} for chaining\n * @api public\n */\n\nRequestBase.prototype.redirects = function(n){\n  this._maxRedirects = n;\n  return this;\n};\n\n/**\n * Maximum size of buffered response body, in bytes. Counts uncompressed size.\n * Default 200MB.\n *\n * @param {Number} n\n * @return {Request} for chaining\n */\nRequestBase.prototype.maxResponseSize = function(n){\n  if ('number' !== typeof n) {\n    throw TypeError(\"Invalid argument\");\n  }\n  this._maxResponseSize = n;\n  return this;\n};\n\n/**\n * Convert to a plain javascript object (not JSON string) of scalar properties.\n * Note as this method is designed to return a useful non-this value,\n * it cannot be chained.\n *\n * @return {Object} describing method, url, and data of this request\n * @api public\n */\n\nRequestBase.prototype.toJSON = function() {\n  return {\n    method: this.method,\n    url: this.url,\n    data: this._data,\n    headers: this._header,\n  };\n};\n\n/**\n * Send `data` as the request body, defaulting the `.type()` to \"json\" when\n * an object is given.\n *\n * Examples:\n *\n *       // manual json\n *       request.post('/user')\n *         .type('json')\n *         .send('{\"name\":\"tj\"}')\n *         .end(callback)\n *\n *       // auto json\n *       request.post('/user')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // manual x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send('name=tj')\n *         .end(callback)\n *\n *       // auto x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // defaults to x-www-form-urlencoded\n *      request.post('/user')\n *        .send('name=tobi')\n *        .send('species=ferret')\n *        .end(callback)\n *\n * @param {String|Object} data\n * @return {Request} for chaining\n * @api public\n */\n\nRequestBase.prototype.send = function(data){\n  var isObj = isObject(data);\n  var type = this._header['content-type'];\n\n  if (this._formData) {\n    console.error(\".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()\");\n  }\n\n  if (isObj && !this._data) {\n    if (Array.isArray(data)) {\n      this._data = [];\n    } else if (!this._isHost(data)) {\n      this._data = {};\n    }\n  } else if (data && this._data && this._isHost(this._data)) {\n    throw Error(\"Can't merge these send calls\");\n  }\n\n  // merge\n  if (isObj && isObject(this._data)) {\n    for (var key in data) {\n      this._data[key] = data[key];\n    }\n  } else if ('string' == typeof data) {\n    // default to x-www-form-urlencoded\n    if (!type) this.type('form');\n    type = this._header['content-type'];\n    if ('application/x-www-form-urlencoded' == type) {\n      this._data = this._data\n        ? this._data + '&' + data\n        : data;\n    } else {\n      this._data = (this._data || '') + data;\n    }\n  } else {\n    this._data = data;\n  }\n\n  if (!isObj || this._isHost(data)) {\n    return this;\n  }\n\n  // default to json\n  if (!type) this.type('json');\n  return this;\n};\n\n/**\n * Sort `querystring` by the sort function\n *\n *\n * Examples:\n *\n *       // default order\n *       request.get('/user')\n *         .query('name=Nick')\n *         .query('search=Manny')\n *         .sortQuery()\n *         .end(callback)\n *\n *       // customized sort function\n *       request.get('/user')\n *         .query('name=Nick')\n *         .query('search=Manny')\n *         .sortQuery(function(a, b){\n *           return a.length - b.length;\n *         })\n *         .end(callback)\n *\n *\n * @param {Function} sort\n * @return {Request} for chaining\n * @api public\n */\n\nRequestBase.prototype.sortQuery = function(sort) {\n  // _sort default to true but otherwise can be a function or boolean\n  this._sort = typeof sort === 'undefined' ? true : sort;\n  return this;\n};\n\n/**\n * Compose querystring to append to req.url\n *\n * @api private\n */\nRequestBase.prototype._finalizeQueryString = function(){\n  var query = this._query.join('&');\n  if (query) {\n    this.url += (this.url.indexOf('?') >= 0 ? '&' : '?') + query;\n  }\n  this._query.length = 0; // Makes the call idempotent\n\n  if (this._sort) {\n    var index = this.url.indexOf('?');\n    if (index >= 0) {\n      var queryArr = this.url.substring(index + 1).split('&');\n      if ('function' === typeof this._sort) {\n        queryArr.sort(this._sort);\n      } else {\n        queryArr.sort();\n      }\n      this.url = this.url.substring(0, index) + '?' + queryArr.join('&');\n    }\n  }\n};\n\n// For backwards compat only\nRequestBase.prototype._appendQueryString = function() {console.trace(\"Unsupported\");}\n\n/**\n * Invoke callback with timeout error.\n *\n * @api private\n */\n\nRequestBase.prototype._timeoutError = function(reason, timeout, errno){\n  if (this._aborted) {\n    return;\n  }\n  var err = new Error(reason + timeout + 'ms exceeded');\n  err.timeout = timeout;\n  err.code = 'ECONNABORTED';\n  err.errno = errno;\n  this.timedout = true;\n  this.abort();\n  this.callback(err);\n};\n\nRequestBase.prototype._setTimeouts = function() {\n  var self = this;\n\n  // deadline\n  if (this._timeout && !this._timer) {\n    this._timer = setTimeout(function(){\n      self._timeoutError('Timeout of ', self._timeout, 'ETIME');\n    }, this._timeout);\n  }\n  // response timeout\n  if (this._responseTimeout && !this._responseTimeoutTimer) {\n    this._responseTimeoutTimer = setTimeout(function(){\n      self._timeoutError('Response timeout of ', self._responseTimeout, 'ETIMEDOUT');\n    }, this._responseTimeout);\n  }\n};\n","'use strict';\n\n/**\n * Module dependencies.\n */\n\nvar utils = require('./utils');\n\n/**\n * Expose `ResponseBase`.\n */\n\nmodule.exports = ResponseBase;\n\n/**\n * Initialize a new `ResponseBase`.\n *\n * @api public\n */\n\nfunction ResponseBase(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the prototype properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in ResponseBase.prototype) {\n    obj[key] = ResponseBase.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Get case-insensitive `field` value.\n *\n * @param {String} field\n * @return {String}\n * @api public\n */\n\nResponseBase.prototype.get = function(field) {\n  return this.header[field.toLowerCase()];\n};\n\n/**\n * Set header related properties:\n *\n *   - `.type` the content type without params\n *\n * A response of \"Content-Type: text/plain; charset=utf-8\"\n * will provide you with a `.type` of \"text/plain\".\n *\n * @param {Object} header\n * @api private\n */\n\nResponseBase.prototype._setHeaderProperties = function(header){\n    // TODO: moar!\n    // TODO: make this a util\n\n    // content-type\n    var ct = header['content-type'] || '';\n    this.type = utils.type(ct);\n\n    // params\n    var params = utils.params(ct);\n    for (var key in params) this[key] = params[key];\n\n    this.links = {};\n\n    // links\n    try {\n        if (header.link) {\n            this.links = utils.parseLinks(header.link);\n        }\n    } catch (err) {\n        // ignore\n    }\n};\n\n/**\n * Set flags such as `.ok` based on `status`.\n *\n * For example a 2xx response will give you a `.ok` of __true__\n * whereas 5xx will be __false__ and `.error` will be __true__. The\n * `.clientError` and `.serverError` are also available to be more\n * specific, and `.statusType` is the class of error ranging from 1..5\n * sometimes useful for mapping respond colors etc.\n *\n * \"sugar\" properties are also defined for common cases. Currently providing:\n *\n *   - .noContent\n *   - .badRequest\n *   - .unauthorized\n *   - .notAcceptable\n *   - .notFound\n *\n * @param {Number} status\n * @api private\n */\n\nResponseBase.prototype._setStatusProperties = function(status){\n    var type = status / 100 | 0;\n\n    // status / class\n    this.status = this.statusCode = status;\n    this.statusType = type;\n\n    // basics\n    this.info = 1 == type;\n    this.ok = 2 == type;\n    this.redirect = 3 == type;\n    this.clientError = 4 == type;\n    this.serverError = 5 == type;\n    this.error = (4 == type || 5 == type)\n        ? this.toError()\n        : false;\n\n    // sugar\n    this.accepted = 202 == status;\n    this.noContent = 204 == status;\n    this.badRequest = 400 == status;\n    this.unauthorized = 401 == status;\n    this.notAcceptable = 406 == status;\n    this.forbidden = 403 == status;\n    this.notFound = 404 == status;\n};\n","function Agent() {\n  this._defaults = [];\n}\n\n[\"use\", \"on\", \"once\", \"set\", \"query\", \"type\", \"accept\", \"auth\", \"withCredentials\", \"sortQuery\", \"retry\", \"ok\", \"redirects\",\n \"timeout\", \"buffer\", \"serialize\", \"parse\", \"ca\", \"key\", \"pfx\", \"cert\"].forEach(function(fn) {\n  /** Default setting for all requests from this agent */\n  Agent.prototype[fn] = function(/*varargs*/) {\n    this._defaults.push({fn:fn, arguments:arguments});\n    return this;\n  }\n});\n\nAgent.prototype._setDefaults = function(req) {\n    this._defaults.forEach(function(def) {\n      req[def.fn].apply(req, def.arguments);\n    });\n};\n\nmodule.exports = Agent;\n","import './rxjs'\nimport {ErrorResponse} from './interfaces'\nimport * as superagent from 'superagent'\nimport {Observable} from 'rxjs/Observable'\nimport {Observer} from 'rxjs/Observer'\n\nexport function fetch(\n  input: string|Request,\n  init?: RequestInit,\n  abortCallback?: (req: Request) => void\n): Observable<any> {\n\n  if (!(input instanceof Request)) {\n    input = new Request(input, init)\n  }\n\n  let req = superagent[input.method.toLowerCase()](input.url)\n\n  for (let header of input.headers) {\n    req.set(header[0], header[1])\n  }\n\n  return Observable.fromPromise(input.text())\n  .mergeMap(body => {\n    req.send(body)\n\n    return Observable.create((observer: Observer<any>) => {\n      req.end(function(err: any, res: any) {\n        if (err) {\n          let response = new Response(err, res) as ErrorResponse\n          response.message = response.statusText\n          return observer.error(response)\n        }\n\n        if (res.noContent === true) {\n          observer.next(new Response())\n          return observer.complete()\n        }\n\n        res.url = (input as Request).url\n        let response = new Response(res.text, res)\n\n        observer.next(response)\n        observer.complete()\n      })\n\n      return function abort() {\n        req.abort()\n        if (abortCallback) {\n          abortCallback(req)\n        }\n      }\n    })\n  })\n}\n","import {RxRest} from './RxRest'\n\nexport class RxRestProxyHandler<F, T> implements ProxyHandler<RxRest<F, T>> {\n  private $internal: PropertyKey[] = [];\n  private $instance: F;\n\n  constructor(target: F) {\n    this.$instance = target\n    do {\n      this.$internal = this.$internal.concat(\n        Object.getOwnPropertyNames(target), Object.getOwnPropertySymbols(target)\n      )\n    } while (target = Object.getPrototypeOf(target))\n  }\n\n  getPrototypeOf(target: any) {\n    return Object.getPrototypeOf(this.$instance)\n  }\n\n  defineProperty(target: any, p: PropertyKey, attributes: PropertyDescriptor): boolean {\n    if (~this.$internal.indexOf(p)) {\n      return true\n    }\n\n    Object.defineProperty(target, p, attributes)\n    return true\n  }\n\n  deleteProperty(target: any, p: PropertyKey): boolean {\n    return delete target[p]\n  }\n\n  set(target: any, p: PropertyKey, value: any, receiver: any): boolean {\n\n    if (~this.$internal.indexOf(p)) {\n      this.$instance[p] = value\n      return true\n    }\n\n    if ((this.$instance as any).$pristine === true && target[p] !== value) {\n      (this.$instance as any).$pristine = false\n    }\n\n    target[p] = value\n    return true\n  }\n\n  get(target: any, p: PropertyKey, receiver: any): any {\n    if (~this.$internal.indexOf(p)) {\n      return this.$instance[p]\n    }\n\n    return target[p]\n  }\n}\n","\"use strict\";\n// CommonJS / Node have global context exposed as \"global\" variable.\n// We don't want to include the whole node.d.ts this this compilation unit so we'll just fake\n// the global \"global\" var for now.\nvar __window = typeof window !== 'undefined' && window;\nvar __self = typeof self !== 'undefined' && typeof WorkerGlobalScope !== 'undefined' &&\n    self instanceof WorkerGlobalScope && self;\nvar __global = typeof global !== 'undefined' && global;\nvar _root = __window || __global || __self;\nexports.root = _root;\n// Workaround Closure Compiler restriction: The body of a goog.module cannot use throw.\n// This is needed when used with angular/tsickle which inserts a goog.module statement.\n// Wrap in IIFE\n(function () {\n    if (!_root) {\n        throw new Error('RxJS could not find any global context (window, self, global)');\n    }\n})();\n//# sourceMappingURL=root.js.map","\"use strict\";\nexports.isArray = Array.isArray || (function (x) { return x && typeof x.length === 'number'; });\n//# sourceMappingURL=isArray.js.map","\"use strict\";\n// typeof any so that it we don't have to cast when comparing a result to the error object\nexports.errorObject = { e: {} };\n//# sourceMappingURL=errorObject.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n/**\n * An error thrown when one or more errors have occurred during the\n * `unsubscribe` of a {@link Subscription}.\n */\nvar UnsubscriptionError = (function (_super) {\n    __extends(UnsubscriptionError, _super);\n    function UnsubscriptionError(errors) {\n        _super.call(this);\n        this.errors = errors;\n        var err = Error.call(this, errors ?\n            errors.length + \" errors occurred during unsubscription:\\n  \" + errors.map(function (err, i) { return ((i + 1) + \") \" + err.toString()); }).join('\\n  ') : '');\n        this.name = err.name = 'UnsubscriptionError';\n        this.stack = err.stack;\n        this.message = err.message;\n    }\n    return UnsubscriptionError;\n}(Error));\nexports.UnsubscriptionError = UnsubscriptionError;\n//# sourceMappingURL=UnsubscriptionError.js.map","\"use strict\";\nexports.empty = {\n    closed: true,\n    next: function (value) { },\n    error: function (err) { throw err; },\n    complete: function () { }\n};\n//# sourceMappingURL=Observer.js.map","\"use strict\";\nvar root_1 = require('../util/root');\nvar Symbol = root_1.root.Symbol;\nexports.rxSubscriber = (typeof Symbol === 'function' && typeof Symbol.for === 'function') ?\n    Symbol.for('rxSubscriber') : '@@rxSubscriber';\n/**\n * @deprecated use rxSubscriber instead\n */\nexports.$$rxSubscriber = exports.rxSubscriber;\n//# sourceMappingURL=rxSubscriber.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar isFunction_1 = require('./util/isFunction');\nvar Subscription_1 = require('./Subscription');\nvar Observer_1 = require('./Observer');\nvar rxSubscriber_1 = require('./symbol/rxSubscriber');\n/**\n * Implements the {@link Observer} interface and extends the\n * {@link Subscription} class. While the {@link Observer} is the public API for\n * consuming the values of an {@link Observable}, all Observers get converted to\n * a Subscriber, in order to provide Subscription-like capabilities such as\n * `unsubscribe`. Subscriber is a common type in RxJS, and crucial for\n * implementing operators, but it is rarely used as a public API.\n *\n * @class Subscriber<T>\n */\nvar Subscriber = (function (_super) {\n    __extends(Subscriber, _super);\n    /**\n     * @param {Observer|function(value: T): void} [destinationOrNext] A partially\n     * defined Observer or a `next` callback function.\n     * @param {function(e: ?any): void} [error] The `error` callback of an\n     * Observer.\n     * @param {function(): void} [complete] The `complete` callback of an\n     * Observer.\n     */\n    function Subscriber(destinationOrNext, error, complete) {\n        _super.call(this);\n        this.syncErrorValue = null;\n        this.syncErrorThrown = false;\n        this.syncErrorThrowable = false;\n        this.isStopped = false;\n        switch (arguments.length) {\n            case 0:\n                this.destination = Observer_1.empty;\n                break;\n            case 1:\n                if (!destinationOrNext) {\n                    this.destination = Observer_1.empty;\n                    break;\n                }\n                if (typeof destinationOrNext === 'object') {\n                    if (destinationOrNext instanceof Subscriber) {\n                        this.destination = destinationOrNext;\n                        this.destination.add(this);\n                    }\n                    else {\n                        this.syncErrorThrowable = true;\n                        this.destination = new SafeSubscriber(this, destinationOrNext);\n                    }\n                    break;\n                }\n            default:\n                this.syncErrorThrowable = true;\n                this.destination = new SafeSubscriber(this, destinationOrNext, error, complete);\n                break;\n        }\n    }\n    Subscriber.prototype[rxSubscriber_1.rxSubscriber] = function () { return this; };\n    /**\n     * A static factory for a Subscriber, given a (potentially partial) definition\n     * of an Observer.\n     * @param {function(x: ?T): void} [next] The `next` callback of an Observer.\n     * @param {function(e: ?any): void} [error] The `error` callback of an\n     * Observer.\n     * @param {function(): void} [complete] The `complete` callback of an\n     * Observer.\n     * @return {Subscriber<T>} A Subscriber wrapping the (partially defined)\n     * Observer represented by the given arguments.\n     */\n    Subscriber.create = function (next, error, complete) {\n        var subscriber = new Subscriber(next, error, complete);\n        subscriber.syncErrorThrowable = false;\n        return subscriber;\n    };\n    /**\n     * The {@link Observer} callback to receive notifications of type `next` from\n     * the Observable, with a value. The Observable may call this method 0 or more\n     * times.\n     * @param {T} [value] The `next` value.\n     * @return {void}\n     */\n    Subscriber.prototype.next = function (value) {\n        if (!this.isStopped) {\n            this._next(value);\n        }\n    };\n    /**\n     * The {@link Observer} callback to receive notifications of type `error` from\n     * the Observable, with an attached {@link Error}. Notifies the Observer that\n     * the Observable has experienced an error condition.\n     * @param {any} [err] The `error` exception.\n     * @return {void}\n     */\n    Subscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    /**\n     * The {@link Observer} callback to receive a valueless notification of type\n     * `complete` from the Observable. Notifies the Observer that the Observable\n     * has finished sending push-based notifications.\n     * @return {void}\n     */\n    Subscriber.prototype.complete = function () {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (this.closed) {\n            return;\n        }\n        this.isStopped = true;\n        _super.prototype.unsubscribe.call(this);\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        this.destination.error(err);\n        this.unsubscribe();\n    };\n    Subscriber.prototype._complete = function () {\n        this.destination.complete();\n        this.unsubscribe();\n    };\n    Subscriber.prototype._unsubscribeAndRecycle = function () {\n        var _a = this, _parent = _a._parent, _parents = _a._parents;\n        this._parent = null;\n        this._parents = null;\n        this.unsubscribe();\n        this.closed = false;\n        this.isStopped = false;\n        this._parent = _parent;\n        this._parents = _parents;\n        return this;\n    };\n    return Subscriber;\n}(Subscription_1.Subscription));\nexports.Subscriber = Subscriber;\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nvar SafeSubscriber = (function (_super) {\n    __extends(SafeSubscriber, _super);\n    function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) {\n        _super.call(this);\n        this._parentSubscriber = _parentSubscriber;\n        var next;\n        var context = this;\n        if (isFunction_1.isFunction(observerOrNext)) {\n            next = observerOrNext;\n        }\n        else if (observerOrNext) {\n            next = observerOrNext.next;\n            error = observerOrNext.error;\n            complete = observerOrNext.complete;\n            if (observerOrNext !== Observer_1.empty) {\n                context = Object.create(observerOrNext);\n                if (isFunction_1.isFunction(context.unsubscribe)) {\n                    this.add(context.unsubscribe.bind(context));\n                }\n                context.unsubscribe = this.unsubscribe.bind(this);\n            }\n        }\n        this._context = context;\n        this._next = next;\n        this._error = error;\n        this._complete = complete;\n    }\n    SafeSubscriber.prototype.next = function (value) {\n        if (!this.isStopped && this._next) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (!_parentSubscriber.syncErrorThrowable) {\n                this.__tryOrUnsub(this._next, value);\n            }\n            else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (this._error) {\n                if (!_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(this._error, err);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, this._error, err);\n                    this.unsubscribe();\n                }\n            }\n            else if (!_parentSubscriber.syncErrorThrowable) {\n                this.unsubscribe();\n                throw err;\n            }\n            else {\n                _parentSubscriber.syncErrorValue = err;\n                _parentSubscriber.syncErrorThrown = true;\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.complete = function () {\n        var _this = this;\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (this._complete) {\n                var wrappedComplete = function () { return _this._complete.call(_this._context); };\n                if (!_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(wrappedComplete);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, wrappedComplete);\n                    this.unsubscribe();\n                }\n            }\n            else {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) {\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            this.unsubscribe();\n            throw err;\n        }\n    };\n    SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) {\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            parent.syncErrorValue = err;\n            parent.syncErrorThrown = true;\n            return true;\n        }\n        return false;\n    };\n    SafeSubscriber.prototype._unsubscribe = function () {\n        var _parentSubscriber = this._parentSubscriber;\n        this._context = null;\n        this._parentSubscriber = null;\n        _parentSubscriber.unsubscribe();\n    };\n    return SafeSubscriber;\n}(Subscriber));\n//# sourceMappingURL=Subscriber.js.map","\"use strict\";\nvar root_1 = require('../util/root');\nfunction getSymbolObservable(context) {\n    var $$observable;\n    var Symbol = context.Symbol;\n    if (typeof Symbol === 'function') {\n        if (Symbol.observable) {\n            $$observable = Symbol.observable;\n        }\n        else {\n            $$observable = Symbol('observable');\n            Symbol.observable = $$observable;\n        }\n    }\n    else {\n        $$observable = '@@observable';\n    }\n    return $$observable;\n}\nexports.getSymbolObservable = getSymbolObservable;\nexports.observable = getSymbolObservable(root_1.root);\n/**\n * @deprecated use observable instead\n */\nexports.$$observable = exports.observable;\n//# sourceMappingURL=observable.js.map","\"use strict\";\nvar root_1 = require('./util/root');\nvar toSubscriber_1 = require('./util/toSubscriber');\nvar observable_1 = require('./symbol/observable');\n/**\n * A representation of any set of values over any amount of time. This is the most basic building block\n * of RxJS.\n *\n * @class Observable<T>\n */\nvar Observable = (function () {\n    /**\n     * @constructor\n     * @param {Function} subscribe the function that is called when the Observable is\n     * initially subscribed to. This function is given a Subscriber, to which new values\n     * can be `next`ed, or an `error` method can be called to raise an error, or\n     * `complete` can be called to notify of a successful completion.\n     */\n    function Observable(subscribe) {\n        this._isScalar = false;\n        if (subscribe) {\n            this._subscribe = subscribe;\n        }\n    }\n    /**\n     * Creates a new Observable, with this Observable as the source, and the passed\n     * operator defined as the new observable's operator.\n     * @method lift\n     * @param {Operator} operator the operator defining the operation to take on the observable\n     * @return {Observable} a new observable with the Operator applied\n     */\n    Observable.prototype.lift = function (operator) {\n        var observable = new Observable();\n        observable.source = this;\n        observable.operator = operator;\n        return observable;\n    };\n    /**\n     * Invokes an execution of an Observable and registers Observer handlers for notifications it will emit.\n     *\n     * <span class=\"informal\">Use it when you have all these Observables, but still nothing is happening.</span>\n     *\n     * `subscribe` is not a regular operator, but a method that calls Observable's internal `subscribe` function. It\n     * might be for example a function that you passed to a {@link create} static factory, but most of the time it is\n     * a library implementation, which defines what and when will be emitted by an Observable. This means that calling\n     * `subscribe` is actually the moment when Observable starts its work, not when it is created, as it is often\n     * thought.\n     *\n     * Apart from starting the execution of an Observable, this method allows you to listen for values\n     * that an Observable emits, as well as for when it completes or errors. You can achieve this in two\n     * following ways.\n     *\n     * The first way is creating an object that implements {@link Observer} interface. It should have methods\n     * defined by that interface, but note that it should be just a regular JavaScript object, which you can create\n     * yourself in any way you want (ES6 class, classic function constructor, object literal etc.). In particular do\n     * not attempt to use any RxJS implementation details to create Observers - you don't need them. Remember also\n     * that your object does not have to implement all methods. If you find yourself creating a method that doesn't\n     * do anything, you can simply omit it. Note however, that if `error` method is not provided, all errors will\n     * be left uncaught.\n     *\n     * The second way is to give up on Observer object altogether and simply provide callback functions in place of its methods.\n     * This means you can provide three functions as arguments to `subscribe`, where first function is equivalent\n     * of a `next` method, second of an `error` method and third of a `complete` method. Just as in case of Observer,\n     * if you do not need to listen for something, you can omit a function, preferably by passing `undefined` or `null`,\n     * since `subscribe` recognizes these functions by where they were placed in function call. When it comes\n     * to `error` function, just as before, if not provided, errors emitted by an Observable will be thrown.\n     *\n     * Whatever style of calling `subscribe` you use, in both cases it returns a Subscription object.\n     * This object allows you to call `unsubscribe` on it, which in turn will stop work that an Observable does and will clean\n     * up all resources that an Observable used. Note that cancelling a subscription will not call `complete` callback\n     * provided to `subscribe` function, which is reserved for a regular completion signal that comes from an Observable.\n     *\n     * Remember that callbacks provided to `subscribe` are not guaranteed to be called asynchronously.\n     * It is an Observable itself that decides when these functions will be called. For example {@link of}\n     * by default emits all its values synchronously. Always check documentation for how given Observable\n     * will behave when subscribed and if its default behavior can be modified with a {@link Scheduler}.\n     *\n     * @example <caption>Subscribe with an Observer</caption>\n     * const sumObserver = {\n     *   sum: 0,\n     *   next(value) {\n     *     console.log('Adding: ' + value);\n     *     this.sum = this.sum + value;\n     *   },\n     *   error() { // We actually could just remove this method,\n     *   },        // since we do not really care about errors right now.\n     *   complete() {\n     *     console.log('Sum equals: ' + this.sum);\n     *   }\n     * };\n     *\n     * Rx.Observable.of(1, 2, 3) // Synchronously emits 1, 2, 3 and then completes.\n     * .subscribe(sumObserver);\n     *\n     * // Logs:\n     * // \"Adding: 1\"\n     * // \"Adding: 2\"\n     * // \"Adding: 3\"\n     * // \"Sum equals: 6\"\n     *\n     *\n     * @example <caption>Subscribe with functions</caption>\n     * let sum = 0;\n     *\n     * Rx.Observable.of(1, 2, 3)\n     * .subscribe(\n     *   function(value) {\n     *     console.log('Adding: ' + value);\n     *     sum = sum + value;\n     *   },\n     *   undefined,\n     *   function() {\n     *     console.log('Sum equals: ' + sum);\n     *   }\n     * );\n     *\n     * // Logs:\n     * // \"Adding: 1\"\n     * // \"Adding: 2\"\n     * // \"Adding: 3\"\n     * // \"Sum equals: 6\"\n     *\n     *\n     * @example <caption>Cancel a subscription</caption>\n     * const subscription = Rx.Observable.interval(1000).subscribe(\n     *   num => console.log(num),\n     *   undefined,\n     *   () => console.log('completed!') // Will not be called, even\n     * );                                // when cancelling subscription\n     *\n     *\n     * setTimeout(() => {\n     *   subscription.unsubscribe();\n     *   console.log('unsubscribed!');\n     * }, 2500);\n     *\n     * // Logs:\n     * // 0 after 1s\n     * // 1 after 2s\n     * // \"unsubscribed!\" after 2.5s\n     *\n     *\n     * @param {Observer|Function} observerOrNext (optional) Either an observer with methods to be called,\n     *  or the first of three possible handlers, which is the handler for each value emitted from the subscribed\n     *  Observable.\n     * @param {Function} error (optional) A handler for a terminal event resulting from an error. If no error handler is provided,\n     *  the error will be thrown as unhandled.\n     * @param {Function} complete (optional) A handler for a terminal event resulting from successful completion.\n     * @return {ISubscription} a subscription reference to the registered handlers\n     * @method subscribe\n     */\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var operator = this.operator;\n        var sink = toSubscriber_1.toSubscriber(observerOrNext, error, complete);\n        if (operator) {\n            operator.call(sink, this.source);\n        }\n        else {\n            sink.add(this.source ? this._subscribe(sink) : this._trySubscribe(sink));\n        }\n        if (sink.syncErrorThrowable) {\n            sink.syncErrorThrowable = false;\n            if (sink.syncErrorThrown) {\n                throw sink.syncErrorValue;\n            }\n        }\n        return sink;\n    };\n    Observable.prototype._trySubscribe = function (sink) {\n        try {\n            return this._subscribe(sink);\n        }\n        catch (err) {\n            sink.syncErrorThrown = true;\n            sink.syncErrorValue = err;\n            sink.error(err);\n        }\n    };\n    /**\n     * @method forEach\n     * @param {Function} next a handler for each value emitted by the observable\n     * @param {PromiseConstructor} [PromiseCtor] a constructor function used to instantiate the Promise\n     * @return {Promise} a promise that either resolves on observable completion or\n     *  rejects with the handled error\n     */\n    Observable.prototype.forEach = function (next, PromiseCtor) {\n        var _this = this;\n        if (!PromiseCtor) {\n            if (root_1.root.Rx && root_1.root.Rx.config && root_1.root.Rx.config.Promise) {\n                PromiseCtor = root_1.root.Rx.config.Promise;\n            }\n            else if (root_1.root.Promise) {\n                PromiseCtor = root_1.root.Promise;\n            }\n        }\n        if (!PromiseCtor) {\n            throw new Error('no Promise impl found');\n        }\n        return new PromiseCtor(function (resolve, reject) {\n            // Must be declared in a separate statement to avoid a RefernceError when\n            // accessing subscription below in the closure due to Temporal Dead Zone.\n            var subscription;\n            subscription = _this.subscribe(function (value) {\n                if (subscription) {\n                    // if there is a subscription, then we can surmise\n                    // the next handling is asynchronous. Any errors thrown\n                    // need to be rejected explicitly and unsubscribe must be\n                    // called manually\n                    try {\n                        next(value);\n                    }\n                    catch (err) {\n                        reject(err);\n                        subscription.unsubscribe();\n                    }\n                }\n                else {\n                    // if there is NO subscription, then we're getting a nexted\n                    // value synchronously during subscription. We can just call it.\n                    // If it errors, Observable's `subscribe` will ensure the\n                    // unsubscription logic is called, then synchronously rethrow the error.\n                    // After that, Promise will trap the error and send it\n                    // down the rejection path.\n                    next(value);\n                }\n            }, reject, resolve);\n        });\n    };\n    Observable.prototype._subscribe = function (subscriber) {\n        return this.source.subscribe(subscriber);\n    };\n    /**\n     * An interop point defined by the es7-observable spec https://github.com/zenparsing/es-observable\n     * @method Symbol.observable\n     * @return {Observable} this instance of the observable\n     */\n    Observable.prototype[observable_1.observable] = function () {\n        return this;\n    };\n    // HACK: Since TypeScript inherits static properties too, we have to\n    // fight against TypeScript here so Subject can have a different static create signature\n    /**\n     * Creates a new cold Observable by calling the Observable constructor\n     * @static true\n     * @owner Observable\n     * @method create\n     * @param {Function} subscribe? the subscriber function to be passed to the Observable constructor\n     * @return {Observable} a new cold observable\n     */\n    Observable.create = function (subscribe) {\n        return new Observable(subscribe);\n    };\n    return Observable;\n}());\nexports.Observable = Observable;\n//# sourceMappingURL=Observable.js.map","\"use strict\";\nvar PromiseObservable_1 = require('./PromiseObservable');\nexports.fromPromise = PromiseObservable_1.PromiseObservable.create;\n//# sourceMappingURL=fromPromise.js.map","\"use strict\";\nvar Observable_1 = require('../../Observable');\nvar fromPromise_1 = require('../../observable/fromPromise');\nObservable_1.Observable.fromPromise = fromPromise_1.fromPromise;\n//# sourceMappingURL=fromPromise.js.map","\"use strict\";\nexports.isArrayLike = (function (x) { return x && typeof x.length === 'number'; });\n//# sourceMappingURL=isArrayLike.js.map","\"use strict\";\nvar root_1 = require('../util/root');\nfunction symbolIteratorPonyfill(root) {\n    var Symbol = root.Symbol;\n    if (typeof Symbol === 'function') {\n        if (!Symbol.iterator) {\n            Symbol.iterator = Symbol('iterator polyfill');\n        }\n        return Symbol.iterator;\n    }\n    else {\n        // [for Mozilla Gecko 27-35:](https://mzl.la/2ewE1zC)\n        var Set_1 = root.Set;\n        if (Set_1 && typeof new Set_1()['@@iterator'] === 'function') {\n            return '@@iterator';\n        }\n        var Map_1 = root.Map;\n        // required for compatability with es6-shim\n        if (Map_1) {\n            var keys = Object.getOwnPropertyNames(Map_1.prototype);\n            for (var i = 0; i < keys.length; ++i) {\n                var key = keys[i];\n                // according to spec, Map.prototype[@@iterator] and Map.orototype.entries must be equal.\n                if (key !== 'entries' && key !== 'size' && Map_1.prototype[key] === Map_1.prototype['entries']) {\n                    return key;\n                }\n            }\n        }\n        return '@@iterator';\n    }\n}\nexports.symbolIteratorPonyfill = symbolIteratorPonyfill;\nexports.iterator = symbolIteratorPonyfill(root_1.root);\n/**\n * @deprecated use iterator instead\n */\nexports.$$iterator = exports.iterator;\n//# sourceMappingURL=iterator.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Subscriber_1 = require('./Subscriber');\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nvar InnerSubscriber = (function (_super) {\n    __extends(InnerSubscriber, _super);\n    function InnerSubscriber(parent, outerValue, outerIndex) {\n        _super.call(this);\n        this.parent = parent;\n        this.outerValue = outerValue;\n        this.outerIndex = outerIndex;\n        this.index = 0;\n    }\n    InnerSubscriber.prototype._next = function (value) {\n        this.parent.notifyNext(this.outerValue, value, this.outerIndex, this.index++, this);\n    };\n    InnerSubscriber.prototype._error = function (error) {\n        this.parent.notifyError(error, this);\n        this.unsubscribe();\n    };\n    InnerSubscriber.prototype._complete = function () {\n        this.parent.notifyComplete(this);\n        this.unsubscribe();\n    };\n    return InnerSubscriber;\n}(Subscriber_1.Subscriber));\nexports.InnerSubscriber = InnerSubscriber;\n//# sourceMappingURL=InnerSubscriber.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Subscriber_1 = require('./Subscriber');\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nvar OuterSubscriber = (function (_super) {\n    __extends(OuterSubscriber, _super);\n    function OuterSubscriber() {\n        _super.apply(this, arguments);\n    }\n    OuterSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.destination.next(innerValue);\n    };\n    OuterSubscriber.prototype.notifyError = function (error, innerSub) {\n        this.destination.error(error);\n    };\n    OuterSubscriber.prototype.notifyComplete = function (innerSub) {\n        this.destination.complete();\n    };\n    return OuterSubscriber;\n}(Subscriber_1.Subscriber));\nexports.OuterSubscriber = OuterSubscriber;\n//# sourceMappingURL=OuterSubscriber.js.map","\"use strict\";\nvar Observable_1 = require('../../Observable');\nvar mergeMap_1 = require('../../operator/mergeMap');\nObservable_1.Observable.prototype.mergeMap = mergeMap_1.mergeMap;\nObservable_1.Observable.prototype.flatMap = mergeMap_1.mergeMap;\n//# sourceMappingURL=mergeMap.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Observable_1 = require('../Observable');\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @extends {Ignored}\n * @hide true\n */\nvar ErrorObservable = (function (_super) {\n    __extends(ErrorObservable, _super);\n    function ErrorObservable(error, scheduler) {\n        _super.call(this);\n        this.error = error;\n        this.scheduler = scheduler;\n    }\n    /**\n     * Creates an Observable that emits no items to the Observer and immediately\n     * emits an error notification.\n     *\n     * <span class=\"informal\">Just emits 'error', and nothing else.\n     * </span>\n     *\n     * <img src=\"./img/throw.png\" width=\"100%\">\n     *\n     * This static operator is useful for creating a simple Observable that only\n     * emits the error notification. It can be used for composing with other\n     * Observables, such as in a {@link mergeMap}.\n     *\n     * @example <caption>Emit the number 7, then emit an error.</caption>\n     * var result = Rx.Observable.throw(new Error('oops!')).startWith(7);\n     * result.subscribe(x => console.log(x), e => console.error(e));\n     *\n     * @example <caption>Map and flatten numbers to the sequence 'a', 'b', 'c', but throw an error for 13</caption>\n     * var interval = Rx.Observable.interval(1000);\n     * var result = interval.mergeMap(x =>\n     *   x === 13 ?\n     *     Rx.Observable.throw('Thirteens are bad') :\n     *     Rx.Observable.of('a', 'b', 'c')\n     * );\n     * result.subscribe(x => console.log(x), e => console.error(e));\n     *\n     * @see {@link create}\n     * @see {@link empty}\n     * @see {@link never}\n     * @see {@link of}\n     *\n     * @param {any} error The particular Error to pass to the error notification.\n     * @param {Scheduler} [scheduler] A {@link IScheduler} to use for scheduling\n     * the emission of the error notification.\n     * @return {Observable} An error Observable: emits only the error notification\n     * using the given error argument.\n     * @static true\n     * @name throw\n     * @owner Observable\n     */\n    ErrorObservable.create = function (error, scheduler) {\n        return new ErrorObservable(error, scheduler);\n    };\n    ErrorObservable.dispatch = function (arg) {\n        var error = arg.error, subscriber = arg.subscriber;\n        subscriber.error(error);\n    };\n    ErrorObservable.prototype._subscribe = function (subscriber) {\n        var error = this.error;\n        var scheduler = this.scheduler;\n        subscriber.syncErrorThrowable = true;\n        if (scheduler) {\n            return scheduler.schedule(ErrorObservable.dispatch, 0, {\n                error: error, subscriber: subscriber\n            });\n        }\n        else {\n            subscriber.error(error);\n        }\n    };\n    return ErrorObservable;\n}(Observable_1.Observable));\nexports.ErrorObservable = ErrorObservable;\n//# sourceMappingURL=ErrorObservable.js.map","\"use strict\";\nvar ErrorObservable_1 = require('./ErrorObservable');\nexports._throw = ErrorObservable_1.ErrorObservable.create;\n//# sourceMappingURL=throw.js.map","\"use strict\";\nvar Observable_1 = require('../../Observable');\nvar throw_1 = require('../../observable/throw');\nObservable_1.Observable.throw = throw_1._throw;\n//# sourceMappingURL=throw.js.map","\"use strict\";\nvar Observable_1 = require('../../Observable');\nvar concatMap_1 = require('../../operator/concatMap');\nObservable_1.Observable.prototype.concatMap = concatMap_1.concatMap;\n//# sourceMappingURL=concatMap.js.map","\"use strict\";\nvar Observable_1 = require('../../Observable');\nvar catch_1 = require('../../operator/catch');\nObservable_1.Observable.prototype.catch = catch_1._catch;\nObservable_1.Observable.prototype._catch = catch_1._catch;\n//# sourceMappingURL=catch.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Observable_1 = require('../Observable');\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @extends {Ignored}\n * @hide true\n */\nvar ScalarObservable = (function (_super) {\n    __extends(ScalarObservable, _super);\n    function ScalarObservable(value, scheduler) {\n        _super.call(this);\n        this.value = value;\n        this.scheduler = scheduler;\n        this._isScalar = true;\n        if (scheduler) {\n            this._isScalar = false;\n        }\n    }\n    ScalarObservable.create = function (value, scheduler) {\n        return new ScalarObservable(value, scheduler);\n    };\n    ScalarObservable.dispatch = function (state) {\n        var done = state.done, value = state.value, subscriber = state.subscriber;\n        if (done) {\n            subscriber.complete();\n            return;\n        }\n        subscriber.next(value);\n        if (subscriber.closed) {\n            return;\n        }\n        state.done = true;\n        this.schedule(state);\n    };\n    ScalarObservable.prototype._subscribe = function (subscriber) {\n        var value = this.value;\n        var scheduler = this.scheduler;\n        if (scheduler) {\n            return scheduler.schedule(ScalarObservable.dispatch, 0, {\n                done: false, value: value, subscriber: subscriber\n            });\n        }\n        else {\n            subscriber.next(value);\n            if (!subscriber.closed) {\n                subscriber.complete();\n            }\n        }\n    };\n    return ScalarObservable;\n}(Observable_1.Observable));\nexports.ScalarObservable = ScalarObservable;\n//# sourceMappingURL=ScalarObservable.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Observable_1 = require('../Observable');\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @extends {Ignored}\n * @hide true\n */\nvar EmptyObservable = (function (_super) {\n    __extends(EmptyObservable, _super);\n    function EmptyObservable(scheduler) {\n        _super.call(this);\n        this.scheduler = scheduler;\n    }\n    /**\n     * Creates an Observable that emits no items to the Observer and immediately\n     * emits a complete notification.\n     *\n     * <span class=\"informal\">Just emits 'complete', and nothing else.\n     * </span>\n     *\n     * <img src=\"./img/empty.png\" width=\"100%\">\n     *\n     * This static operator is useful for creating a simple Observable that only\n     * emits the complete notification. It can be used for composing with other\n     * Observables, such as in a {@link mergeMap}.\n     *\n     * @example <caption>Emit the number 7, then complete.</caption>\n     * var result = Rx.Observable.empty().startWith(7);\n     * result.subscribe(x => console.log(x));\n     *\n     * @example <caption>Map and flatten only odd numbers to the sequence 'a', 'b', 'c'</caption>\n     * var interval = Rx.Observable.interval(1000);\n     * var result = interval.mergeMap(x =>\n     *   x % 2 === 1 ? Rx.Observable.of('a', 'b', 'c') : Rx.Observable.empty()\n     * );\n     * result.subscribe(x => console.log(x));\n     *\n     * // Results in the following to the console:\n     * // x is equal to the count on the interval eg(0,1,2,3,...)\n     * // x will occur every 1000ms\n     * // if x % 2 is equal to 1 print abc\n     * // if x % 2 is not equal to 1 nothing will be output\n     *\n     * @see {@link create}\n     * @see {@link never}\n     * @see {@link of}\n     * @see {@link throw}\n     *\n     * @param {Scheduler} [scheduler] A {@link IScheduler} to use for scheduling\n     * the emission of the complete notification.\n     * @return {Observable} An \"empty\" Observable: emits only the complete\n     * notification.\n     * @static true\n     * @name empty\n     * @owner Observable\n     */\n    EmptyObservable.create = function (scheduler) {\n        return new EmptyObservable(scheduler);\n    };\n    EmptyObservable.dispatch = function (arg) {\n        var subscriber = arg.subscriber;\n        subscriber.complete();\n    };\n    EmptyObservable.prototype._subscribe = function (subscriber) {\n        var scheduler = this.scheduler;\n        if (scheduler) {\n            return scheduler.schedule(EmptyObservable.dispatch, 0, { subscriber: subscriber });\n        }\n        else {\n            subscriber.complete();\n        }\n    };\n    return EmptyObservable;\n}(Observable_1.Observable));\nexports.EmptyObservable = EmptyObservable;\n//# sourceMappingURL=EmptyObservable.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Observable_1 = require('../Observable');\nvar ScalarObservable_1 = require('./ScalarObservable');\nvar EmptyObservable_1 = require('./EmptyObservable');\nvar isScheduler_1 = require('../util/isScheduler');\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @extends {Ignored}\n * @hide true\n */\nvar ArrayObservable = (function (_super) {\n    __extends(ArrayObservable, _super);\n    function ArrayObservable(array, scheduler) {\n        _super.call(this);\n        this.array = array;\n        this.scheduler = scheduler;\n        if (!scheduler && array.length === 1) {\n            this._isScalar = true;\n            this.value = array[0];\n        }\n    }\n    ArrayObservable.create = function (array, scheduler) {\n        return new ArrayObservable(array, scheduler);\n    };\n    /**\n     * Creates an Observable that emits some values you specify as arguments,\n     * immediately one after the other, and then emits a complete notification.\n     *\n     * <span class=\"informal\">Emits the arguments you provide, then completes.\n     * </span>\n     *\n     * <img src=\"./img/of.png\" width=\"100%\">\n     *\n     * This static operator is useful for creating a simple Observable that only\n     * emits the arguments given, and the complete notification thereafter. It can\n     * be used for composing with other Observables, such as with {@link concat}.\n     * By default, it uses a `null` IScheduler, which means the `next`\n     * notifications are sent synchronously, although with a different IScheduler\n     * it is possible to determine when those notifications will be delivered.\n     *\n     * @example <caption>Emit 10, 20, 30, then 'a', 'b', 'c', then start ticking every second.</caption>\n     * var numbers = Rx.Observable.of(10, 20, 30);\n     * var letters = Rx.Observable.of('a', 'b', 'c');\n     * var interval = Rx.Observable.interval(1000);\n     * var result = numbers.concat(letters).concat(interval);\n     * result.subscribe(x => console.log(x));\n     *\n     * @see {@link create}\n     * @see {@link empty}\n     * @see {@link never}\n     * @see {@link throw}\n     *\n     * @param {...T} values Arguments that represent `next` values to be emitted.\n     * @param {Scheduler} [scheduler] A {@link IScheduler} to use for scheduling\n     * the emissions of the `next` notifications.\n     * @return {Observable<T>} An Observable that emits each given input value.\n     * @static true\n     * @name of\n     * @owner Observable\n     */\n    ArrayObservable.of = function () {\n        var array = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            array[_i - 0] = arguments[_i];\n        }\n        var scheduler = array[array.length - 1];\n        if (isScheduler_1.isScheduler(scheduler)) {\n            array.pop();\n        }\n        else {\n            scheduler = null;\n        }\n        var len = array.length;\n        if (len > 1) {\n            return new ArrayObservable(array, scheduler);\n        }\n        else if (len === 1) {\n            return new ScalarObservable_1.ScalarObservable(array[0], scheduler);\n        }\n        else {\n            return new EmptyObservable_1.EmptyObservable(scheduler);\n        }\n    };\n    ArrayObservable.dispatch = function (state) {\n        var array = state.array, index = state.index, count = state.count, subscriber = state.subscriber;\n        if (index >= count) {\n            subscriber.complete();\n            return;\n        }\n        subscriber.next(array[index]);\n        if (subscriber.closed) {\n            return;\n        }\n        state.index = index + 1;\n        this.schedule(state);\n    };\n    ArrayObservable.prototype._subscribe = function (subscriber) {\n        var index = 0;\n        var array = this.array;\n        var count = array.length;\n        var scheduler = this.scheduler;\n        if (scheduler) {\n            return scheduler.schedule(ArrayObservable.dispatch, 0, {\n                array: array, index: index, count: count, subscriber: subscriber\n            });\n        }\n        else {\n            for (var i = 0; i < count && !subscriber.closed; i++) {\n                subscriber.next(array[i]);\n            }\n            subscriber.complete();\n        }\n    };\n    return ArrayObservable;\n}(Observable_1.Observable));\nexports.ArrayObservable = ArrayObservable;\n//# sourceMappingURL=ArrayObservable.js.map","\"use strict\";\nvar ArrayObservable_1 = require('./ArrayObservable');\nexports.of = ArrayObservable_1.ArrayObservable.of;\n//# sourceMappingURL=of.js.map","\"use strict\";\nvar Observable_1 = require('../../Observable');\nvar of_1 = require('../../observable/of');\nObservable_1.Observable.of = of_1.of;\n//# sourceMappingURL=of.js.map","\r\n/**\r\n * Expose `Emitter`.\r\n */\r\n\r\nif (typeof module !== 'undefined') {\r\n  module.exports = Emitter;\r\n}\r\n\r\n/**\r\n * Initialize a new `Emitter`.\r\n *\r\n * @api public\r\n */\r\n\r\nfunction Emitter(obj) {\r\n  if (obj) return mixin(obj);\r\n};\r\n\r\n/**\r\n * Mixin the emitter properties.\r\n *\r\n * @param {Object} obj\r\n * @return {Object}\r\n * @api private\r\n */\r\n\r\nfunction mixin(obj) {\r\n  for (var key in Emitter.prototype) {\r\n    obj[key] = Emitter.prototype[key];\r\n  }\r\n  return obj;\r\n}\r\n\r\n/**\r\n * Listen on the given `event` with `fn`.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.on =\r\nEmitter.prototype.addEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\r\n    .push(fn);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Adds an `event` listener that will be invoked a single\r\n * time then automatically removed.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.once = function(event, fn){\r\n  function on() {\r\n    this.off(event, on);\r\n    fn.apply(this, arguments);\r\n  }\r\n\r\n  on.fn = fn;\r\n  this.on(event, on);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Remove the given callback for `event` or all\r\n * registered callbacks.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.off =\r\nEmitter.prototype.removeListener =\r\nEmitter.prototype.removeAllListeners =\r\nEmitter.prototype.removeEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n\r\n  // all\r\n  if (0 == arguments.length) {\r\n    this._callbacks = {};\r\n    return this;\r\n  }\r\n\r\n  // specific event\r\n  var callbacks = this._callbacks['$' + event];\r\n  if (!callbacks) return this;\r\n\r\n  // remove all handlers\r\n  if (1 == arguments.length) {\r\n    delete this._callbacks['$' + event];\r\n    return this;\r\n  }\r\n\r\n  // remove specific handler\r\n  var cb;\r\n  for (var i = 0; i < callbacks.length; i++) {\r\n    cb = callbacks[i];\r\n    if (cb === fn || cb.fn === fn) {\r\n      callbacks.splice(i, 1);\r\n      break;\r\n    }\r\n  }\r\n  return this;\r\n};\r\n\r\n/**\r\n * Emit `event` with the given args.\r\n *\r\n * @param {String} event\r\n * @param {Mixed} ...\r\n * @return {Emitter}\r\n */\r\n\r\nEmitter.prototype.emit = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n  var args = [].slice.call(arguments, 1)\r\n    , callbacks = this._callbacks['$' + event];\r\n\r\n  if (callbacks) {\r\n    callbacks = callbacks.slice(0);\r\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\r\n      callbacks[i].apply(this, args);\r\n    }\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Return array of callbacks for `event`.\r\n *\r\n * @param {String} event\r\n * @return {Array}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.listeners = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n  return this._callbacks['$' + event] || [];\r\n};\r\n\r\n/**\r\n * Check if this emitter has `event` handlers.\r\n *\r\n * @param {String} event\r\n * @return {Boolean}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.hasListeners = function(event){\r\n  return !! this.listeners(event).length;\r\n};\r\n","'use strict';\n\n/**\n * Return the mime type for the given `str`.\n *\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nexports.type = function(str){\n  return str.split(/ *; */).shift();\n};\n\n/**\n * Return header field parameters.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nexports.params = function(str){\n  return str.split(/ *; */).reduce(function(obj, str){\n    var parts = str.split(/ *= */);\n    var key = parts.shift();\n    var val = parts.shift();\n\n    if (key && val) obj[key] = val;\n    return obj;\n  }, {});\n};\n\n/**\n * Parse Link header fields.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nexports.parseLinks = function(str){\n  return str.split(/ *, */).reduce(function(obj, str){\n    var parts = str.split(/ *; */);\n    var url = parts[0].slice(1, -1);\n    var rel = parts[1].split(/ *= */)[1].slice(1, -1);\n    obj[rel] = url;\n    return obj;\n  }, {});\n};\n\n/**\n * Strip content related fields from `header`.\n *\n * @param {Object} header\n * @return {Object} header\n * @api private\n */\n\nexports.cleanHeader = function(header, changesOrigin){\n  delete header['content-type'];\n  delete header['content-length'];\n  delete header['transfer-encoding'];\n  delete header['host'];\n  // secuirty\n  if (changesOrigin) {\n    delete header['authorization'];\n    delete header['cookie'];\n  }\n  return header;\n};\n","/**\n * Root reference for iframes.\n */\n\nvar root;\nif (typeof window !== 'undefined') { // Browser window\n  root = window;\n} else if (typeof self !== 'undefined') { // Web Worker\n  root = self;\n} else { // Other environments\n  console.warn(\"Using browser-only version of superagent in non-browser environment\");\n  root = this;\n}\n\nvar Emitter = require('component-emitter');\nvar RequestBase = require('./request-base');\nvar isObject = require('./is-object');\nvar ResponseBase = require('./response-base');\nvar Agent = require('./agent-base');\n\n/**\n * Noop.\n */\n\nfunction noop(){};\n\n/**\n * Expose `request`.\n */\n\nvar request = exports = module.exports = function(method, url) {\n  // callback\n  if ('function' == typeof url) {\n    return new exports.Request('GET', method).end(url);\n  }\n\n  // url first\n  if (1 == arguments.length) {\n    return new exports.Request('GET', method);\n  }\n\n  return new exports.Request(method, url);\n}\n\nexports.Request = Request;\n\n/**\n * Determine XHR.\n */\n\nrequest.getXHR = function () {\n  if (root.XMLHttpRequest\n      && (!root.location || 'file:' != root.location.protocol\n          || !root.ActiveXObject)) {\n    return new XMLHttpRequest;\n  } else {\n    try { return new ActiveXObject('Microsoft.XMLHTTP'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.6.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.3.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP'); } catch(e) {}\n  }\n  throw Error(\"Browser-only version of superagent could not find XHR\");\n};\n\n/**\n * Removes leading and trailing whitespace, added to support IE.\n *\n * @param {String} s\n * @return {String}\n * @api private\n */\n\nvar trim = ''.trim\n  ? function(s) { return s.trim(); }\n  : function(s) { return s.replace(/(^\\s*|\\s*$)/g, ''); };\n\n/**\n * Serialize the given `obj`.\n *\n * @param {Object} obj\n * @return {String}\n * @api private\n */\n\nfunction serialize(obj) {\n  if (!isObject(obj)) return obj;\n  var pairs = [];\n  for (var key in obj) {\n    pushEncodedKeyValuePair(pairs, key, obj[key]);\n  }\n  return pairs.join('&');\n}\n\n/**\n * Helps 'serialize' with serializing arrays.\n * Mutates the pairs array.\n *\n * @param {Array} pairs\n * @param {String} key\n * @param {Mixed} val\n */\n\nfunction pushEncodedKeyValuePair(pairs, key, val) {\n  if (val != null) {\n    if (Array.isArray(val)) {\n      val.forEach(function(v) {\n        pushEncodedKeyValuePair(pairs, key, v);\n      });\n    } else if (isObject(val)) {\n      for(var subkey in val) {\n        pushEncodedKeyValuePair(pairs, key + '[' + subkey + ']', val[subkey]);\n      }\n    } else {\n      pairs.push(encodeURIComponent(key)\n        + '=' + encodeURIComponent(val));\n    }\n  } else if (val === null) {\n    pairs.push(encodeURIComponent(key));\n  }\n}\n\n/**\n * Expose serialization method.\n */\n\nrequest.serializeObject = serialize;\n\n/**\n  * Parse the given x-www-form-urlencoded `str`.\n  *\n  * @param {String} str\n  * @return {Object}\n  * @api private\n  */\n\nfunction parseString(str) {\n  var obj = {};\n  var pairs = str.split('&');\n  var pair;\n  var pos;\n\n  for (var i = 0, len = pairs.length; i < len; ++i) {\n    pair = pairs[i];\n    pos = pair.indexOf('=');\n    if (pos == -1) {\n      obj[decodeURIComponent(pair)] = '';\n    } else {\n      obj[decodeURIComponent(pair.slice(0, pos))] =\n        decodeURIComponent(pair.slice(pos + 1));\n    }\n  }\n\n  return obj;\n}\n\n/**\n * Expose parser.\n */\n\nrequest.parseString = parseString;\n\n/**\n * Default MIME type map.\n *\n *     superagent.types.xml = 'application/xml';\n *\n */\n\nrequest.types = {\n  html: 'text/html',\n  json: 'application/json',\n  xml: 'text/xml',\n  urlencoded: 'application/x-www-form-urlencoded',\n  'form': 'application/x-www-form-urlencoded',\n  'form-data': 'application/x-www-form-urlencoded'\n};\n\n/**\n * Default serialization map.\n *\n *     superagent.serialize['application/xml'] = function(obj){\n *       return 'generated xml here';\n *     };\n *\n */\n\nrequest.serialize = {\n  'application/x-www-form-urlencoded': serialize,\n  'application/json': JSON.stringify,\n};\n\n/**\n  * Default parsers.\n  *\n  *     superagent.parse['application/xml'] = function(str){\n  *       return { object parsed from str };\n  *     };\n  *\n  */\n\nrequest.parse = {\n  'application/x-www-form-urlencoded': parseString,\n  'application/json': JSON.parse,\n};\n\n/**\n * Parse the given header `str` into\n * an object containing the mapped fields.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction parseHeader(str) {\n  var lines = str.split(/\\r?\\n/);\n  var fields = {};\n  var index;\n  var line;\n  var field;\n  var val;\n\n  for (var i = 0, len = lines.length; i < len; ++i) {\n    line = lines[i];\n    index = line.indexOf(':');\n    if (index === -1) { // could be empty line, just skip it\n      continue;\n    }\n    field = line.slice(0, index).toLowerCase();\n    val = trim(line.slice(index + 1));\n    fields[field] = val;\n  }\n\n  return fields;\n}\n\n/**\n * Check if `mime` is json or has +json structured syntax suffix.\n *\n * @param {String} mime\n * @return {Boolean}\n * @api private\n */\n\nfunction isJSON(mime) {\n  // should match /json or +json\n  // but not /json-seq\n  return /[\\/+]json($|[^-\\w])/.test(mime);\n}\n\n/**\n * Initialize a new `Response` with the given `xhr`.\n *\n *  - set flags (.ok, .error, etc)\n *  - parse header\n *\n * Examples:\n *\n *  Aliasing `superagent` as `request` is nice:\n *\n *      request = superagent;\n *\n *  We can use the promise-like API, or pass callbacks:\n *\n *      request.get('/').end(function(res){});\n *      request.get('/', function(res){});\n *\n *  Sending data can be chained:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' })\n *        .end(function(res){});\n *\n *  Or passed to `.send()`:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' }, function(res){});\n *\n *  Or passed to `.post()`:\n *\n *      request\n *        .post('/user', { name: 'tj' })\n *        .end(function(res){});\n *\n * Or further reduced to a single call for simple cases:\n *\n *      request\n *        .post('/user', { name: 'tj' }, function(res){});\n *\n * @param {XMLHTTPRequest} xhr\n * @param {Object} options\n * @api private\n */\n\nfunction Response(req) {\n  this.req = req;\n  this.xhr = this.req.xhr;\n  // responseText is accessible only if responseType is '' or 'text' and on older browsers\n  this.text = ((this.req.method !='HEAD' && (this.xhr.responseType === '' || this.xhr.responseType === 'text')) || typeof this.xhr.responseType === 'undefined')\n     ? this.xhr.responseText\n     : null;\n  this.statusText = this.req.xhr.statusText;\n  var status = this.xhr.status;\n  // handle IE9 bug: http://stackoverflow.com/questions/10046972/msie-returns-status-code-of-1223-for-ajax-request\n  if (status === 1223) {\n    status = 204;\n  }\n  this._setStatusProperties(status);\n  this.header = this.headers = parseHeader(this.xhr.getAllResponseHeaders());\n  // getAllResponseHeaders sometimes falsely returns \"\" for CORS requests, but\n  // getResponseHeader still works. so we get content-type even if getting\n  // other headers fails.\n  this.header['content-type'] = this.xhr.getResponseHeader('content-type');\n  this._setHeaderProperties(this.header);\n\n  if (null === this.text && req._responseType) {\n    this.body = this.xhr.response;\n  } else {\n    this.body = this.req.method != 'HEAD'\n      ? this._parseBody(this.text ? this.text : this.xhr.response)\n      : null;\n  }\n}\n\nResponseBase(Response.prototype);\n\n/**\n * Parse the given body `str`.\n *\n * Used for auto-parsing of bodies. Parsers\n * are defined on the `superagent.parse` object.\n *\n * @param {String} str\n * @return {Mixed}\n * @api private\n */\n\nResponse.prototype._parseBody = function(str) {\n  var parse = request.parse[this.type];\n  if (this.req._parser) {\n    return this.req._parser(this, str);\n  }\n  if (!parse && isJSON(this.type)) {\n    parse = request.parse['application/json'];\n  }\n  return parse && str && (str.length || str instanceof Object)\n    ? parse(str)\n    : null;\n};\n\n/**\n * Return an `Error` representative of this response.\n *\n * @return {Error}\n * @api public\n */\n\nResponse.prototype.toError = function(){\n  var req = this.req;\n  var method = req.method;\n  var url = req.url;\n\n  var msg = 'cannot ' + method + ' ' + url + ' (' + this.status + ')';\n  var err = new Error(msg);\n  err.status = this.status;\n  err.method = method;\n  err.url = url;\n\n  return err;\n};\n\n/**\n * Expose `Response`.\n */\n\nrequest.Response = Response;\n\n/**\n * Initialize a new `Request` with the given `method` and `url`.\n *\n * @param {String} method\n * @param {String} url\n * @api public\n */\n\nfunction Request(method, url) {\n  var self = this;\n  this._query = this._query || [];\n  this.method = method;\n  this.url = url;\n  this.header = {}; // preserves header name case\n  this._header = {}; // coerces header names to lowercase\n  this.on('end', function(){\n    var err = null;\n    var res = null;\n\n    try {\n      res = new Response(self);\n    } catch(e) {\n      err = new Error('Parser is unable to parse the response');\n      err.parse = true;\n      err.original = e;\n      // issue #675: return the raw response if the response parsing fails\n      if (self.xhr) {\n        // ie9 doesn't have 'response' property\n        err.rawResponse = typeof self.xhr.responseType == 'undefined' ? self.xhr.responseText : self.xhr.response;\n        // issue #876: return the http status code if the response parsing fails\n        err.status = self.xhr.status ? self.xhr.status : null;\n        err.statusCode = err.status; // backwards-compat only\n      } else {\n        err.rawResponse = null;\n        err.status = null;\n      }\n\n      return self.callback(err);\n    }\n\n    self.emit('response', res);\n\n    var new_err;\n    try {\n      if (!self._isResponseOK(res)) {\n        new_err = new Error(res.statusText || 'Unsuccessful HTTP response');\n      }\n    } catch(custom_err) {\n      new_err = custom_err; // ok() callback can throw\n    }\n\n    // #1000 don't catch errors from the callback to avoid double calling it\n    if (new_err) {\n      new_err.original = err;\n      new_err.response = res;\n      new_err.status = res.status;\n      self.callback(new_err, res);\n    } else {\n      self.callback(null, res);\n    }\n  });\n}\n\n/**\n * Mixin `Emitter` and `RequestBase`.\n */\n\nEmitter(Request.prototype);\nRequestBase(Request.prototype);\n\n/**\n * Set Content-Type to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.xml = 'application/xml';\n *\n *      request.post('/')\n *        .type('xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n *      request.post('/')\n *        .type('application/xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n * @param {String} type\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.type = function(type){\n  this.set('Content-Type', request.types[type] || type);\n  return this;\n};\n\n/**\n * Set Accept to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.json = 'application/json';\n *\n *      request.get('/agent')\n *        .accept('json')\n *        .end(callback);\n *\n *      request.get('/agent')\n *        .accept('application/json')\n *        .end(callback);\n *\n * @param {String} accept\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.accept = function(type){\n  this.set('Accept', request.types[type] || type);\n  return this;\n};\n\n/**\n * Set Authorization field value with `user` and `pass`.\n *\n * @param {String} user\n * @param {String} [pass] optional in case of using 'bearer' as type\n * @param {Object} options with 'type' property 'auto', 'basic' or 'bearer' (default 'basic')\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.auth = function(user, pass, options){\n  if (1 === arguments.length) pass = '';\n  if (typeof pass === 'object' && pass !== null) { // pass is optional and can be replaced with options\n    options = pass;\n    pass = '';\n  }\n  if (!options) {\n    options = {\n      type: 'function' === typeof btoa ? 'basic' : 'auto',\n    };\n  }\n\n  var encoder = function(string) {\n    if ('function' === typeof btoa) {\n      return btoa(string);\n    }\n    throw new Error('Cannot use basic auth, btoa is not a function');\n  };\n\n  return this._auth(user, pass, options, encoder);\n};\n\n/**\n * Add query-string `val`.\n *\n * Examples:\n *\n *   request.get('/shoes')\n *     .query('size=10')\n *     .query({ color: 'blue' })\n *\n * @param {Object|String} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.query = function(val){\n  if ('string' != typeof val) val = serialize(val);\n  if (val) this._query.push(val);\n  return this;\n};\n\n/**\n * Queue the given `file` as an attachment to the specified `field`,\n * with optional `options` (or filename).\n *\n * ``` js\n * request.post('/upload')\n *   .attach('content', new Blob(['<a id=\"a\"><b id=\"b\">hey!</b></a>'], { type: \"text/html\"}))\n *   .end(callback);\n * ```\n *\n * @param {String} field\n * @param {Blob|File} file\n * @param {String|Object} options\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.attach = function(field, file, options){\n  if (file) {\n    if (this._data) {\n      throw Error(\"superagent can't mix .send() and .attach()\");\n    }\n\n    this._getFormData().append(field, file, options || file.name);\n  }\n  return this;\n};\n\nRequest.prototype._getFormData = function(){\n  if (!this._formData) {\n    this._formData = new root.FormData();\n  }\n  return this._formData;\n};\n\n/**\n * Invoke the callback with `err` and `res`\n * and handle arity check.\n *\n * @param {Error} err\n * @param {Response} res\n * @api private\n */\n\nRequest.prototype.callback = function(err, res){\n  if (this._shouldRetry(err, res)) {\n    return this._retry();\n  }\n\n  var fn = this._callback;\n  this.clearTimeout();\n\n  if (err) {\n    if (this._maxRetries) err.retries = this._retries - 1;\n    this.emit('error', err);\n  }\n\n  fn(err, res);\n};\n\n/**\n * Invoke callback with x-domain error.\n *\n * @api private\n */\n\nRequest.prototype.crossDomainError = function(){\n  var err = new Error('Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.');\n  err.crossDomain = true;\n\n  err.status = this.status;\n  err.method = this.method;\n  err.url = this.url;\n\n  this.callback(err);\n};\n\n// This only warns, because the request is still likely to work\nRequest.prototype.buffer = Request.prototype.ca = Request.prototype.agent = function(){\n  console.warn(\"This is not supported in browser version of superagent\");\n  return this;\n};\n\n// This throws, because it can't send/receive data as expected\nRequest.prototype.pipe = Request.prototype.write = function(){\n  throw Error(\"Streaming is not supported in browser version of superagent\");\n};\n\n/**\n * Check if `obj` is a host object,\n * we don't want to serialize these :)\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\nRequest.prototype._isHost = function _isHost(obj) {\n  // Native objects stringify to [object File], [object Blob], [object FormData], etc.\n  return obj && 'object' === typeof obj && !Array.isArray(obj) && Object.prototype.toString.call(obj) !== '[object Object]';\n}\n\n/**\n * Initiate request, invoking callback `fn(res)`\n * with an instanceof `Response`.\n *\n * @param {Function} fn\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.end = function(fn){\n  if (this._endCalled) {\n    console.warn(\"Warning: .end() was called twice. This is not supported in superagent\");\n  }\n  this._endCalled = true;\n\n  // store callback\n  this._callback = fn || noop;\n\n  // querystring\n  this._finalizeQueryString();\n\n  return this._end();\n};\n\nRequest.prototype._end = function() {\n  var self = this;\n  var xhr = (this.xhr = request.getXHR());\n  var data = this._formData || this._data;\n\n  this._setTimeouts();\n\n  // state change\n  xhr.onreadystatechange = function(){\n    var readyState = xhr.readyState;\n    if (readyState >= 2 && self._responseTimeoutTimer) {\n      clearTimeout(self._responseTimeoutTimer);\n    }\n    if (4 != readyState) {\n      return;\n    }\n\n    // In IE9, reads to any property (e.g. status) off of an aborted XHR will\n    // result in the error \"Could not complete the operation due to error c00c023f\"\n    var status;\n    try { status = xhr.status } catch(e) { status = 0; }\n\n    if (!status) {\n      if (self.timedout || self._aborted) return;\n      return self.crossDomainError();\n    }\n    self.emit('end');\n  };\n\n  // progress\n  var handleProgress = function(direction, e) {\n    if (e.total > 0) {\n      e.percent = e.loaded / e.total * 100;\n    }\n    e.direction = direction;\n    self.emit('progress', e);\n  };\n  if (this.hasListeners('progress')) {\n    try {\n      xhr.onprogress = handleProgress.bind(null, 'download');\n      if (xhr.upload) {\n        xhr.upload.onprogress = handleProgress.bind(null, 'upload');\n      }\n    } catch(e) {\n      // Accessing xhr.upload fails in IE from a web worker, so just pretend it doesn't exist.\n      // Reported here:\n      // https://connect.microsoft.com/IE/feedback/details/837245/xmlhttprequest-upload-throws-invalid-argument-when-used-from-web-worker-context\n    }\n  }\n\n  // initiate request\n  try {\n    if (this.username && this.password) {\n      xhr.open(this.method, this.url, true, this.username, this.password);\n    } else {\n      xhr.open(this.method, this.url, true);\n    }\n  } catch (err) {\n    // see #1149\n    return this.callback(err);\n  }\n\n  // CORS\n  if (this._withCredentials) xhr.withCredentials = true;\n\n  // body\n  if (!this._formData && 'GET' != this.method && 'HEAD' != this.method && 'string' != typeof data && !this._isHost(data)) {\n    // serialize stuff\n    var contentType = this._header['content-type'];\n    var serialize = this._serializer || request.serialize[contentType ? contentType.split(';')[0] : ''];\n    if (!serialize && isJSON(contentType)) {\n      serialize = request.serialize['application/json'];\n    }\n    if (serialize) data = serialize(data);\n  }\n\n  // set header fields\n  for (var field in this.header) {\n    if (null == this.header[field]) continue;\n\n    if (this.header.hasOwnProperty(field))\n      xhr.setRequestHeader(field, this.header[field]);\n  }\n\n  if (this._responseType) {\n    xhr.responseType = this._responseType;\n  }\n\n  // send stuff\n  this.emit('request', this);\n\n  // IE11 xhr.send(undefined) sends 'undefined' string as POST payload (instead of nothing)\n  // We need null here if data is undefined\n  xhr.send(typeof data !== 'undefined' ? data : null);\n  return this;\n};\n\nrequest.agent = function() {\n  return new Agent();\n};\n\n[\"GET\", \"POST\", \"OPTIONS\", \"PATCH\", \"PUT\", \"DELETE\"].forEach(function(method) {\n  Agent.prototype[method.toLowerCase()] = function(url, fn) {\n    var req = new request.Request(method, url);\n    this._setDefaults(req);\n    if (fn) {\n      req.end(fn);\n    }\n    return req;\n  };\n});\n\nAgent.prototype.del = Agent.prototype['delete'];\n\n/**\n * GET `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} [data] or fn\n * @param {Function} [fn]\n * @return {Request}\n * @api public\n */\n\nrequest.get = function(url, data, fn) {\n  var req = request('GET', url);\n  if ('function' == typeof data) (fn = data), (data = null);\n  if (data) req.query(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * HEAD `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} [data] or fn\n * @param {Function} [fn]\n * @return {Request}\n * @api public\n */\n\nrequest.head = function(url, data, fn) {\n  var req = request('HEAD', url);\n  if ('function' == typeof data) (fn = data), (data = null);\n  if (data) req.query(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * OPTIONS query to `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} [data] or fn\n * @param {Function} [fn]\n * @return {Request}\n * @api public\n */\n\nrequest.options = function(url, data, fn) {\n  var req = request('OPTIONS', url);\n  if ('function' == typeof data) (fn = data), (data = null);\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * DELETE `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} [data]\n * @param {Function} [fn]\n * @return {Request}\n * @api public\n */\n\nfunction del(url, data, fn) {\n  var req = request('DELETE', url);\n  if ('function' == typeof data) (fn = data), (data = null);\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n}\n\nrequest['del'] = del;\nrequest['delete'] = del;\n\n/**\n * PATCH `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} [data]\n * @param {Function} [fn]\n * @return {Request}\n * @api public\n */\n\nrequest.patch = function(url, data, fn) {\n  var req = request('PATCH', url);\n  if ('function' == typeof data) (fn = data), (data = null);\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * POST `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} [data]\n * @param {Function} [fn]\n * @return {Request}\n * @api public\n */\n\nrequest.post = function(url, data, fn) {\n  var req = request('POST', url);\n  if ('function' == typeof data) (fn = data), (data = null);\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * PUT `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} [data] or fn\n * @param {Function} [fn]\n * @return {Request}\n * @api public\n */\n\nrequest.put = function(url, data, fn) {\n  var req = request('PUT', url);\n  if ('function' == typeof data) (fn = data), (data = null);\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n","import {\n  RequestInterceptor,\n  ResponseInterceptor,\n  ErrorInterceptor\n} from './interfaces'\nimport { RxRestItem } from './index'\nimport { BodyParam } from './interfaces'\nimport { objectToMap } from './utils'\nimport { fetch } from './fetch';\n\nexport interface RequestBodyHandler<T> {\n  (body: BodyParam<T>): FormData|URLSearchParams|Body|Blob|undefined|string|Promise<any>\n}\n\nexport interface ResponseBodyHandler {\n  (body: Response): Promise<any>\n}\n\n/**\n * RxRestConfiguration\n */\nexport class RxRestConfiguration {\n  private $baseURL: string\n  private $headers: Headers = new Headers()\n  private $queryParams: URLSearchParams = new URLSearchParams()\n  public identifier: string = 'id'\n  public requestInterceptors: RequestInterceptor[] = []\n  public responseInterceptors: ResponseInterceptor[] = []\n  public errorInterceptors: ErrorInterceptor[] = []\n  public fetch: any\n  public abortCallback: (req: Request) => void = () => null\n  public uuid: boolean = false\n\n  constructor() {\n      this.fetch = fetch\n  }\n\n  /**\n   * requestBodyHandler\n   * JSONify the body if it's an `RxRestItem` or an `Object`\n   *\n   * @param {FormData|URLSearchParams|Body|Blob|undefined} body\n   * @returns {any}\n   */\n  _requestBodyHandler(body: FormData|URLSearchParams|Body|Blob|undefined):\n    FormData|URLSearchParams|Body|Blob|undefined|string|Promise<any> {\n    if (!body) {\n      return undefined\n    }\n\n    if (body instanceof FormData || body instanceof URLSearchParams) {\n      return body\n    }\n\n    return body instanceof RxRestItem ? body.json() : JSON.stringify(body)\n  }\n\n  /**\n   * responseBodyHandler\n   * transforms the response to a json object\n   *\n   * @param {Response} body\n   * @reject when response is an error\n   * @returns {Promise<any>}\n   */\n  _responseBodyHandler(body: Response): Promise<{body: any, metadata: any}> {\n    return body.text()\n    .then(text => {\n      return {body: text ? JSON.parse(text) : null, metadata: null}\n    })\n  }\n\n  get responseBodyHandler(): ResponseBodyHandler {\n    return this._responseBodyHandler\n  }\n\n  set responseBodyHandler(responseBodyHandler: ResponseBodyHandler) {\n    this._responseBodyHandler = responseBodyHandler\n  }\n\n  get requestBodyHandler(): RequestBodyHandler<any> {\n    return this._requestBodyHandler\n  }\n\n  set requestBodyHandler(requestBodyHandler: RequestBodyHandler<any>) {\n    this._requestBodyHandler = requestBodyHandler\n  }\n\n  /**\n   * set baseURL\n   *\n   * @param {String} base\n   * @returns\n   */\n  set baseURL(base: string) {\n    if (base.charAt(base.length - 1) !== '/') {\n      base += '/'\n    }\n\n    this.$baseURL = base\n  }\n\n  /**\n   * get baseURL\n   *\n   * @returns {string}\n   */\n  get baseURL(): string {\n    return this.$baseURL\n  }\n\n  /**\n   * Set global query params\n   * @param {Object|URLSearchParams} params\n   */\n  set queryParams(params: any) {\n    if (params instanceof URLSearchParams) {\n      this.$queryParams = params\n      return\n    }\n\n    if (typeof params === 'string') {\n      this.$queryParams = new URLSearchParams(params)\n      return\n    }\n\n    this.$queryParams = objectToMap(new URLSearchParams(), params)\n  }\n\n  /**\n   * Get global query params\n   * @return {URLSearchParams}\n   */\n  get queryParams(): any {\n    return this.$queryParams\n  }\n\n  /**\n   * set global headers\n   * @param {Object|Headers} params\n   */\n  set headers(params: any) {\n     if (params instanceof Headers) {\n      this.$headers = params\n      return\n    }\n\n    this.$headers = objectToMap(new Headers(), params)\n }\n\n  /**\n   * Get global headers\n   * @return Headers\n   */\n  get headers(): any {\n    return this.$headers\n  }\n}\n","import './rxjs'\nimport { RxRestConfiguration } from './RxRestConfiguration'\nimport {\n  RequestInterceptor,\n  ResponseInterceptor,\n  ErrorInterceptor,\n  ErrorResponse,\n  BodyParam\n} from './interfaces'\nimport { RxRestCollection, RxRestItem } from './index'\nimport { Observable } from 'rxjs/Observable'\nimport { Observer } from 'rxjs/Observer'\n\nimport { objectToMap, uuid } from './utils'\n\nconst fromPromise = function(promise: Promise<any>) {\n  return Observable.create((observer: Observer<any>) => {\n    promise\n    .then((v) => {\n      observer.next(v)\n      observer.complete()\n    })\n    .catch(observer.error)\n  })\n}\n\nexport class RxRest<F, T> {\n  protected $route: string[]\n  $fromServer: boolean = false\n  $asIterable: boolean = true\n  $queryParams: URLSearchParams = new URLSearchParams()\n  $headers: Headers = new Headers()\n  config: RxRestConfiguration\n  $metadata: any\n  $pristine: boolean = true\n  $uuid?: string;\n\n  /**\n   * constructor\n   *\n   * @param {String} [route] the resource route\n   */\n  constructor(\n    config: RxRestConfiguration = new RxRestConfiguration(),\n    route?: string[],\n    metadata?: any\n  ) {\n    this.$route = route === undefined ? [] : [...route]\n    this.config = config\n    this.$metadata = metadata\n    if (config.uuid) {\n      this.$uuid = uuid()\n    }\n  }\n\n  protected addRoute(route: string): void {\n    this.$route.push.apply(this.$route, route.split('/'))\n  }\n\n  /**\n   * one\n   *\n   * @param {String} route\n   * @param {any} id\n   * @returns {RxRestItem}\n   */\n  one<T>(route: string, id?: any): RxRestItem<T> {\n    this.addRoute(route)\n    let o = {} as T\n    if (id) {\n      o[this.config.identifier] = id\n    }\n\n    return new RxRestItem<T>(this.$route, o, this.config)\n  }\n\n  /**\n   * all\n   *\n   * @param {String} route\n   * @param {boolean} [asIterable=true] - forces the next request to return an Observable<Array>\n   *                               instead of emitting multiple events\n   * @returns {RxRestCollection}\n   */\n  all<T>(route: string, asIterable: boolean = true): RxRestCollection<T> {\n    this.addRoute(route)\n    return new RxRestCollection<T>(this.$route, undefined, this.config, null, asIterable)\n  }\n\n  /**\n   * asIterable - sets the flag $asIterable\n   * instead of emitting multiple events\n   *\n   * @returns {self}\n   */\n  asIterable(value = true): this {\n    this.$asIterable = value\n    return this\n  }\n\n  /**\n   * fromObject\n   *\n   * @param {String} route\n   * @param {Object|Object[]} element\n   * @returns {RxRestItem|RxRestCollection}\n   */\n  fromObject<T>(route: string, element: T|T[]): RxRestItem<T>|RxRestCollection<T> {\n    this.addRoute(route)\n    if (Array.isArray(element)) {\n      return new RxRestCollection<T>(this.$route, element, this.config)\n    }\n\n    return new RxRestItem<T>(this.$route, element, this.config)\n  }\n\n  /**\n   * @access private\n   * @param {BodyParam} body\n   * @return {BodyParam|RxRestItem}\n   */\n  protected withBody(body: BodyParam<T>) {\n    return body ? body : this\n  }\n\n  /**\n   * post\n   *\n   * @param {Body|Blob|FormData|URLSearchParams|Object|RxRestItem} [body]\n   * @param {Object|URLSearchParams} [queryParams]\n   * @param {Object|Headers} [headers]\n   * @returns {Observable<RxRestItem|RxRestCollection>}\n   */\n  post(body?: BodyParam<T>, queryParams?: Object|URLSearchParams, headers?: Object|Headers):\n    Observable<F> {\n    this.queryParams = queryParams\n    this.headers = headers\n\n    return this.request('POST', this.withBody(body))\n  }\n\n  /**\n   * remove\n   *\n   * @param {Object|URLSearchParams} [queryParams]\n   * @param {Object|Headers} [headers]\n   * @returns {Observable<RxRestItem|RxRestCollection>}\n   */\n  remove(queryParams?: Object|URLSearchParams, headers?: Object|Headers):\n    Observable<F> {\n    this.queryParams = queryParams\n    this.headers = headers\n\n    return this.request('DELETE')\n  }\n\n  /**\n   * get\n   *\n   * @param {Object|URLSearchParams} [queryParams]\n   * @param {Object|Headers} [headers]\n   * @returns {Observable<RxRestItem|RxRestCollection>}\n   */\n  get(queryParams?: Object|URLSearchParams, headers?: Object|Headers):\n    Observable<F> {\n    this.queryParams = queryParams\n    this.headers = headers\n\n    return this.request('GET')\n  }\n\n  /**\n   * put\n   *\n   * @param {Body|Blob|FormData|URLSearchParams|Object|RxRestItem} [body]\n   * @param {Object|URLSearchParams} [queryParams]\n   * @param {Object|Headers} [headers]\n   * @returns {Observable<RxRestItem|RxRestCollection>}\n   */\n  put(body?: BodyParam<T>, queryParams?: Object|URLSearchParams, headers?: Object|Headers):\n    Observable<F> {\n    this.queryParams = queryParams\n    this.headers = headers\n\n    return this.request('PUT', this.withBody(body))\n  }\n\n  /**\n   * patch\n   *\n   * @param {Body|Blob|FormData|URLSearchParams|Object|RxRestItem} [body]\n   * @param {Object|URLSearchParams} [queryParams]\n   * @param {Object|Headers} [headers]\n   * @returns {Observable<RxRestItem|RxRestCollection>}\n   */\n  patch(body?: BodyParam<T>, queryParams?: Object|URLSearchParams, headers?: Object|Headers):\n    Observable<F> {\n    this.queryParams = queryParams\n    this.headers = headers\n\n    return this.request('PATCH', this.withBody(body))\n  }\n\n  /**\n   * head\n   *\n   * @param {Object|URLSearchParams} [queryParams]\n   * @param {Object|Headers} [headers]\n   * @returns {Observable<RxRestItem|RxRestCollection>}\n   */\n  head(queryParams?: Object|URLSearchParams, headers?: Object|Headers):\n    Observable<F> {\n    this.queryParams = queryParams\n    this.headers = headers\n\n    return this.request('HEAD')\n  }\n\n  /**\n   * trace\n   *\n   * @param {Object|URLSearchParams} [queryParams]\n   * @param {Object|Headers} [headers]\n   * @returns {Observable<RxRestItem|RxRestCollection>}\n   */\n  trace(queryParams?: Object|URLSearchParams, headers?: Object|Headers):\n    Observable<F> {\n    this.queryParams = queryParams\n    this.headers = headers\n\n    return this.request('TRACE')\n  }\n\n  /**\n   * options\n   *\n   * @param {Object|URLSearchParams} [queryParams]\n   * @param {Object|Headers} [headers]\n   * @returns {Observable<RxRestItem|RxRestCollection>}\n   */\n  options(queryParams?: Object|URLSearchParams, headers?: Object|Headers):\n    Observable<F> {\n    this.queryParams = queryParams\n    this.headers = headers\n\n    return this.request('OPTIONS')\n  }\n\n  /**\n   * URL\n   *\n   * @returns {string}\n   */\n  get URL(): string {\n    return `${this.config.baseURL}${this.$route.join('/')}`\n  }\n\n  /**\n   * set local query params\n   * @param {Object|URLSearchParams} params\n   */\n  set queryParams(params: any) {\n    if (!params) {\n      return\n    }\n\n    if (params instanceof URLSearchParams) {\n      this.$queryParams = params\n      return\n    }\n\n    this.$queryParams = objectToMap(new URLSearchParams(), params)\n  }\n\n  /**\n   * Sets local query params useful to add params to a custom request\n   * @param {Object|URLSearchParams}\n   * @return this\n   */\n  setQueryParams(params: any): this {\n    this.queryParams = params\n    return this\n  }\n\n  /**\n   * Sets local headers useful to add headers to a custom request\n   * @param {Object|URLSearchParams}\n   * @return this\n   */\n  setHeaders(params: any): this {\n    this.headers = params\n    return this\n  }\n\n  /**\n   * Get local query params\n   * @return URLSearchParams\n   */\n  get queryParams(): any {\n    return this.$queryParams\n  }\n\n  /**\n   * Get request query params\n   * Combine local and global query params\n   * Local query params are overriding global params\n   * @return {String}\n   */\n  get requestQueryParams(): string {\n    let params = new URLSearchParams()\n\n    for (let param of this.config.queryParams) {\n      params.append(param[0], param[1])\n    }\n\n    for (let param of this.queryParams) {\n      params.append(param[0], param[1])\n    }\n\n    let str = params.toString()\n\n    if (str.length) {\n      return '?' + str\n    }\n\n    return ''\n  }\n\n  /**\n   * Set local headers\n   * @param {Object|Headers} params\n   */\n  set headers(params: any) {\n    if (!params) {\n      return\n    }\n\n     if (params instanceof Headers) {\n      this.$headers = params\n      return\n    }\n\n    this.$headers = objectToMap(new Headers(), params)\n }\n\n  /**\n   * Get local headers\n   * @return Headers\n   */\n  get headers(): any {\n    return this.$headers\n  }\n\n  /**\n   * get request Headers\n   * Combine local and global headers\n   * Local headers are overriding global headers\n   *\n   * @returns {Headers}\n   */\n  get requestHeaders(): Headers {\n    let headers = new Headers()\n\n    for (let header of this.headers) {\n      headers.append(header[0], header[1])\n    }\n\n    for (let header of this.config.headers) {\n      headers.append(header[0], header[1])\n    }\n\n    return headers\n  }\n\n  /**\n   * expandInterceptors\n   *\n   * @param {RequestInterceptor[]|ResponseInterceptor[]|ErrorInterceptor[]} interceptors\n   * @returns {Observable<any>} fn\n   */\n  private expandInterceptors(\n    interceptors: RequestInterceptor[]|ResponseInterceptor[]|ErrorInterceptor[]\n  ) {\n    return function(origin: any): Observable<any> {\n      return (<any>interceptors).reduce(\n        (obs: Observable<any>, interceptor: any) =>\n          obs.concatMap(value => {\n            let result = interceptor(value)\n            if (result === undefined) {\n              return Observable.of(value)\n            }\n\n            if (result instanceof Promise) {\n              return fromPromise(result)\n            }\n\n            if (result instanceof Observable) {\n              return result\n            }\n\n            return Observable.of(result)\n          }),\n        Observable.of(origin)\n      )\n    }\n  }\n\n  /**\n   * request\n   *\n   * @param {string} method\n   * @param {RxRestItem|FormData|URLSearchParams|Body|Blob|undefined|Object} [body]\n   * @returns {Observable<RxRestItem|RxRestCollection>}\n   */\n  request(method: string, body?: BodyParam<T>): Observable<F> {\n    let requestOptions = {\n      method: method,\n      headers: <Headers> this.requestHeaders,\n      body: this.config.requestBodyHandler(body)\n    }\n\n    let request = new Request(this.URL + this.requestQueryParams, requestOptions);\n\n    let stream = <Observable<F>> Observable.of(request)\n    .mergeMap(this.expandInterceptors(this.config.requestInterceptors))\n    .mergeMap(request => this.config.fetch(request, null, this.config.abortCallback))\n    .mergeMap(this.expandInterceptors(this.config.responseInterceptors))\n    .mergeMap(body => fromPromise(this.config.responseBodyHandler(body)))\n    .mergeMap(({body, metadata}) => {\n      if (!Array.isArray(body)) {\n        let item: RxRestItem<T>\n        if (this instanceof RxRestItem) {\n          item = this\n          item.element = body as T\n          item.$metadata = metadata\n        } else {\n          item = new RxRestItem<T>(this.$route, body, this.config, metadata)\n        }\n\n        item.$fromServer = true\n        item.$pristine = true\n\n        return Observable.create((observer: Observer<RxRestItem<T>>) => {\n          observer.next(item)\n          observer.complete()\n        })\n      }\n\n      let collection = new RxRestCollection<T>(this.$route, body.map((e: T) => {\n        let item = new RxRestItem<T>(this.$route, e, this.config, metadata)\n        item.$fromServer = true\n        item.$pristine = true\n        return item\n      }), this.config, metadata)\n\n      collection.$pristine = true\n\n      return Observable.create((observer: Observer<RxRestItem<T>|RxRestCollection<T>>) => {\n        if (this.$asIterable) {\n          observer.next(collection)\n        } else {\n          for (let item of collection) {\n            observer.next(item)\n          }\n        }\n\n        observer.complete()\n      })\n    })\n    .catch((body) => {\n      return Observable.of(body)\n      .mergeMap(this.expandInterceptors(this.config.errorInterceptors))\n      .mergeMap((body: ErrorResponse) => {\n        return Observable.throw(body)\n      })\n    })\n\n    return stream\n  }\n}\n","import { Observable } from 'rxjs/Observable'\nimport { RxRestProxyHandler } from './RxRestProxyHandler'\nimport { RxRest as AbstractRxRest } from './RxRest'\nimport { RxRestConfiguration } from './RxRestConfiguration';\n\nexport class RxRestItem<T> extends AbstractRxRest<RxRestItem<T> & T, T> {\n  $element: T = {} as T;\n\n  /**\n   * constructor\n   *\n   * @param {string[]} route\n   * @param {T} [element]\n   * @return {Proxy}\n   */\n  constructor(route: string[], element?: T, config?: RxRestConfiguration, metadata?: any) {\n    super(config, route, metadata)\n\n    if (element !== undefined) {\n      this.element = element\n    }\n\n    const proxy = new Proxy(this.$element, new RxRestProxyHandler<RxRestItem<T>, T>(this))\n\n    return <RxRestItem<T> & T> proxy\n  }\n\n  /**\n   * save - POST or PUT according to $fromServer value\n   *\n   * @param {Object|URLSearchParams} [queryParams]\n   * @param {Object|Headers} [headers]\n   * @returns {Observable<RxRestItem|RxRestCollection>}\n   */\n  save(queryParams?: Object|URLSearchParams, headers?: Object|Headers):\n    Observable<RxRestItem<T>|RxRestCollection<T>> {\n    this.queryParams = queryParams\n    this.headers = headers\n\n    return this.request(this.$fromServer === true ? 'PUT' : 'POST', this)\n  }\n\n  /**\n   * set element\n   *\n   * @param {T} element\n   */\n  set element(element: T) {\n    for (let i in element) {\n      if (i === this.config.identifier && !this.$element[this.config.identifier]) {\n        this.$route.push('' + element[i])\n      }\n\n      this.$element[i] = element[i]\n    }\n  }\n\n  /**\n   * get element\n   *\n   * @return {T}\n   */\n  get element(): T {\n    return this.$element\n  }\n\n  /**\n   * get plain object\n   *\n   * @return {T}\n   */\n  plain(): T {\n    return this.element\n  }\n\n  /**\n   * Get json string\n   * @return {string}\n   */\n  json(): string {\n    return JSON.stringify(this.plain())\n  }\n\n  /**\n   * Clone\n   * @return {RxRestItem<T>}\n   */\n  clone(): RxRestItem<T> & T {\n    let route = this.$route\n\n    if (this.$element[this.config.identifier]) {\n      route = route.slice(0, this.$route.length - 1)\n    }\n\n    let clone = new RxRestItem(route, this.$element, this.config)\n    clone.$fromServer = this.$fromServer\n    return clone as RxRestItem<T> & T\n  }\n}\n\nexport class RxRestCollection<T> extends AbstractRxRest<RxRestCollection<T> & T[] & T, T>\n  implements Iterable<RxRestItem<T>> {\n  length: number;\n  $elements: RxRestItem<T>[] = [];\n  [index: number]: RxRestItem<T>;\n\n  /**\n   * constructor\n   *\n   * @param {string[]} route\n   * @param {T[]|RxRestItem<T>[]]} [elements]\n   * @return {Proxy}\n   */\n  constructor(\n    route: string[],\n    elements?: T[]|RxRestItem<T>[],\n    config?: RxRestConfiguration,\n    metadata?: any,\n    asIterable: boolean = true\n  ) {\n    super(config, route, metadata)\n\n    if (elements !== undefined) {\n      this.elements = (elements as any).map((e: any) =>\n        e instanceof RxRestItem ? e.clone() : new RxRestItem(this.$route, e)\n      )\n    }\n\n    this.$asIterable = asIterable\n\n    const proxy = new Proxy(this.$elements, new RxRestProxyHandler<RxRestCollection<T>, T>(this))\n\n    return <RxRestCollection<T> & T[]> proxy\n  }\n\n  [Symbol.iterator]() {\n    let index = 0\n    let elements = this.$elements\n\n    return {\n      next(): IteratorResult<RxRestItem<T>> {\n        return index < elements.length ?\n          {value: elements[index++], done: false} : {value: undefined, done: true}\n      }\n    }\n  }\n\n  /**\n   * getList - fetch a collection\n   *\n   * @param {Object|URLSearchParams} [queryParams]\n   * @param {Object|Headers} [headers]\n   * @returns {Observable<RxRestItem|RxRestCollection>}\n   */\n  getList(queryParams?: Object|URLSearchParams, headers?: Object|Headers):\n    Observable<RxRestItem<T>|RxRestCollection<T>> {\n    this.queryParams = queryParams\n    this.headers = headers\n\n    return this.request('GET')\n  }\n\n  /**\n   * set elements\n   *\n   * @param {T[]} elements\n   */\n  set elements(elements: RxRestItem<T>[]) {\n    this.$elements = elements\n    this.length = elements.length\n  }\n\n  /**\n   * get elements\n   * @return {RxRestItem<T>[]}\n   */\n  get elements(): RxRestItem<T>[] {\n    return this.$elements\n  }\n\n  /**\n   * plain\n   *\n   * @returns {T[]}\n   */\n  plain(): T[] {\n    return this.elements.map(e => e.plain())\n  }\n\n  /**\n   * json\n   *\n   * @returns {String}\n   */\n  json(): string {\n    return JSON.stringify(this.plain())\n  }\n\n  /**\n   * clone\n   *\n   * @returns {RxRestCollection}\n   */\n  clone(): RxRestCollection<T> & T[] {\n    return new RxRestCollection<T>(\n      this.$route, this.$elements, this.config\n    ) as RxRestCollection<T> & T[]\n  }\n}\n\nexport class RxRest {\n  constructor(private config: RxRestConfiguration) {\n  }\n\n  one<T>(route: string, id?: any): RxRestItem<T> & T {\n    let r = new AbstractRxRest(this.config)\n    return r.one.call(r, route, id)\n  }\n\n  all<T>(route: string, asIterable: boolean = true): RxRestCollection<T> & T[] {\n    let r = new AbstractRxRest(this.config)\n    return r.all.call(r, route, asIterable)\n  }\n\n  fromObject<T>(route: string, element: T|T[]): (RxRestItem<T> & T) | (RxRestCollection<T> & T[]) {\n    let r = new AbstractRxRest(this.config)\n    return r.fromObject.call(r, route, element)\n  }\n}\n\nexport { RxRestConfiguration }\n"],"names":["isFunction","x","isObject","tryCatcher","tryCatchTarget","apply","this","arguments","e","errorObject_1","errorObject","tryCatch","fn","flattenUnsubscriptionErrors","errors","reduce","errs","err","concat","UnsubscriptionError_1","UnsubscriptionError","toSubscriber","nextOrObserver","error","complete","Subscriber_1","Subscriber","rxSubscriber_1","rxSubscriber","Observer_1","empty","dispatchNext","arg","value","subscriber","closed","next","dispatchError","isPromise","subscribe","then","subscribeToResult","outerSubscriber","result","outerValue","outerIndex","destination","InnerSubscriber_1","InnerSubscriber","Observable_1","Observable","_isScalar","isArrayLike_1","isArrayLike","i","len","length","isPromise_1","root_1","root","setTimeout","iterator_1","iterator","item","done","observable_1","observable","obs","TypeError","msg","isObject_1","mergeMap","project","resultSelector","concurrent","Number","POSITIVE_INFINITY","lift","MergeMapOperator","concatMap","mergeMap_1","_catch","selector","operator","CatchOperator","caught","isScheduler","schedule","map","key","Array","isArray","append","a","b","Math","random","toString","obj","RequestBase","mixin","prototype","ResponseBase","Agent","_defaults","input","init","abortCallback","Request","req","superagent","method","toLowerCase","url","headers","header","set","fromPromise","text","send","body","create","observer","end","res","response","Response","message","statusText","noContent","abort","target","$instance","$internal","Object","getOwnPropertyNames","getOwnPropertySymbols","getPrototypeOf","p","attributes","indexOf","defineProperty","receiver","$pristine","__window","window","__self","self","WorkerGlobalScope","__global","global","_root","Error","__extends","d","__","constructor","hasOwnProperty","_super","call","join","name","stack","Subscription","unsubscribe","_parent","_parents","_subscriptions","_unsubscribe","hasErrors","_a","index","remove","isFunction_1","trial","tryCatch_1","isArray_1","sub","push","add","teardown","EMPTY","subscription","_addParent","tmp","subscriptions","subscriptionIndex","splice","parent","Symbol","exports","for","destinationOrNext","syncErrorValue","syncErrorThrown","syncErrorThrowable","isStopped","SafeSubscriber","_next","_error","_complete","_unsubscribeAndRecycle","Subscription_1","_parentSubscriber","observerOrNext","context","bind","_context","__tryOrSetError","__tryOrUnsub","_this","wrappedComplete","getSymbolObservable","$$observable","_subscribe","source","sink","toSubscriber_1","_trySubscribe","forEach","PromiseCtor","Rx","config","Promise","resolve","reject","PromiseObservable","promise","scheduler","PromiseObservable_1","fromPromise_1","symbolIteratorPonyfill","Set_1","Set","Map_1","Map","keys","notifyNext","notifyError","notifyComplete","OuterSubscriber","innerValue","innerIndex","innerSub","MergeMapSubscriber","hasCompleted","buffer","active","_tryNext","_innerSub","ish","subscribeToResult_1","_notifyResultSelector","shift","OuterSubscriber_1","flatMap","ErrorObservable","dispatch","ErrorObservable_1","throw","throw_1","_throw","concatMap_1","CatchSubscriber","err2","catch","catch_1","ScalarObservable","state","EmptyObservable","ArrayObservable","array","of","_i","isScheduler_1","pop","ScalarObservable_1","EmptyObservable_1","count","ArrayObservable_1","of_1","Emitter","module","on","addEventListener","event","_callbacks","once","off","removeListener","removeAllListeners","removeEventListener","callbacks","cb","emit","args","slice","listeners","hasListeners","clearTimeout","_timer","_responseTimeoutTimer","parse","_parser","responseType","val","_responseType","serialize","_serializer","timeout","options","_timeout","_responseTimeout","option","deadline","console","warn","retry","_maxRetries","_retries","_retryCallback","ERROR_CODES","_shouldRetry","override","status","code","crossDomain","_retry","request","_aborted","timedout","_end","_fullfilledPromise","_endCalled","innerResolve","innerReject","undefined","use","ok","_okCallback","_isResponseOK","get","field","_header","getHeader","unset","_data","_getFormData","xhr","_auth","user","pass","base64Encoder","type","username","password","withCredentials","_withCredentials","redirects","n","_maxRedirects","maxResponseSize","_maxResponseSize","toJSON","data","isObj","_formData","_isHost","sortQuery","sort","_sort","_finalizeQueryString","query","_query","queryArr","substring","split","_appendQueryString","trace","_timeoutError","reason","errno","callback","_setTimeouts","str","parts","changesOrigin","_setHeaderProperties","ct","utils","params","links","link","parseLinks","_setStatusProperties","statusCode","statusType","info","redirect","clientError","serverError","toError","accepted","badRequest","unauthorized","notAcceptable","forbidden","notFound","_setDefaults","def","noop","pairs","pushEncodedKeyValuePair","v","subkey","encodeURIComponent","parseString","pair","pos","decodeURIComponent","parseHeader","line","lines","fields","trim","isJSON","mime","test","responseText","getAllResponseHeaders","getResponseHeader","_parseBody","original","rawResponse","new_err","custom_err","del","getXHR","XMLHttpRequest","location","protocol","ActiveXObject","s","replace","serializeObject","types","html","json","xml","urlencoded","form","form-data","application/x-www-form-urlencoded","application/json","JSON","stringify","accept","auth","btoa","string","attach","file","FormData","_callback","retries","crossDomainError","ca","agent","pipe","write","onreadystatechange","readyState","handleProgress","direction","total","percent","loaded","onprogress","upload","open","contentType","setRequestHeader","head","patch","post","put","Headers","URLSearchParams","fetch","RxRestItem","metadata","_responseBodyHandler","responseBodyHandler","_requestBodyHandler","requestBodyHandler","base","charAt","$baseURL","$queryParams","objectToMap","$headers","RxRestConfiguration","route","$route","$metadata","uuid","$uuid","id","addRoute","o","identifier","asIterable","RxRestCollection","$asIterable","element","queryParams","withBody","interceptors","origin","interceptor","requestOptions","requestHeaders","URL","requestQueryParams","expandInterceptors","requestInterceptors","responseInterceptors","$fromServer","collection","errorInterceptors","baseURL","param","Proxy","$element","RxRestProxyHandler","AbstractRxRest","plain","clone","elements","_this2","$elements","r","one","all","fromObject"],"mappings":"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"}